<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>שלוש אפשרויות ללוגו עץ משפחה</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            direction: rtl;
            text-align: right;
        }
    </style>
</head>
<body class="bg-gray-100 p-4">

<div class="container mx-auto p-8 bg-white rounded-xl shadow-lg">
    <h1 class="text-3xl font-extrabold text-gray-800 mb-6 text-center">בחרי את הלוגו המושלם עבורך</h1>
    <p class="text-gray-600 mb-8 text-center">
        הנה שלוש אפשרויות חדשות ללוגו עץ משפחה, שנוצרו במיוחד ללא כל טקסט או כיתוב בתוך התמונה.
    </p>

    <div id="logo-options" class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <!-- Option 1 Container -->
        <div class="option-card bg-gray-50 p-6 rounded-lg shadow-md flex flex-col items-center">
            <h2 class="text-xl font-bold mb-4">אפשרות 1: עיצוב אורגני</h2>
            <div id="image-container-1" class="flex justify-center items-center h-48 w-full bg-gray-200 rounded-lg overflow-hidden mb-4">
                <p id="loading-text-1" class="text-gray-500 text-center p-2">טוען תמונה...</p>
            </div>
            <button onclick="generateImage(1)" class="w-full bg-blue-500 text-white py-2 px-4 rounded-full hover:bg-blue-600 transition-colors">
                רענן אפשרות 1
            </button>
        </div>

        <!-- Option 2 Container -->
        <div class="option-card bg-gray-50 p-6 rounded-lg shadow-md flex flex-col items-center">
            <h2 class="text-xl font-bold mb-4">אפשרות 2: איור מינימליסטי</h2>
            <div id="image-container-2" class="flex justify-center items-center h-48 w-full bg-gray-200 rounded-lg overflow-hidden mb-4">
                <p id="loading-text-2" class="text-gray-500 text-center p-2">טוען תמונה...</p>
            </div>
            <button onclick="generateImage(2)" class="w-full bg-blue-500 text-white py-2 px-4 rounded-full hover:bg-blue-600 transition-colors">
                רענן אפשרות 2
            </button>
        </div>

        <!-- Option 3 Container -->
        <div class="option-card bg-gray-50 p-6 rounded-lg shadow-md flex flex-col items-center">
            <h2 class="text-xl font-bold mb-4">אפשרות 3: קווים עדינים</h2>
            <div id="image-container-3" class="flex justify-center items-center h-48 w-full bg-gray-200 rounded-lg overflow-hidden mb-4">
                <p id="loading-text-3" class="text-gray-500 text-center p-2">טוען תמונה...</p>
            </div>
            <button onclick="generateImage(3)" class="w-full bg-blue-500 text-white py-2 px-4 rounded-full hover:bg-blue-600 transition-colors">
                רענן אפשרות 3
            </button>
        </div>
    </div>
</div>

<script>
    // Prompts for the three different logo options
    const prompts = {
        1: "An artistic and flowing family tree logo, soft lines, organic shapes, subtle color gradient, abstract and elegant design, minimalist yet detailed, high resolution vector art, light pastel colors. Absolutely no text or words of any kind.",
        2: "A clean and simple vector illustration of a family tree, without any text, tagline, or typography. Focus on the organic and minimalist visual style. Light pastel colors.",
        3: "A beautiful, text-free logo of a family tree. The design should be minimalist and abstract, using graceful lines and a gentle color palette. The image must contain only the visual representation of the tree."
    };

    /**
     * Generates a logo image using the Gemini API based on a specific prompt.
     * @param {number} option - The option number (1, 2, or 3) to choose the correct prompt and container.
     */
    async function generateImage(option) {
        const loadingText = document.getElementById(`loading-text-${option}`);
        const imageContainer = document.getElementById(`image-container-${option}`);
        
        // Show loading state
        imageContainer.innerHTML = `<p id="loading-text-${option}" class="text-gray-500 text-center p-2">טוען תמונה...</p>`;

        let retries = 0;
        const maxRetries = 3;
        const initialDelay = 1000;
        
        while (retries < maxRetries) {
            try {
                const payload = { instances: [{ prompt: prompts[option] }], parameters: { "sampleCount": 1} };
                const apiKey = ""; // API key is handled by the canvas environment
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/imagen-3.0-generate-002:predict?key=${apiKey}`;
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (response.ok) {
                    const result = await response.json();
                    if (result.predictions && result.predictions.length > 0 && result.predictions[0].bytesBase64Encoded) {
                        const imageUrl = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                        const imgElement = document.createElement('img');
                        imgElement.src = imageUrl;
                        imgElement.alt = `Generated logo option ${option}`;
                        imgElement.classList.add('w-full', 'h-full', 'object-contain', 'rounded-lg');
                        
                        imageContainer.innerHTML = ''; // Clear loading text
                        imageContainer.appendChild(imgElement);
                        break; // Exit the loop on success
                    } else {
                        console.error('API response was missing image data.');
                        imageContainer.innerHTML = '<p class="text-red-500 text-center p-2">שגיאה ביצירת תמונה.</p>';
                        break;
                    }
                } else {
                    console.error(`API Error: ${response.status} - ${await response.text()}`);
                    retries++;
                    const delay = initialDelay * Math.pow(2, retries - 1);
                    await new Promise(res => setTimeout(res, delay));
                }
            } catch (error) {
                console.error('Error fetching image from API:', error);
                retries++;
                const delay = initialDelay * Math.pow(2, retries - 1);
                await new Promise(res => setTimeout(res, delay));
            }
        }
        
        if (retries === maxRetries) {
            imageContainer.innerHTML = '<p class="text-red-500 text-center p-2">שגיאה: לא ניתן היה ליצור את התמונה לאחר מספר ניסיונות.</p>';
        }
    }

    // Call the function for all options on window load to display the initial images
    window.onload = () => {
        generateImage(1);
        generateImage(2);
        generateImage(3);
    };
</script>
</body>
</html>
