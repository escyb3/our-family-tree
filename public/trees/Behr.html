<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Tree: Descendants of Behr/de Vries (Multi-Spouse)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        /* Card Styles */
        .person-card {
            border-radius: 0.5rem;
            padding: 0.5rem;
            min-width: 150px;
            max-width: 200px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .person-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        /* Gender Colors */
        .gender-M { background-color: #DBEAFE; border: 2px solid #3B82F6; } /* Blue for Male */
        .gender-F { background-color: #FCE7F3; border: 2px solid #EC4899; } /* Pink for Female */
        .gender-U { background-color: #E5E7EB; border: 2px solid #6B7280; } /* Grey for Unknown */

        /* Tree Structure */
        .tree-container {
            display: inline-block;
            white-space: nowrap;
            padding: 2rem;
            min-width: 100%;
        }
        .couple-node {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }
        /* Wrapper for the person/spouse cards */
        .couple-card-wrapper {
            display: flex;
            align-items: stretch;
            position: relative;
            margin-bottom: 0.5rem;
        }
        /* Line connecting two partners or a partner to the main person */
        .spouse-line {
            height: 2px;
            width: 10px; /* Reduced width for multiple connections */
            background-color: #1F2937;
            align-self: center;
        }
        /* Vertical line connecting couple/multiple spouses to children */
        .children-line-vertical {
            position: relative;
            width: 2px;
            background-color: #1F2937;
            height: 20px;
            margin-bottom: 0;
        }

        /* Container for all children of a couple */
        .descendants-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 0;
            width: 100%;
            /* Initially collapsed, handled by JS */
        }

        /* Horizontal line connecting all siblings */
        .children-horizontal-connector {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            padding-top: 0;
            margin-top: 0;
            width: 100%;
            overflow-x: auto;
        }

        .children-horizontal-line {
            position: absolute;
            top: 0;
            height: 2px;
            background-color: #1F2937;
            width: 100%;
        }

        /* Container for each child node, positioned horizontally */
        .child-node-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            padding: 0 15px; /* Spacing between siblings */
        }

        /* Vertical line from horizontal connector to the child's couple node */
        .child-vertical-line {
            width: 2px;
            height: 20px;
            background-color: #1F2937;
            position: relative;
            z-index: 10;
        }

        @media (max-width: 768px) {
            .tree-container {
                overflow-x: scroll;
            }
            .person-card {
                min-width: 100px;
                max-width: 150px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 p-4 md:p-8">
    <header class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800">ğŸŒ³ Behr Family Tree</h1>
        <p class="text-lg text-gray-600 mt-2">Introducing multiple generations with support for multiple spouses.</p>
        <p class="text-sm text-green-700 mt-2 font-bold">The tree is updated to October 2025- 7/5785</p>
    </header>

    <div class="overflow-x-auto shadow-lg bg-white rounded-xl p-4">
        <div id="familyTree" class="tree-container">
            <!-- ×¢×¥ ×”××©×¤×—×” ×™×•×¦×’ ×›××Ÿ ×‘×××¦×¢×•×ª JavaScript -->
        </div>
    </div>

    <div class="mt-8 p-6 bg-gray-100 rounded-xl shadow-md max-w-4xl mx-auto">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Key and instructions:</h2>
        <div class="flex flex-col sm:flex-row justify-around gap-4 text-sm">
            <div class="flex items-center"><div class="w-4 h-4 rounded-full gender-M mr-2"></div><span>Male (×–×›×¨)</span></div>
            <div class="flex items-center"><div class="w-4 h-4 rounded-full gender-F mr-2"></div><span>Female (× ×§×‘×”)</span></div>
            <div class="flex items-center"><div class="w-4 h-4 rounded-full gender-U mr-2"></div><span>Unknown (×œ× ×™×“×•×¢)</span></div>
        </div>
        <p class="mt-4 text-gray-600 text-sm">Click on a person's card to **show/hide their descendants**.</p>
        <p class="text-xs mt-2 text-gray-500 font-bold">Please note: A person with multiple partner cards linked  is a person who has had multiple documented partners.</p>
    </div>

    <script>
        // Data containing all family members
        // NOTE: The 'spouse_id' property has been replaced with 'spouse_ids' (an array) for all primary lineage members.
        const peopleData = [
      [
  {
    "id": "1",
    "name": "Benjamin de Behr",
    "gender": "M",
    "spouse_id": "2",
    "children_ids": ["3", "4", "5", "6", "92", "93"],
    "birth_year": 1746,
    "death_year": 1823
  },
  {
    "id": "2",
    "name": "Hindel Lever Lazarus Lasarus",
    "gender": "F",
    "spouse_id": "1",
    "children_ids": ["3", "4", "5", "6", "92", "93"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "3",
    "name": "Beile Benjamins de Beer",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1787,
    "death_year": 1865
  },
  {
    "id": "4",
    "name": "Frouke Benjamins de Beer",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1793,
    "death_year": 1833
  },
  {
    "id": "5",
    "name": "Levie Benjamin de Beer",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1795,
    "death_year": 1855
  },
  {
    "id": "6",
    "name": "IsraÃ«l Benjamin Behr",
    "gender": "M",
    "spouse_id": "7",
    "children_ids": ["8", "45", "46", "47", "48", "49", "50", "59", "60", "61", "91"],
    "birth_year": 1799,
    "death_year": 1873
  },
  {
    "id": "7",
    "name": "Sara Simons Bollegraaf",
    "gender": "F",
    "spouse_id": "6",
    "children_ids": ["8", "45", "46", "47", "48", "49", "50", "59", "60", "61", "91"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "8",
    "name": "Izak Israel Benjamin Behr",
    "gender": "M",
    "spouse_id": "9,10",
    "children_ids": ["11", "21", "22", "23", "24", "25", "26", "39", "40", "41", "42", "43", "44", "51", "52", "53", "54", "55", "56", "57"],
    "birth_year": 1818,
    "death_year": 1888
  },
  {
    "id": "9",
    "name": "Clara Hartog Clara Mozes",
    "gender": "F",
    "spouse_id": "8",
    "children_ids": ["11", "21", "22", "23", "24", "25", "26", "39", "40", "41", "42", "43", "44", "51", "52", "53", "54", "55", "56", "57"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "10",
    "name": "Marie Philip Groenstad",
    "gender": "F",
    "spouse_id": "8",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "11",
    "name": "Hartog Behr",
    "gender": "M",
    "spouse_id": "12",
    "children_ids": ["13"],
    "birth_year": 1842,
    "death_year": 1895
  },
  {
    "id": "12",
    "name": "Rachel v Gelderen",
    "gender": "F",
    "spouse_id": "11",
    "children_ids": ["13"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "13",
    "name": "Izak Behr",
    "gender": "M",
    "spouse_id": "14",
    "children_ids": ["15", "18", "19", "20"],
    "birth_year": 1869,
    "death_year": 1936
  },
  {
    "id": "14",
    "name": "Wilhelmina Frenkel",
    "gender": "F",
    "spouse_id": "13",
    "children_ids": ["15", "18", "19", "20"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "15",
    "name": "Hartog Behr",
    "gender": "M",
    "spouse_id": "16",
    "children_ids": ["17"],
    "birth_year": 1897,
    "death_year": 1960
  },
  {
    "id": "16",
    "name": "Arendina Henderika Blomsma",
    "gender": "F",
    "spouse_id": "15",
    "children_ids": ["17"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "17",
    "name": "Albartus Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1925,
    "death_year": 1996
  },
  {
    "id": "18",
    "name": "Benjamin BEHR",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1898,
    "death_year": 1943
  },
  {
    "id": "19",
    "name": "Sara BEHR",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1900,
    "death_year": 1943
  },
  {
    "id": "20",
    "name": "Rachel BEHR",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1904,
    "death_year": 1943
  },
  {
    "id": "21",
    "name": "Stillborn Son Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1849,
    "death_year": 1849
  },
  {
    "id": "22",
    "name": "Stillborn Son Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1855,
    "death_year": 1855
  },
  {
    "id": "23",
    "name": "Stillborn Son Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1855,
    "death_year": 1855
  },
  {
    "id": "24",
    "name": "Sara Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1844,
    "death_year": null
  },
  {
    "id": "25",
    "name": "IsraÃ«l Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1845,
    "death_year": 1929
  },
  {
    "id": "26",
    "name": "Mozes Behr",
    "gender": "M",
    "spouse_id": "27",
    "children_ids": ["28", "62", "63", "64", "65", "66"],
    "birth_year": 1848,
    "death_year": 1912
  },
  {
    "id": "27",
    "name": "Selly Clara Bueno de Mesquita",
    "gender": "F",
    "spouse_id": "26",
    "children_ids": ["28", "62", "63", "64", "65", "66"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "28",
    "name": "Isak (Jacques) Behr",
    "gender": "M",
    "spouse_id": "29",
    "children_ids": ["30", "31", "32", "33", "44", "45", "46", "47"],
    "birth_year": 1878,
    "death_year": 1955
  },
  {
    "id": "29",
    "name": "Anna Pieternella Vas",
    "gender": "F",
    "spouse_id": "28",
    "children_ids": ["30", "31", "32", "33", "44", "45", "46", "47"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "30",
    "name": "CÃ©line Marie Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1897,
    "death_year": 1971
  },
  {
    "id": "31",
    "name": "Maurits Jacques Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1898,
    "death_year": 1902
  },
  {
    "id": "32",
    "name": "Bertha Henriette Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1901,
    "death_year": 1965
  },
  {
    "id": "33",
    "name": "Annie Jacqueline Behr",
    "gender": "F",
    "spouse_id": "34",
    "children_ids": ["35"],
    "birth_year": 1903,
    "death_year": 1985
  },
  {
    "id": "34",
    "name": "Hendrik Marius van Leesten",
    "gender": "M",
    "spouse_id": "33",
    "children_ids": ["35", "44"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "35",
    "name": "Hendrik Marius Van Leesten",
    "gender": "M",
    "spouse_id": "36,37",
    "children_ids": ["38", "39", "41"],
    "birth_year": 1913,
    "death_year": 1999
  },
  {
    "id": "36",
    "name": "Kathryn Alberta Smith",
    "gender": "F",
    "spouse_id": "35",
    "children_ids": ["38", "39", "41"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "37",
    "name": "Eva I Monthero",
    "gender": "F",
    "spouse_id": "35",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "38",
    "name": "Hendrik Marius Van Leesten",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1936,
    "death_year": 2016
  },
  {
    "id": "39",
    "name": "Michael Smith Vanleesten",
    "gender": "M",
    "spouse_id": "40",
    "children_ids": ["42", "43"],
    "birth_year": 1939,
    "death_year": 2019
  },
  {
    "id": "40",
    "name": "Natalie E. Brown",
    "gender": "F",
    "spouse_id": "39",
    "children_ids": ["42", "43"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "41",
    "name": "John Matthew Van Leesten",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1941,
    "death_year": 1941
  },
  {
    "id": "42",
    "name": "Karriem Muhammad",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "43",
    "name": "Rashad Munir",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "44",
    "name": "Permon Hendrik van Leesten",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1929,
    "death_year": 1991
  },
  {
    "id": "45",
    "name": "Irene Clara Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1905,
    "death_year": 1982
  },
  {
    "id": "46",
    "name": "Lilly Corrie Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1907,
    "death_year": 1994
  },
  {
    "id": "47",
    "name": "Florie Sophie Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1909,
    "death_year": 1975
  },
  {
    "id": "48",
    "name": "Hartog Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1880,
    "death_year": 1920
  },
  {
    "id": "49",
    "name": "Benjamin Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1882,
    "death_year": 1884
  },
  {
    "id": "50",
    "name": "Abraham Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1884,
    "death_year": 1952
  },
  {
    "id": "51",
    "name": "Jacob Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1887,
    "death_year": 1887
  },
  {
    "id": "52",
    "name": "Clara Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1888,
    "death_year": 1889
  },
  {
    "id": "53",
    "name": "Kind Behr",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1849,
    "death_year": null
  },
  {
    "id": "54",
    "name": "Esther Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1850,
    "death_year": 1853
  },
  {
    "id": "55",
    "name": "Benjamin Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1853,
    "death_year": 1908
  },
  {
    "id": "56",
    "name": "Kind Behr",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1855,
    "death_year": 1855
  },
  {
    "id": "57",
    "name": "Simon Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1857,
    "death_year": 1857
  },
  {
    "id": "58",
    "name": "Salina Behr",
    "gender": "F",
    "spouse_id": "69",
    "children_ids": ["70", "71", "72", "73", "74", "77", "88", "90", "95", "96", "107"],
    "birth_year": 1862,
    "death_year": 1932
  },
  {
    "id": "59",
    "name": "Hinderina Behr",
    "gender": "F",
    "spouse_id": "97",
    "children_ids": [],
    "birth_year": 1862,
    "death_year": 1939
  },
  {
    "id": "60",
    "name": "Betje Behr",
    "gender": "F",
    "spouse_id": "98",
    "children_ids": ["99", "103", "106", "110"],
    "birth_year": 1864,
    "death_year": 1899
  },
  {
    "id": "61",
    "name": "Philippus Behr",
    "gender": "M",
    "spouse_id": "111,112",
    "children_ids": ["113", "114"],
    "birth_year": 1866,
    "death_year": 1942
  },
  {
    "id": "62",
    "name": "Kaatje Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1868,
    "death_year": 1941
  },
  {
    "id": "63",
    "name": "Abraham Izak Behr",
    "gender": "M",
    "spouse_id": "115",
    "children_ids": ["116", "121", "124", "130"],
    "birth_year": 1870,
    "death_year": 1940
  },
  {
    "id": "64",
    "name": "Saartje Behr",
    "gender": "F",
    "spouse_id": "141",
    "children_ids": ["142", "143", "144", "145", "146", "147", "148"],
    "birth_year": 1872,
    "death_year": 1943
  },
  {
    "id": "65",
    "name": "Samuel Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1877,
    "death_year": 1942
  },
  {
    "id": "66",
    "name": "Benjamin Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1824,
    "death_year": 1903
  },
  {
    "id": "67",
    "name": "Ester Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1826,
    "death_year": 1826
  },
  {
    "id": "68",
    "name": "Hendel de Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1828,
    "death_year": 1916
  },
  {
    "id": "69",
    "name": "Simon IsraÃ«ls Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1830,
    "death_year": 1899
  },
  {
    "id": "70",
    "name": "Abram Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1831,
    "death_year": 1832
  },
  {
    "id": "71",
    "name": "Frouwke de Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1833,
    "death_year": 1911
  },
  {
    "id": "72",
    "name": "Esther de Beer",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1835,
    "death_year": 1915
  },
  {
    "id": "73",
    "name": "Kaatje de Beer",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1837,
    "death_year": 1927
  },
  {
    "id": "74",
    "name": "Salomon de Behr",
    "gender": "M",
    "spouse_id": "153",
    "children_ids": ["154", "155", "156", "160", "163", "166", "170"],
    "birth_year": 1840,
    "death_year": 1926
  },
  {
    "id": "75",
    "name": "Abraham de Beer",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1842,
    "death_year": 1921
  },
  {
    "id": "76",
    "name": "Salomon de Beer",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1802,
    "death_year": 1833
  },
  {
    "id": "77",
    "name": "Margje Margien Benjamin de Beer",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1808,
    "death_year": 1880
  },
  {
    "id": "78",
    "name": "Raphael Ensel",
    "gender": "M",
    "spouse_id": "58",
    "children_ids": ["79", "80", "81", "82", "83", "84", "85", "86", "87", "89"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "79",
    "name": "Salomon Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1884,
    "death_year": 1943
  },
  {
    "id": "80",
    "name": "Maria Ensel",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1886,
    "death_year": 1943
  },
  {
    "id": "81",
    "name": "Isaac Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1887,
    "death_year": 1942
  },
  {
    "id": "82",
    "name": "Andries Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1889,
    "death_year": 1945
  },
  {
    "id": "83",
    "name": "Kaatje Ensel",
    "gender": "F",
    "spouse_id": "84",
    "children_ids": ["85", "86", "87", "88", "89", "90", "91", "92"],
    "birth_year": 1892,
    "death_year": 1942
  },
  {
    "id": "84",
    "name": "Goedman de Jong",
    "gender": "M",
    "spouse_id": "83",
    "children_ids": ["85", "86", "87", "88", "89", "90", "91", "92"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "85",
    "name": "Elisabeth de Jong",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1914,
    "death_year": 1942
  },
  {
    "id": "86",
    "name": "Helena de Jong",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1916,
    "death_year": 1942
  },
  {
    "id": "87",
    "name": "IsaÃ¤c de Jong",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1918,
    "death_year": 1943
  },
  {
    "id": "88",
    "name": "Saline de Jong",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1923,
    "death_year": 1940
  },
  {
    "id": "89",
    "name": "Salomon de Jong",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1923,
    "death_year": 1943
  },
  {
    "id": "90",
    "name": "Celine de Jong",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1925,
    "death_year": 1942
  },
  {
    "id": "91",
    "name": "Barend de Jong",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1928,
    "death_year": 1942
  },
  {
    "id": "92",
    "name": "David de Jong",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1932,
    "death_year": 1942
  },
  {
    "id": "93",
    "name": "Hanna Ensel",
    "gender": "F",
    "spouse_id": "94,96",
    "children_ids": ["95"],
    "birth_year": 1894,
    "death_year": 1944
  },
  {
    "id": "94",
    "name": "Philip de Hond",
    "gender": "M",
    "spouse_id": "93",
    "children_ids": ["95"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "95",
    "name": "Judith de Hond",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1915,
    "death_year": 1942
  },
  {
    "id": "96",
    "name": "Johannes Wiersma",
    "gender": "M",
    "spouse_id": "93",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "97",
    "name": "Sara Ensel",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1895,
    "death_year": 1943
  },
  {
    "id": "98",
    "name": "David Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1897,
    "death_year": 1943
  },
  {
    "id": "99",
    "name": "Philip Ensel",
    "gender": "M",
    "spouse_id": "100,102,103",
    "children_ids": ["101", "104", "105", "106", "107", "108"],
    "birth_year": 1899,
    "death_year": 1971
  },
  {
    "id": "100",
    "name": "Gerardina Alijda Smit",
    "gender": "F",
    "spouse_id": "99",
    "children_ids": ["108"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "101",
    "name": "Wilhelmina Susanna Gerardu",
    "gender": "F",
    "spouse_id": "99",
    "children_ids": ["104", "105", "106", "107"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "102",
    "name": "Unknown Spouse",
    "gender": null,
    "spouse_id": "99",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "103",
    "name": "Salina Ensel",
    "gender": "F",
    "spouse_id": "104",
    "children_ids": ["105"],
    "birth_year": 1920,
    "death_year": 1999
  },
  {
    "id": "104",
    "name": "Willem Steines",
    "gender": "M",
    "spouse_id": "103",
    "children_ids": ["105"],
    "birth_year": 1940,
    "death_year": null
  },
  {
    "id": "105",
    "name": "Johannes Willem Steines",
    "gender": "M",
    "spouse_id": "106",
    "children_ids": [],
    "birth_year": 1941,
    "death_year": null
  },
  {
    "id": "106",
    "name": "Helena Elisabeth Rengers",
    "gender": "F",
    "spouse_id": "105",
    "children_ids": [],
    "birth_year": 1968,
    "death_year": null
  },
  {
    "id": "107",
    "name": "Johanna Ensel",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1922,
    "death_year": 1924
  },
  {
    "id": "108",
    "name": "Raphael Ensel",
    "gender": "M",
    "spouse_id": "109",
    "children_ids": [],
    "birth_year": 1924,
    "death_year": 2001
  },
  {
    "id": "109",
    "name": "Theodora Maria Visser",
    "gender": "F",
    "spouse_id": "108",
    "children_ids": [],
    "birth_year": 1946,
    "death_year": null
  },
  {
    "id": "110",
    "name": "Johanna Ensel",
    "gender": "F",
    "spouse_id": "111",
    "children_ids": ["112"],
    "birth_year": 1926,
    "death_year": 2011
  },
  {
    "id": "111",
    "name": "Hendrik Grim",
    "gender": "M",
    "spouse_id": "110",
    "children_ids": ["112"],
    "birth_year": 1953,
    "death_year": null
  },
  {
    "id": "112",
    "name": "Hendrika Grim",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1959,
    "death_year": null
  },
  {
    "id": "113",
    "name": "Johan (Joop) Ensel",
    "gender": "M",
    "spouse_id": "114",
    "children_ids": [],
    "birth_year": 1928,
    "death_year": null
  },
  {
    "id": "114",
    "name": "Francina (Fransien) Blok",
    "gender": "F",
    "spouse_id": "113",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "115",
    "name": "Frits Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1932,
    "death_year": 2014
  },
  {
    "id": "116",
    "name": "Jacob Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1945,
    "death_year": 2017
  },
  {
    "id": "117",
    "name": "Alida Ensel",
    "gender": "F",
    "spouse_id": "118",
    "children_ids": ["119", "120"],
    "birth_year": 1901,
    "death_year": 1943
  },
  {
    "id": "118",
    "name": "Levie Walvis",
    "gender": "M",
    "spouse_id": "117",
    "children_ids": ["119", "120"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "119",
    "name": "Sara Walvis",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1924,
    "death_year": 1942
  },
  {
    "id": "120",
    "name": "Salina Walvis",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1934,
    "death_year": 1943
  },
  {
    "id": "121",
    "name": "Abraham Ensel",
    "gender": "M",
    "spouse_id": "122",
    "children_ids": ["123", "124", "125", "126", "127"],
    "birth_year": 1903,
    "death_year": 1943
  },
  {
    "id": "122",
    "name": "Rebecca de Klijn",
    "gender": "F",
    "spouse_id": "121",
    "children_ids": ["123", "124", "125", "126", "127"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "123",
    "name": "RaphaÃ«l Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1922,
    "death_year": 1942
  },
  {
    "id": "124",
    "name": "Bertha Ensel",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1924,
    "death_year": 2001
  },
  {
    "id": "125",
    "name": "Salina Ensel",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1926,
    "death_year": 2001
  },
  {
    "id": "126",
    "name": "Benjamin Ensel",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1927,
    "death_year": 1943
  },
  {
    "id": "127",
    "name": "Rachel Ensel",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1929,
    "death_year": 1943
  },
  {
    "id": "128",
    "name": "Betje Raphael Meijers",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1906,
    "death_year": 1943
  },
  {
    "id": "129",
    "name": "X Ensel",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "130",
    "name": "Elkan Speyer",
    "gender": "M",
    "spouse_id": "59",
    "children_ids": [],
    "birth_year": 1886,
    "death_year": null
  },
  {
    "id": "131",
    "name": "Benjamin de Vries",
    "gender": "M",
    "spouse_id": "60",
    "children_ids": ["132", "141", "144", "154"],
    "birth_year": 1887,
    "death_year": null
  },
  {
    "id": "132",
    "name": "Heiman IzaÃ¤c de Vries",
    "gender": "M",
    "spouse_id": "133",
    "children_ids": ["134", "135", "136", "137", "138", "139"],
    "birth_year": 1891,
    "death_year": 1943
  },
  {
    "id": "133",
    "name": "Leentje",
    "gender": "F",
    "spouse_id": "132",
    "children_ids": ["134", "135", "136", "137", "138", "139"],
    "birth_year": 1916,
    "death_year": null
  },
  {
    "id": "134",
    "name": "Betje de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1917,
    "death_year": 1945
  },
  {
    "id": "135",
    "name": "Johanna de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1919,
    "death_year": 1944
  },
  {
    "id": "136",
    "name": "Martha Mathilda de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1921,
    "death_year": 1943
  },
  {
    "id": "137",
    "name": "Miriam Devora Deveirje de Vries",
    "gender": "F",
    "spouse_id": "138",
    "children_ids": ["139"],
    "birth_year": 1923,
    "death_year": 2003
  },
  {
    "id": "138",
    "name": "Baruch Aaron Izraelovich Israeli",
    "gender": "M",
    "spouse_id": "137",
    "children_ids": ["139"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "139",
    "name": "Unkown Izraelovich Israeli",
    "gender": null,
    "spouse_id": "140",
    "children_ids": ["141"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "140",
    "name": "Israel Bikovsky",
    "gender": "M",
    "spouse_id": "139",
    "children_ids": ["141"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "141",
    "name": "Bar Bikovsky",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "142",
    "name": "Sara de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1924,
    "death_year": 1943
  },
  {
    "id": "143",
    "name": "Judith de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1926,
    "death_year": 1943
  },
  {
    "id": "144",
    "name": "Jacob de Vries",
    "gender": "M",
    "spouse_id": "145",
    "children_ids": [],
    "birth_year": 1893,
    "death_year": 1944
  },
  {
    "id": "145",
    "name": "Catharina Walg",
    "gender": "F",
    "spouse_id": "144",
    "children_ids": [],
    "birth_year": 1920,
    "death_year": null
  },
  {
    "id": "146",
    "name": "Maria de Vries",
    "gender": "F",
    "spouse_id": "147",
    "children_ids": ["148", "149", "150"],
    "birth_year": 1896,
    "death_year": 1943
  },
  {
    "id": "147",
    "name": "Mozes Jesaja van der Velde",
    "gender": "M",
    "spouse_id": "146",
    "children_ids": ["148", "149", "150"],
    "birth_year": 1919,
    "death_year": null
  },
  {
    "id": "148",
    "name": "Hans van der Velde",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1921,
    "death_year": 1943
  },
  {
    "id": "149",
    "name": "Emile van der Velde",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1925,
    "death_year": 1943
  },
  {
    "id": "150",
    "name": "Julia Van der velde",
    "gender": "F",
    "spouse_id": "151",
    "children_ids": ["152", "162", "165", "172"],
    "birth_year": 1930,
    "death_year": null
  },
  {
    "id": "151",
    "name": "Eduard Ido Izaks",
    "gender": "M",
    "spouse_id": "150",
    "children_ids": ["152", "162", "165", "172"],
    "birth_year": 1952,
    "death_year": null
  },
  {
    "id": "152",
    "name": "Miriam Izaks",
    "gender": "F",
    "spouse_id": "153,157",
    "children_ids": ["154", "157", "160"],
    "birth_year": 1953,
    "death_year": null
  },
  {
    "id": "153",
    "name": "Shimon Caspi",
    "gender": "M",
    "spouse_id": "152",
    "children_ids": ["154", "160", "162"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "154",
    "name": "Avigal Caspi",
    "gender": "F",
    "spouse_id": "155",
    "children_ids": ["156", "157", "158", "159"],
    "birth_year": 1982,
    "death_year": null
  },
  {
    "id": "155",
    "name": "Catriel",
    "gender": "M",
    "spouse_id": "154",
    "children_ids": ["156", "157", "158", "159"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "156",
    "name": "Ruth",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2013,
    "death_year": null
  },
  {
    "id": "157",
    "name": "Noam",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2015,
    "death_year": null
  },
  {
    "id": "158",
    "name": "Yonatan",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2017,
    "death_year": null
  },
  {
    "id": "159",
    "name": "Yael",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2019,
    "death_year": null
  },
  {
    "id": "160",
    "name": "Matan Caspi",
    "gender": "M",
    "spouse_id": "161",
    "children_ids": ["162", "163", "164", "165"],
    "birth_year": 1984,
    "death_year": null
  },
  {
    "id": "161",
    "name": "Oriyah",
    "gender": "F",
    "spouse_id": "160",
    "children_ids": ["162", "163", "164", "165"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "162",
    "name": "Halel Caspi",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2013,
    "death_year": null
  },
  {
    "id": "163",
    "name": "Nave Caspi",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2015,
    "death_year": null
  },
  {
    "id": "164",
    "name": "X Caspi",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2018,
    "death_year": null
  },
  {
    "id": "165",
    "name": "X Caspi",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2018,
    "death_year": null
  },
  {
    "id": "166",
    "name": "Bnaya Caspi",
    "gender": "M",
    "spouse_id": "167",
    "children_ids": ["168"],
    "birth_year": 1989,
    "death_year": null
  },
  {
    "id": "167",
    "name": "Ruth",
    "gender": "F",
    "spouse_id": "166",
    "children_ids": ["168"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "168",
    "name": "Gilad Caspi",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2017,
    "death_year": null
  },
  {
    "id": "169",
    "name": "Chana Noa Izaks",
    "gender": "F",
    "spouse_id": "170",
    "children_ids": ["171", "175", "179"],
    "birth_year": 1955,
    "death_year": null
  },
  {
    "id": "170",
    "name": "Shmuel Bromberg",
    "gender": "M",
    "spouse_id": "169",
    "children_ids": ["171", "175", "179"],
    "birth_year": 1978,
    "death_year": null
  },
  {
    "id": "171",
    "name": "Noga Bromberg",
    "gender": "F",
    "spouse_id": "172",
    "children_ids": ["173", "174", "175", "176", "177"],
    "birth_year": 1980,
    "death_year": null
  },
  {
    "id": "172",
    "name": "Avi Grossman",
    "gender": "M",
    "spouse_id": "171",
    "children_ids": ["173", "174", "175", "176", "177"],
    "birth_year": 2003,
    "death_year": null
  },
  {
    "id": "173",
    "name": "Roi Baruch Grossman",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2004,
    "death_year": null
  },
  {
    "id": "174",
    "name": "Maayan Ziva Grossman",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2006,
    "death_year": null
  },
  {
    "id": "175",
    "name": "Yishai Ido Grossman",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2008,
    "death_year": null
  },
  {
    "id": "176",
    "name": "Eyal Moshe Grossman",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2011,
    "death_year": null
  },
  {
    "id": "177",
    "name": "Yael Tziyon Grossman",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2014,
    "death_year": null
  },
  {
    "id": "178",
    "name": "Merav Bromberg",
    "gender": "F",
    "spouse_id": "179",
    "children_ids": ["180", "181", "182", "183"],
    "birth_year": 1982,
    "death_year": null
  },
  {
    "id": "179",
    "name": "Yanai Ben Abou",
    "gender": "M",
    "spouse_id": "178",
    "children_ids": ["180", "181", "182", "183"],
    "birth_year": 2007,
    "death_year": null
  },
  {
    "id": "180",
    "name": "Yair Moshe Ben Abou",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2013,
    "death_year": null
  },
  {
    "id": "181",
    "name": "Avishai Yosef Ben Abou",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2016,
    "death_year": null
  },
  {
    "id": "182",
    "name": "Beeri Ido Ben Abou",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2019,
    "death_year": null
  },
  {
    "id": "183",
    "name": "Omer Shlomo Ben Abou",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2025,
    "death_year": null
  },
  {
    "id": "184",
    "name": "Amitai Bromberg",
    "gender": "M",
    "spouse_id": "185",
    "children_ids": ["186", "187", "188"],
    "birth_year": 1988,
    "death_year": null
  },
  {
    "id": "185",
    "name": "Noga Amran",
    "gender": "F",
    "spouse_id": "184",
    "children_ids": ["186", "187", "188"],
    "birth_year": 2016,
    "death_year": null
  },
  {
    "id": "186",
    "name": "Ido Baruch Bromberg",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2019,
    "death_year": null
  },
  {
    "id": "187",
    "name": "Hadas Rachel Bromberg",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2022,
    "death_year": null
  },
  {
    "id": "188",
    "name": "Ariel Moshe Bromberg",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2024,
    "death_year": null
  },
  {
    "id": "189",
    "name": "Reuven Yitzhak Izaks",
    "gender": "M",
    "spouse_id": "190",
    "children_ids": ["191", "193", "195", "197"],
    "birth_year": 1957,
    "death_year": null
  },
  {
    "id": "190",
    "name": "Edna",
    "gender": "F",
    "spouse_id": "189",
    "children_ids": ["191", "193", "195", "197"],
    "birth_year": 1988,
    "death_year": null
  },
  {
    "id": "191",
    "name": "Efrat Izaks",
    "gender": "F",
    "spouse_id": "192",
    "children_ids": [],
    "birth_year": 1989,
    "death_year": null
  },
  {
    "id": "192",
    "name": "Yuval",
    "gender": "M",
    "spouse_id": "191",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "193",
    "name": "Smadar Izaks",
    "gender": "F",
    "spouse_id": "194",
    "children_ids": [],
    "birth_year": 1991,
    "death_year": null
  },
  {
    "id": "194",
    "name": "Asaf",
    "gender": "M",
    "spouse_id": "193",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "195",
    "name": "Ido Izaks",
    "gender": "M",
    "spouse_id": "196",
    "children_ids": ["197", "198", "199"],
    "birth_year": 1994,
    "death_year": null
  },
  {
    "id": "196",
    "name": "Maya",
    "gender": "F",
    "spouse_id": "195",
    "children_ids": ["197", "198", "199"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "197",
    "name": "Tehila Izaks",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2015,
    "death_year": null
  },
  {
    "id": "198",
    "name": "Moshe Izaks",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2017,
    "death_year": null
  },
  {
    "id": "199",
    "name": "Orah Izaks",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "200",
    "name": "Hadassah Elisheva Izaks",
    "gender": "F",
    "spouse_id": "201,203",
    "children_ids": ["202", "204"],
    "birth_year": 1961,
    "death_year": null
  },
  {
    "id": "201",
    "name": "Hillel Serlui",
    "gender": "M",
    "spouse_id": "200",
    "children_ids": ["202", "204"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "202",
    "name": "Bacol Serlui",
    "gender": "F",
    "spouse_id": "203,205",
    "children_ids": ["203"],
    "birth_year": 1983,
    "death_year": null
  },
  {
    "id": "203",
    "name": "Maoz Kahana",
    "gender": "M",
    "spouse_id": "202",
    "children_ids": [],
    "birth_year": 2021,
    "death_year": null
  },
  {
    "id": "204",
    "name": "Elyashiv Serlui",
    "gender": "M",
    "spouse_id": "206",
    "children_ids": ["207", "208", "209", "210"],
    "birth_year": 1984,
    "death_year": null
  },
  {
    "id": "205",
    "name": "Irit",
    "gender": "F",
    "spouse_id": "204",
    "children_ids": ["207", "208", "209", "210"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "206",
    "name": "Noam Adi Serlouie",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2007,
    "death_year": null
  },
  {
    "id": "207",
    "name": "Nitai Avraham Serlouie",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2010,
    "death_year": null
  },
  {
    "id": "208",
    "name": "Noga Emunah Pessia Serlouie",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2012,
    "death_year": null
  },
  {
    "id": "209",
    "name": "Meytav Malachi Serlouie",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2016,
    "death_year": null
  },
  {
    "id": "210",
    "name": "Benjamin Izaks",
    "gender": "M",
    "spouse_id": "211",
    "children_ids": ["212", "213", "215", "216", "217"],
    "birth_year": 1963,
    "death_year": null
  },
  {
    "id": "211",
    "name": "Ronit Gazit",
    "gender": "F",
    "spouse_id": "210",
    "children_ids": ["212", "213", "215", "216", "217"],
    "birth_year": 1988,
    "death_year": null
  },
  {
    "id": "212",
    "name": "Evyatar Izaks",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1989,
    "death_year": null
  },
  {
    "id": "213",
    "name": "Avidan Izaks",
    "gender": "M",
    "spouse_id": "214",
    "children_ids": ["215"],
    "birth_year": 1990,
    "death_year": null
  },
  {
    "id": "214",
    "name": "Tal Sezana",
    "gender": "F",
    "spouse_id": "213",
    "children_ids": ["215"],
    "birth_year": 2018,
    "death_year": null
  },
  {
    "id": "215",
    "name": "Opalya Izaks",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2022,
    "death_year": null
  },
  {
    "id": "216",
    "name": "Elkana Izaks",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1993,
    "death_year": null
  },
  {
    "id": "217",
    "name": "Edut Izaks",
    "gender": "F",
    "spouse_id": "218",
    "children_ids": [],
    "birth_year": 1995,
    "death_year": null
  },
  {
    "id": "218",
    "name": "X Zauler",
    "gender": null,
    "spouse_id": "217",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "219",
    "name": "Elroi Izaks",
    "gender": "M",
    "spouse_id": "220",
    "children_ids": [],
    "birth_year": 1997,
    "death_year": null
  },
  {
    "id": "220",
    "name": "Tehila Nechama Tzuriel",
    "gender": "F",
    "spouse_id": "219",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "221",
    "name": "Aaron de Vries",
    "gender": "M",
    "spouse_id": "222",
    "children_ids": ["223", "224", "225", "226"],
    "birth_year": 1898,
    "death_year": 1943
  },
  {
    "id": "222",
    "name": "Henriette Engelsman",
    "gender": "F",
    "spouse_id": "221",
    "children_ids": ["223", "224", "225", "226"],
    "birth_year": 1925,
    "death_year": null
  },
  {
    "id": "223",
    "name": "Sientje Jeannette de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1926,
    "death_year": 1942
  },
  {
    "id": "224",
    "name": "Betje Marie de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1929,
    "death_year": 1942
  },
  {
    "id": "225",
    "name": "Lea Sippora de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1932,
    "death_year": 1942
  },
  {
    "id": "226",
    "name": "Jeannette Henriette de Vries",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1935,
    "death_year": 1942
  },
  {
    "id": "227",
    "name": "Betje van Dam",
    "gender": "F",
    "spouse_id": "61",
    "children_ids": ["228"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "228",
    "name": "Frieda Mindus",
    "gender": "F",
    "spouse_id": "61",
    "children_ids": ["229"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "229",
    "name": "Henderina Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1902,
    "death_year": 1945
  },
  {
    "id": "230",
    "name": "Kind Behr",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1938,
    "death_year": null
  },
  {
    "id": "231",
    "name": "Jette Bernard",
    "gender": "F",
    "spouse_id": "63",
    "children_ids": ["232", "235", "238", "247"],
    "birth_year": 1897,
    "death_year": null
  },
  {
    "id": "232",
    "name": "Froukje van Coeverden van Coevoerden Behr",
    "gender": "F",
    "spouse_id": "233",
    "children_ids": ["234", "235"],
    "birth_year": 1898,
    "death_year": 1958
  },
  {
    "id": "233",
    "name": "JoÃ«l (Jolie) van Coevorden",
    "gender": "M",
    "spouse_id": "232",
    "children_ids": ["234", "235"],
    "birth_year": 1922,
    "death_year": null
  },
  {
    "id": "234",
    "name": "Bernard (Benno) van Coevorden",
    "gender": "M",
    "spouse_id": "235",
    "children_ids": [],
    "birth_year": 1923,
    "death_year": 1958
  },
  {
    "id": "235",
    "name": "Elisabeth de Vries",
    "gender": "F",
    "spouse_id": "234",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "236",
    "name": "Jette (Jetty) Mary van Coevorden",
    "gender": "F",
    "spouse_id": "237",
    "children_ids": [],
    "birth_year": 1927,
    "death_year": 2002
  },
  {
    "id": "237",
    "name": "Jacob (Jaap) Hiegentlich",
    "gender": "M",
    "spouse_id": "236",
    "children_ids": [],
    "birth_year": 1952,
    "death_year": null
  },
  {
    "id": "238",
    "name": "Isaac Abraham Isaac Behr",
    "gender": "M",
    "spouse_id": "239",
    "children_ids": ["240", "241"],
    "birth_year": 1900,
    "death_year": 1943
  },
  {
    "id": "239",
    "name": "Deborah Berend Abraham Berend Samuel Gompel Gombrecht De Lange",
    "gender": "F",
    "spouse_id": "238",
    "children_ids": ["240", "241"],
    "birth_year": 1929,
    "death_year": null
  },
  {
    "id": "240",
    "name": "Abraham Isaac Abraham Isaac Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1930,
    "death_year": 1943
  },
  {
    "id": "241",
    "name": "Hester-Henrietta Isaac Abraham Isaac Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1932,
    "death_year": 1943
  },
  {
    "id": "242",
    "name": "Maria Mina Behr",
    "gender": "F",
    "spouse_id": "243,245",
    "children_ids": ["244", "246"],
    "birth_year": 1903,
    "death_year": 1964
  },
  {
    "id": "243",
    "name": "Eliazar Pinto",
    "gender": "M",
    "spouse_id": "242",
    "children_ids": ["244", "246"],
    "birth_year": 1927,
    "death_year": null
  },
  {
    "id": "244",
    "name": "Jacob Schaap",
    "gender": "M",
    "spouse_id": "242",
    "children_ids": [],
    "birth_year": 1953,
    "death_year": null
  },
  {
    "id": "245",
    "name": "ReneÃ© Sylvia Frida Pinto",
    "gender": "F",
    "spouse_id": "246",
    "children_ids": ["247"],
    "birth_year": 1931,
    "death_year": null
  },
  {
    "id": "246",
    "name": "Henry (Hans) Wolf",
    "gender": "M",
    "spouse_id": "245",
    "children_ids": ["247"],
    "birth_year": 1953,
    "death_year": null
  },
  {
    "id": "247",
    "name": "Max Jaap Wolf",
    "gender": "M",
    "spouse_id": "248",
    "children_ids": [],
    "birth_year": 1956,
    "death_year": null
  },
  {
    "id": "248",
    "name": "Sandra Busnac",
    "gender": "F",
    "spouse_id": "247",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "249",
    "name": "Jette \"Jetty\" RenÃ©e Pinto",
    "gender": "F",
    "spouse_id": "250",
    "children_ids": ["251", "254"],
    "birth_year": 1931,
    "death_year": null
  },
  {
    "id": "250",
    "name": "Lazarus \"Leo\" van Gelder",
    "gender": "M",
    "spouse_id": "249",
    "children_ids": ["251", "254"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "251",
    "name": "Monique Elisa van Gelder",
    "gender": "F",
    "spouse_id": "252",
    "children_ids": ["253", "254"],
    "birth_year": 1953,
    "death_year": null
  },
  {
    "id": "252",
    "name": "Jochanan ChaÃ¯m Belinfante",
    "gender": "M",
    "spouse_id": "251",
    "children_ids": ["253", "254"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "253",
    "name": "Tzivya Mariasha Jona van Gelder",
    "gender": "F",
    "spouse_id": "254",
    "children_ids": [],
    "birth_year": 1987,
    "death_year": null
  },
  {
    "id": "254",
    "name": "Daan Wegener",
    "gender": "M",
    "spouse_id": "253",
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "255",
    "name": "Esya Belinfante",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "256",
    "name": "Ronald van Gelder",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "257",
    "name": "Ephraim Behr",
    "gender": "M",
    "spouse_id": "258",
    "children_ids": ["259", "263", "266"],
    "birth_year": 1905,
    "death_year": 1940
  },
  {
    "id": "258",
    "name": "Bertha Aleida Jacobs",
    "gender": "F",
    "spouse_id": "257",
    "children_ids": ["259", "263", "266"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "259",
    "name": "Elly Behr",
    "gender": "F",
    "spouse_id": "260",
    "children_ids": ["261", "262", "263"],
    "birth_year": 1931,
    "death_year": 2023
  },
  {
    "id": "260",
    "name": "Mauritz Jacobus",
    "gender": "M",
    "spouse_id": "259",
    "children_ids": ["261", "262", "263"],
    "birth_year": 1956,
    "death_year": null
  },
  {
    "id": "261",
    "name": "Simone Jacobus",
    "gender": "F",
    "spouse_id": "262",
    "children_ids": ["263", "264"],
    "birth_year": 1959,
    "death_year": null
  },
  {
    "id": "262",
    "name": "Unknown Spouse",
    "gender": null,
    "spouse_id": "261",
    "children_ids": ["263", "264"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "263",
    "name": "Daniel Eli Jacobus",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1994,
    "death_year": null
  },
  {
    "id": "264",
    "name": "Jonathan Ekad Jacobus",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2000,
    "death_year": null
  },
  {
    "id": "265",
    "name": "Martijn Jacobus",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1959,
    "death_year": null
  },
  {
    "id": "266",
    "name": "Dorine Jacobus",
    "gender": "F",
    "spouse_id": "267",
    "children_ids": ["268", "269"],
    "birth_year": 1962,
    "death_year": null
  },
  {
    "id": "267",
    "name": "Bart Leemhuis",
    "gender": "M",
    "spouse_id": "266",
    "children_ids": ["268", "269"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "268",
    "name": "Thomas Leemhuis",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "269",
    "name": "Robin Leemhuis",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "270",
    "name": "Abraham Edward Behr",
    "gender": "M",
    "spouse_id": "271",
    "children_ids": ["272", "275"],
    "birth_year": 1933,
    "death_year": 2005
  },
  {
    "id": "271",
    "name": "Sheila Stockland",
    "gender": "F",
    "spouse_id": "270",
    "children_ids": ["272", "275"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "272",
    "name": "Irit Behr",
    "gender": "F",
    "spouse_id": "273",
    "children_ids": ["274"],
    "birth_year": 1955,
    "death_year": null
  },
  {
    "id": "273",
    "name": "Unknown Spouse",
    "gender": null,
    "spouse_id": "272",
    "children_ids": ["274"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "274",
    "name": "Nn Behr",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1999,
    "death_year": null
  },
  {
    "id": "275",
    "name": "Ehud Behr",
    "gender": "M",
    "spouse_id": "276",
    "children_ids": ["277", "278"],
    "birth_year": 1960,
    "death_year": null
  },
  {
    "id": "276",
    "name": "Vered V Zukeman",
    "gender": "F",
    "spouse_id": "275",
    "children_ids": ["277", "278"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "277",
    "name": "Ori Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1986,
    "death_year": null
  },
  {
    "id": "278",
    "name": "Sapier Jamie Behr",
    "gender": "F",
    "spouse_id": "279",
    "children_ids": ["280"],
    "birth_year": 1992,
    "death_year": null
  },
  {
    "id": "279",
    "name": "Rafael Nieto Sliva",
    "gender": "M",
    "spouse_id": "278",
    "children_ids": ["280"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "280",
    "name": "Luca Gustavo Nieto Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2025,
    "death_year": null
  },
  {
    "id": "281",
    "name": "Jetteke Behr",
    "gender": "F",
    "spouse_id": "282",
    "children_ids": ["283", "286"],
    "birth_year": 1937,
    "death_year": null
  },
  {
    "id": "282",
    "name": "Leo de Galan",
    "gender": "M",
    "spouse_id": "281",
    "children_ids": ["283", "286"],
    "birth_year": 1960,
    "death_year": null
  },
  {
    "id": "283",
    "name": "Bastiaan de Galan",
    "gender": "M",
    "spouse_id": "284",
    "children_ids": ["285", "286"],
    "birth_year": 1965,
    "death_year": null
  },
  {
    "id": "284",
    "name": "Marian van Kraaij",
    "gender": "F",
    "spouse_id": "283",
    "children_ids": ["285", "286"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "285",
    "name": "Ruben Eduard de Galan",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1997,
    "death_year": null
  },
  {
    "id": "286",
    "name": "Evi Miriam de Galan",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2000,
    "death_year": null
  },
  {
    "id": "287",
    "name": "Karen de Galan",
    "gender": "F",
    "spouse_id": "288",
    "children_ids": ["289", "290"],
    "birth_year": 1967,
    "death_year": null
  },
  {
    "id": "288",
    "name": "Peter Baggen",
    "gender": "M",
    "spouse_id": "287",
    "children_ids": ["289", "290"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "289",
    "name": "Tamar Baggen",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1999,
    "death_year": null
  },
  {
    "id": "290",
    "name": "Yente Sam Baggen",
    "gender": null,
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 2002,
    "death_year": null
  },
  {
    "id": "291",
    "name": "JechiÃ«l Roco",
    "gender": "M",
    "spouse_id": "64",
    "children_ids": ["292", "293", "294", "295", "296", "297", "298"],
    "birth_year": 1899,
    "death_year": null
  },
  {
    "id": "292",
    "name": "Sara Roco",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1899,
    "death_year": 1942
  },
  {
    "id": "293",
    "name": "David Roco",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1901,
    "death_year": 1943
  },
  {
    "id": "294",
    "name": "Isaac Roco",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1902,
    "death_year": 1943
  },
  {
    "id": "295",
    "name": "Philip ROCO",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1904,
    "death_year": 1942
  },
  {
    "id": "296",
    "name": "Marie (Miriam) Roco",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1905,
    "death_year": 1943
  },
  {
    "id": "297",
    "name": "Joseph Roco",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1906,
    "death_year": 1943
  },
  {
    "id": "298",
    "name": "Abraham ROCO",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1908,
    "death_year": 1943
  },
  {
    "id": "299",
    "name": "Betje Blok",
    "gender": "F",
    "spouse_id": "74",
    "children_ids": ["300", "301", "302", "308", "311", "314", "317"],
    "birth_year": 1872,
    "death_year": null
  },
  {
    "id": "300",
    "name": "Saartje De Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1873,
    "death_year": 1876
  },
  {
    "id": "301",
    "name": "Esther De de Behr",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1875,
    "death_year": 1941
  },
  {
    "id": "302",
    "name": "Henderine De de Behr",
    "gender": "F",
    "spouse_id": "303",
    "children_ids": ["304", "305", "307", "308"],
    "birth_year": 1876,
    "death_year": 1929
  },
  {
    "id": "303",
    "name": "Marcus Frank",
    "gender": "M",
    "spouse_id": "302",
    "children_ids": ["304", "305", "307", "308"],
    "birth_year": 1898,
    "death_year": null
  },
  {
    "id": "304",
    "name": "Izaak Frank",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1899,
    "death_year": 1944
  },
  {
    "id": "305",
    "name": "Salomon David Frank",
    "gender": "M",
    "spouse_id": "306",
    "children_ids": ["307", "308"],
    "birth_year": 1902,
    "death_year": 1943
  },
  {
    "id": "306",
    "name": "Marie Anna de Jong",
    "gender": "F",
    "spouse_id": "305",
    "children_ids": ["307", "308"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "307",
    "name": "Betty Ida Frank",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1932,
    "death_year": 1943
  },
  {
    "id": "308",
    "name": "Daatje Frank",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1936,
    "death_year": 1943
  },
  {
    "id": "309",
    "name": "Jacob Frank",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1905,
    "death_year": 1942
  },
  {
    "id": "310",
    "name": "IsraÃ«l Frank",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1912,
    "death_year": 1942
  },
  {
    "id": "311",
    "name": "Frouke De Behr",
    "gender": "F",
    "spouse_id": "312",
    "children_ids": ["313"],
    "birth_year": 1879,
    "death_year": 1941
  },
  {
    "id": "312",
    "name": "Abraham (Mozes) Van Leeuwen",
    "gender": "M",
    "spouse_id": "311",
    "children_ids": ["313"],
    "birth_year": 1908,
    "death_year": null
  },
  {
    "id": "313",
    "name": "Hanna Van Leeuwen",
    "gender": "F",
    "spouse_id": "314",
    "children_ids": [],
    "birth_year": 1910,
    "death_year": 1943
  },
  {
    "id": "314",
    "name": "Meijer Van Zuiden",
    "gender": "M",
    "spouse_id": "313",
    "children_ids": [],
    "birth_year": 1933,
    "death_year": null
  },
  {
    "id": "315",
    "name": "Saartje de Behr",
    "gender": "F",
    "spouse_id": "316",
    "children_ids": ["317"],
    "birth_year": 1881,
    "death_year": 1943
  },
  {
    "id": "316",
    "name": "Izaak David Levie Frank",
    "gender": "M",
    "spouse_id": "315",
    "children_ids": ["317"],
    "birth_year": 1911,
    "death_year": null
  },
  {
    "id": "317",
    "name": "Bertha Marianna Frank",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1915,
    "death_year": 1943
  },
  {
    "id": "318",
    "name": "Jetje de Behr",
    "gender": "F",
    "spouse_id": "319",
    "children_ids": ["320"],
    "birth_year": 1883,
    "death_year": 1942
  },
  {
    "id": "319",
    "name": "Aron Cohen",
    "gender": "M",
    "spouse_id": "318",
    "children_ids": ["320"],
    "birth_year": 1908,
    "death_year": null
  },
  {
    "id": "320",
    "name": "Elie Aron Cohen",
    "gender": "M",
    "spouse_id": "321",
    "children_ids": ["322"],
    "birth_year": 1909,
    "death_year": 1993
  },
  {
    "id": "321",
    "name": "Margot Herrmann",
    "gender": "F",
    "spouse_id": "320",
    "children_ids": ["322"],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "322",
    "name": "Bloeme Cohen",
    "gender": "F",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": null,
    "death_year": null
  },
  {
    "id": "323",
    "name": "Israel De Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1886,
    "death_year": 1903
  },
  {
    "id": "324",
    "name": "Zadok De de Behr",
    "gender": "M",
    "spouse_id": null,
    "children_ids": [],
    "birth_year": 1888,
    "death_year": 1889
  }
]
        ];

        // Create a map for quick lookup
        const peopleMap = peopleData.reduce((map, person) => {
            map[person.id] = person;
            return map;
        }, {});

        const rootId = '1';
        const rootPerson = peopleMap[rootId];

        // Function to create the HTML for a single person card
        function createPersonCard(person, isSpouse) {
            const status = person.death_year === 'Alive' ? ' (Alive)' : (person.death_year ? ` (d. ${person.death_year})` : '');
            const dates = (person.birth_year || person.death_year) ?
                `<div class="text-xs text-gray-500 mt-1">${person.birth_year ? `b. ${person.birth_year}` : ''}${person.birth_year && person.death_year ? ' - ' : ''}${person.death_year || ''}</div>` :
                '';
            
            const card = document.createElement('div');
            card.className = `person-card gender-${person.gender} w-full`;
            card.setAttribute('data-id', person.id);
            
            // Only the main lineage person should have the click event to prevent double-toggling
            // If the person has children and is not just a spouse card, allow toggle
            if (!isSpouse || (person.children_ids && person.children_ids.length > 0)) { 
                 // Ensure only one click handler exists if this person is part of the main lineage
                card.onclick = toggleChildren;
            }

            // Create an icon based on gender/status
            let icon = '';
            if (person.gender === 'M') icon = 'â™‚ï¸';
            else if (person.gender === 'F') icon = 'â™€ï¸';
            else icon = 'ğŸ‘¤';
            
            // Determine the arrow/icon for the children toggle, only show if children exist
            const childrenIndicator = person.children_ids && person.children_ids.length > 0 ? 
                    '<div class="text-xs mt-1 font-bold text-gray-700">â¬‡ï¸</div>' : 
                    '<div class="text-xs mt-1 font-bold text-gray-400">âš«</div>';

            card.innerHTML = `
                <div class="text-xl mb-1">${icon}</div>
                <div class="font-semibold text-sm leading-tight">${person.name}</div>
                <div class="text-xs font-mono text-gray-700">${person.id}</div>
                ${dates}
                ${person.note ? `<div class="text-xs mt-1 text-pink-700 font-medium">${person.note}</div>` : ''}
                ${childrenIndicator}
            `;
            return card;
        }

        // Toggles the visibility of the descendants container
        function toggleChildren(event) {
            // Find the immediate parent couple-node
            const coupleNode = event.currentTarget.closest('.couple-node');
            if (!coupleNode) return;

            // The descendants container is the second child of couple-node
            const descendantsContainer = coupleNode.querySelector('.descendants-container');
            if (descendantsContainer) {
                if (descendantsContainer.style.display === 'none' || descendantsContainer.style.display === '') {
                    descendantsContainer.style.display = 'flex';
                } else {
                    descendantsContainer.style.display = 'none';
                }
            }
        }

        // Recursively renders a single person/couple node and its descendants
        function renderNode(personId) {
            const person = peopleMap[personId];
            if (!person) return null;

            const coupleNode = document.createElement('div');
            coupleNode.className = 'couple-node';
            
            // 1. Couple Card Wrapper
            const coupleCardWrapper = document.createElement('div');
            coupleCardWrapper.className = 'couple-card-wrapper';

            // Main person card (always displayed first)
            const personCard = createPersonCard(person, false);
            coupleCardWrapper.appendChild(personCard);
            
            // --- Handle Multiple Spouses (using spouse_ids array) ---
            let spousesToRender = [];
            
            // Prioritize spouse_ids (array) if it exists and is an array
            if (person.spouse_ids && Array.isArray(person.spouse_ids)) {
                spousesToRender = person.spouse_ids;
            } else if (person.spouse_id) { // Fallback/compatibility check for old single-string property
                spousesToRender = [person.spouse_id];
            }

            spousesToRender.forEach(spouseId => {
                const spouse = peopleMap[spouseId];
                if (spouse) {
                    const spouseLine = document.createElement('div');
                    spouseLine.className = 'spouse-line';
                    coupleCardWrapper.appendChild(spouseLine);
                    // Pass true for isSpouse. They do not trigger the children toggle themselves.
                    coupleCardWrapper.appendChild(createPersonCard(spouse, true));
                }
            });
            
            coupleNode.appendChild(coupleCardWrapper);

            // 2. Children Connection (Vertical Line)
            // This line connects the couple/multiple spouses group to the children's horizontal line
            if (person.children_ids && person.children_ids.length > 0) {
                const vertLine = document.createElement('div');
                vertLine.className = 'children-line-vertical';
                coupleNode.appendChild(vertLine);

                // 3. Descendants Container (Horizontal line + children nodes)
                const descendantsContainer = document.createElement('div');
                descendantsContainer.className = 'descendants-container';
                descendantsContainer.style.display = 'none'; // Initially collapsed

                const childNodes = renderDescendants(person.children_ids);
                descendantsContainer.appendChild(childNodes);
                coupleNode.appendChild(descendantsContainer);
            }

            return coupleNode;
        }

        // Renders the list of siblings and the horizontal connector
        function renderDescendants(childrenIds) {
            const childrenHorizontalConnector = document.createElement('div');
            childrenHorizontalConnector.className = 'children-horizontal-connector';

            // Add horizontal line connecting all children
            const horizontalLine = document.createElement('div');
            horizontalLine.className = 'children-horizontal-line';
            childrenHorizontalConnector.appendChild(horizontalLine);

            // Render each child node recursively
            childrenIds.forEach(childId => {
                const childNodeWrapper = document.createElement('div');
                childNodeWrapper.className = 'child-node-wrapper';

                // Vertical line from horizontal connector to the child node
                const childVertLine = document.createElement('div');
                childVertLine.className = 'child-vertical-line';
                childNodeWrapper.appendChild(childVertLine);

                // The recursive call to render the child's own couple-node
                const childNode = renderNode(childId);
                if (childNode) {
                    childNodeWrapper.appendChild(childNode);
                }
                
                childrenHorizontalConnector.appendChild(childNodeWrapper);
            });

            return childrenHorizontalConnector;
        }

        // Main function to start rendering the tree
        function initFamilyTree() {
            const treeContainer = document.getElementById('familyTree');
            if (treeContainer && rootPerson) {
                const rootNode = renderNode(rootId);
                if (rootNode) {
                    treeContainer.appendChild(rootNode);
                }
            }

            // Manually expand the root node for visibility on load
            const rootNodeElement = document.querySelector(`.person-card[data-id="${rootId}"]`);
            const rootCoupleNode = rootNodeElement ? rootNodeElement.closest('.couple-node') : null;

            if (rootCoupleNode) {
                const rootDescendants = rootCoupleNode.querySelector('.descendants-container');
                if (rootDescendants) {
                    rootDescendants.style.display = 'flex';
                }
            }
        }

        window.onload = initFamilyTree;
    </script>
</body>
</html>
