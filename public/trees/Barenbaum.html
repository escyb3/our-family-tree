<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Tree: Descendants of Barenbaum (Multi-Spouse)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        /* Card Styles */
        .person-card {
            border-radius: 0.5rem;
            padding: 0.5rem;
            min-width: 150px;
            max-width: 200px;
            text-align: center;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
            cursor: pointer;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .person-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        /* Gender Colors */
        .gender-M { background-color: #DBEAFE; border: 2px solid #3B82F6; } /* Blue for Male */
        .gender-F { background-color: #FCE7F3; border: 2px solid #EC4899; } /* Pink for Female */
        .gender-U { background-color: #E5E7EB; border: 2px solid #6B7280; } /* Grey for Unknown */

        /* Tree Structure */
        .tree-container {
            display: inline-block;
            white-space: nowrap;
            padding: 2rem;
            min-width: 100%;
        }
        .couple-node {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }
        /* Wrapper for the person/spouse cards */
        .couple-card-wrapper {
            display: flex;
            align-items: stretch;
            position: relative;
            margin-bottom: 0.5rem;
        }
        /* Line connecting two partners or a partner to the main person */
        .spouse-line {
            height: 2px;
            width: 10px; /* Reduced width for multiple connections */
            background-color: #1F2937;
            align-self: center;
        }
        /* Vertical line connecting couple/multiple spouses to children */
        .children-line-vertical {
            position: relative;
            width: 2px;
            background-color: #1F2937;
            height: 20px;
            margin-bottom: 0;
        }

        /* Container for all children of a couple */
        .descendants-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 0;
            width: 100%;
            /* Initially collapsed, handled by JS */
        }

        /* Horizontal line connecting all siblings */
        .children-horizontal-connector {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            position: relative;
            padding-top: 0;
            margin-top: 0;
            width: 100%;
            overflow-x: auto;
        }

        .children-horizontal-line {
            position: absolute;
            top: 0;
            height: 2px;
            background-color: #1F2937;
            width: 100%;
        }

        /* Container for each child node, positioned horizontally */
        .child-node-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            padding: 0 15px; /* Spacing between siblings */
        }

        /* Vertical line from horizontal connector to the child's couple node */
        .child-vertical-line {
            width: 2px;
            height: 20px;
            background-color: #1F2937;
            position: relative;
            z-index: 10;
        }

        @media (max-width: 768px) {
            .tree-container {
                overflow-x: scroll;
            }
            .person-card {
                min-width: 100px;
                max-width: 150px;
            }
        }
    </style>
</head>
<body class="bg-gray-50 p-4 md:p-8">
    <header class="text-center mb-8">
        <h1 class="text-3xl md:text-4xl font-extrabold text-gray-800">üå≥ Barenbaum Family Tree</h1>
        <p class="text-lg text-gray-600 mt-2">Introducing multiple generations with support for multiple spouses.</p>
        <p class="text-sm text-green-700 mt-2 font-bold">The tree is updated to October 2025- 7/5785</p>
    </header>

    <div class="overflow-x-auto shadow-lg bg-white rounded-xl p-4">
        <div id="familyTree" class="tree-container">
            <!-- ◊¢◊• ◊î◊û◊©◊§◊ó◊î ◊ô◊ï◊¶◊í ◊õ◊ê◊ü ◊ë◊ê◊û◊¶◊¢◊ï◊™ JavaScript -->
        </div>
    </div>

    <div class="mt-8 p-6 bg-gray-100 rounded-xl shadow-md max-w-4xl mx-auto">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Key and instructions:</h2>
        <div class="flex flex-col sm:flex-row justify-around gap-4 text-sm">
            <div class="flex items-center"><div class="w-4 h-4 rounded-full gender-M mr-2"></div><span>Male (◊ñ◊õ◊®)</span></div>
            <div class="flex items-center"><div class="w-4 h-4 rounded-full gender-F mr-2"></div><span>Female (◊†◊ß◊ë◊î)</span></div>
            <div class="flex items-center"><div class="w-4 h-4 rounded-full gender-U mr-2"></div><span>Unknown (◊ú◊ê ◊ô◊ì◊ï◊¢)</span></div>
        </div>
        <p class="mt-4 text-gray-600 text-sm">Click on a person's card to **show/hide their descendants**.</p>
        <p class="text-xs mt-2 text-gray-500 font-bold">Please note: A person with multiple partner cards linked  is a person who has had multiple documented partners.</p>
    </div>

    <script>
        // Data containing all family members.
        // NOTE: The visualization requires children_ids and spouse_ids to build the tree structure.
        const peopleData = [
            // --- GEN 1 ---
            { id: '231', name: 'Moshe Barenbaum', gender: 'M', birth_year: 1850, death_year: null, children_ids: ['232', '258', '267'], spouse_ids: ['234'] },
            { id: '234', name: 'Rachel ?', gender: 'F', birth_year: null, death_year: null, children_ids: ['232', '258', '267'] },

            // --- GEN 2 (Children of Moshe Barenbaum & Rachel ?) ---
            // Child 1: Rivka Barenbaum
            { id: '232', name: 'Rivka Barenbaum', gender: 'F', birth_year: 1889, death_year: 1943, children_ids: ['235', '241', '251', '252', '253'], spouse_ids: ['233'] },
            { id: '233', name: 'Shmuel Bromberg', gender: 'M', birth_year: null, death_year: null, children_ids: ['235', '241', '251', '252', '253'] },
            // Child 2: Szejwa Barenbaum
            { id: '258', name: 'Szejwa Barenbaum', gender: 'F', birth_year: null, death_year: null, children_ids: ['259', '261', '264', '265', '266'], spouse_ids: ['257'] },
            { id: '257', name: 'Aaron Galler', gender: 'M', birth_year: null, death_year: null, children_ids: ['259', '261', '264', '265', '266'] },
            // Child 3: Unknown Barenbaum
            { id: '267', name: 'Unknown Barenbaum', gender: 'U', birth_year: 1870, death_year: null, children_ids: ['268'], spouse_ids: ['269'] },
            { id: '269', name: 'Moshe ?', gender: 'M', birth_year: null, death_year: null, children_ids: ['268'] },

            // --- GEN 3 (Children of Rivka Barenbaum & Shmuel Bromberg) ---
            // Child 1: Molly Bromberg
            { id: '235', name: 'Molly Bromberg', gender: 'F', birth_year: 1912, death_year: 2007, children_ids: ['237', '239'], spouse_ids: ['236'] },
            { id: '236', name: 'Hymie Myers', gender: 'M', birth_year: null, death_year: null, children_ids: ['237', '239'] },
            // Child 2: Moshe Yosef Bromberg
            { id: '241', name: 'Moshe Yosef Bromberg', gender: 'M', birth_year: 1913, death_year: 1996, children_ids: ['242', '246', '250'], spouse_ids: ['240'] },
            { id: '240', name: 'Rachel Witta Weinberger', gender: 'F', birth_year: null, death_year: null, children_ids: ['242', '246', '250'] },
            // Child 3-5: David, Rachel, Abraham (no descendants in the list)
            { id: '251', name: 'David Bromberg', gender: 'M', birth_year: 1918, death_year: 1945 },
            { id: '252', name: 'Rachel Bromberg', gender: 'F', birth_year: 1920, death_year: 1943 },
            { id: '253', name: 'Abraham Abba Bromberg', gender: 'M', birth_year: 1922, death_year: 1943 },

            // --- GEN 3 (Children of Szejwa Barenbaum & Aaron Galler) ---
            // Child 1: Minnie Galler
            { id: '259', name: 'Minnie Galler', gender: 'F', birth_year: 1900, death_year: 1980, children_ids: ['260', '292'], spouse_ids: ['270'] },
            { id: '270', name: 'Jacob Sims', gender: 'M', birth_year: null, death_year: null, children_ids: ['260', '292'] },
            // Child 2: Eva Galler
            { id: '261', name: 'Eva Galler', gender: 'F', birth_year: 1904, death_year: 1997, children_ids: ['262'], spouse_ids: ['271'] },
            { id: '271', name: 'Samuel Treiger', gender: 'M', birth_year: 1902 , death_year: 1990, children_ids: ['262'] },
            // Child 3: Steve Galler (no children)
            { id: '264', name: 'Steve Galler', gender: 'M', birth_year: 1905, death_year: 1982, spouse_ids: ['272', '273'] },
            { id: '272', name: 'Sadie Levin', gender: 'F', birth_year: 1908, death_year: 1995 },
            { id: '273', name: 'First Wife ?', gender: 'F', birth_year: null, death_year: null },
            // Child 4: Sausi Galler (no children)
            { id: '265', name: 'Sausi Galler', gender: 'U', birth_year: null, death_year: null, spouse_ids: ['274', '275'] },
            { id: '274', name: 'Dinnia ?', gender: 'U', birth_year: null, death_year: null },
            { id: '275', name: 'Aaron ?', gender: 'M', birth_year: null, death_year: null },
            // Child 5: Malke Galler
            { id: '266', name: 'Malke Galler', gender: 'F', birth_year: null, death_year: null, children_ids: ['276', '277'], spouse_ids: ['278'] },
            { id: '278', name: 'Husband of Malke Unknown', gender: 'M', birth_year: null, death_year: null, children_ids: ['276', '277'] },
            { id: '276', name: 'Son of Malke Unknown', gender: 'M', birth_year: null, death_year: null },
            { id: '277', name: 'Daughter of Malke Unknown', gender: 'F', birth_year: null, death_year: null },

            // --- GEN 3 (Children of Unknown Barenbaum & Moshe ?) ---
            // Child 1: Esther Barenbaum
            { id: '268', name: 'Esther Barenbaum', gender: 'F', birth_year: 1900, death_year: 1982, children_ids: ['279', '281', '284'], spouse_ids: ['280'] },
            { id: '280', name: 'Yesha\'Ayahu Hazan', gender: 'M', birth_year: null, death_year: null, children_ids: ['279', '281', '284'] },

            // --- GEN 4 (Children of Molly Bromberg & Hymie Myers) ---
            // Child 1: Martin Myers
            { id: '237', name: 'Martin Myers', gender: 'M', birth_year: 1945, death_year: 'Alive', children_ids: ['286', '288'], spouse_ids: ['287', '289'] }, 
            { id: '287', name: 'Nancy Myers', gender: 'F', birth_year: 1972, death_year: null, children_ids: ['286', '288'] },
            { id: '289', name: 'Patty Beltran', gender: 'F', birth_year: 1995, death_year: null }, 
            // Child 2: Karen Myers
            { id: '239', name: 'Karen Myers', gender: 'F', birth_year: 1949, death_year: 'Alive', children_ids: ['243'], spouse_ids: ['238'] },
            { id: '238', name: 'Bob Yukich', gender: 'M', birth_year: 1979, death_year: null, children_ids: ['243'] },

            // --- GEN 4 (Children of Moshe Yosef Bromberg & Rachel Witta Weinberger) ---
            // Child 1: Rivka Bromberg
            { id: '242', name: 'Rivka Bromberg', gender: 'F', birth_year: 1948, death_year: 'Alive', children_ids: ['294', '296', '298'], spouse_ids: ['293'] },
            { id: '293', name: 'Nissim Pilosof', gender: 'M', birth_year: 1977, death_year: null, children_ids: ['294', '296', '298'] },
            // Child 2: Nesya Bromberg
            { id: '246', name: 'Nesya Bromberg', gender: 'F', birth_year: 1950, death_year: 'Alive', children_ids: ['303', '311', '315', '318', '321_younger'], spouse_ids: ['302'] },
            { id: '302', name: 'Aryeh Junger', gender: 'M', birth_year: null, death_year: null, children_ids: ['303', '311', '315', '318', '321_younger'] },
            // Child 3: Shmuel Bromberg
            { id: '250', name: 'Shmuel Bromberg', gender: 'M', birth_year: 1953, death_year: 'Alive', children_ids: ['322', '326', '330'], spouse_ids: ['320'] },
            { id: '320', name: 'Chana Noa Izaks', gender: 'F', birth_year: 1978, death_year: null, children_ids: ['322', '326', '330'] },

            // --- GEN 4 (Children of Minnie Galler & Jacob Sims) ---
            // Child 1: Bernice Marlene Sims
            { id: '260', name: 'Bernice Marlene Sims', gender: 'F', birth_year: 1919, death_year: 1995, children_ids: ['333', '337'], spouse_ids: ['332'] },
            { id: '332', name: 'Morris Brown', gender: 'M', birth_year: 1920, death_year: 2004, children_ids: ['333', '337'] },
            // Child 2: Rae Sims
            { id: '292', name: 'Rae Sims', gender: 'F', birth_year: 1927, death_year: 1984 },

            // --- GEN 4 (Children of Eva Galler & Samuel Treiger) ---
            // Child 1: Marvin Treiger
            { id: '262', name: 'Marvin Treiger', gender: 'M', birth_year: 1938, death_year: 'Alive', children_ids: ['263'], spouse_ids: ['342', '343'] },
            { id: '342', name: 'Catherine Milite', gender: 'F', birth_year: null, death_year: null },
            { id: '343', name: 'Wendy Lee Dare', gender: 'F', birth_year: null, death_year: null },

            // --- GEN 4 (Children of Esther Barenbaum & Yesha\'Ayahu Hazan) ---
            // Child 1: Ahuva Hazan
            { id: '279', name: 'Ahuva Hazan', gender: 'F', birth_year: 1925, death_year: 2006, children_ids: ['344', '345'], spouse_ids: ['346'] },
            { id: '346', name: 'Moshe Zazelman', gender: 'M', birth_year: null, death_year: null, children_ids: ['344', '345'] },
            // Child 2: Zipporah Hazan
            { id: '281', name: 'Zipporah Hazan', gender: 'F', birth_year: null, death_year: 'Alive', children_ids: ['347', '348', '349'], spouse_ids: ['350'] },
            { id: '350', name: 'Moshe Zohar', gender: 'M', birth_year: null, death_year: null, children_ids: ['347', '348', '349'] },
            // Child 3: Ayala Hazan
            { id: '284', name: 'Ayala Hazan', gender: 'F', birth_year: null, death_year: 2020, children_ids: ['351'], spouse_ids: ['352'] },
            { id: '352', name: '?? Vasiman', gender: 'M', birth_year: null, death_year: null, children_ids: ['351'] },

            // --- GEN 5 (Children of Martin Myers & Nancy Myers) ---
            // Child 1 (with Nancy): Carla Myers
            { id: '286', name: 'Carla Myers', gender: 'F', birth_year: 1974, death_year: 'Alive', children_ids: ['353'], spouse_ids: ['354'] },
            { id: '354', name: '? ?', gender: 'U', birth_year: null, death_year: null, children_ids: ['353'] },
            // Child 2 (with Nancy): Rebecca Myers
            { id: '288', name: 'Rebecca Myers', gender: 'F', birth_year: 1976, death_year: 'Alive', children_ids: ['355', '356'], spouse_ids: ['357', '358'] },
            { id: '357', name: 'Scott Labby', gender: 'M', birth_year: 2013, death_year: null, children_ids: ['355'] },
            { id: '358', name: 'Seth Frader-Thompson', gender: 'M', birth_year: null, death_year: null, children_ids: ['356'] },

            // --- GEN 5 (Children of Karen Myers & Bob Yukich) ---
            // Child 1: Aaron Yukich
            { id: '243', name: 'Aaron Yukich', gender: 'M', birth_year: 1981, death_year: 'Alive', children_ids: [], spouse_ids: ['244'] },
            { id: '244', name: 'Ana', gender: 'F', birth_year: null, death_year: null },

            // --- GEN 5 (Children of Rivka Bromberg & Nissim Pilosof) ---
            // Child 1: Noah Pilosof
            { id: '294', name: 'Noah Pilosof', gender: 'M', birth_year: 1986, death_year: 'Alive' },
            // Child 2: Oren Pilosof
            { id: '296', name: 'Oren Pilosof', gender: 'M', birth_year: null, death_year: 'Alive', children_ids: ['295'], spouse_ids: ['297'] },
            { id: '297', name: 'Aya ?', gender: 'F', birth_year: null, death_year: null, children_ids: ['295'] },
            // Child 3: Shai Pilosof
            { id: '298', name: 'Shai Pilosof', gender: 'M', birth_year: null, death_year: 'Alive', children_ids: ['299', '300', '301'], spouse_ids: ['304_spouse'] },
            { id: '304_spouse', name: '?? ?', gender: 'U', birth_year: null, death_year: null, children_ids: ['299', '300', '301'] },

            // --- GEN 5 (Children of Nesya Bromberg & Aryeh Junger) ---
            // Child 1: Eran Junger
            { id: '303', name: 'Eran Junger', gender: 'M', birth_year: 1972, death_year: 'Alive', children_ids: ['305', '306', '307', '308', '309', '310', '361_a', '397_a'], spouse_ids: ['304_spouse_2'] },
            { id: '304_spouse_2', name: 'Anat ?', gender: 'F', birth_year: 1996, death_year: null, children_ids: ['305', '306', '307', '308', '309', '310', '361_a', '397_a'] },
            // Child 2: Ohad Junger
            { id: '311', name: 'Ohad Junger', gender: 'M', birth_year: 1977, death_year: 'Alive', children_ids: ['312', '313', '314', '362_a', '363_a'], spouse_ids: ['364'] },
            { id: '364', name: 'Yael ?', gender: 'F', birth_year: null, death_year: null, children_ids: ['312', '313', '314', '362_a', '363_a'] },
            // Child 3: Alon Junger
            { id: '315', name: 'Alon Junger', gender: 'M', birth_year: null, death_year: 'Alive', children_ids: ['316', '317'], spouse_ids: ['365'] },
            { id: '365', name: 'Sivan ?', gender: 'F', birth_year: null, death_year: null, children_ids: ['316', '317'] },
            // Child 4: Michal Junger
            { id: '318', name: 'Michal Junger', gender: 'F', birth_year: null, death_year: 'Alive', children_ids: ['366', '367', '368', '369', '370', '371', '372', '373', '374', '375'], spouse_ids: ['376'] },
            { id: '376', name: 'Natti Ben Moshe', gender: 'M', birth_year: null, death_year: null, children_ids: ['366', '367', '368', '369', '370', '371', '372', '373', '374', '375'] },
            // Child 5: Yael Junger (no spouse/children)
            { id: '321_younger', name: 'Yael Junger', gender: 'F', birth_year: null, death_year: 'Alive' },

            // --- GEN 5 (Children of Shmuel Bromberg & Chana Noa Izaks) ---
            // Child 1: Noga Bromberg
            { id: '322', name: 'Noga Bromberg', gender: 'F', birth_year: 1980, death_year: 'Alive', children_ids: ['323', '324', '325', '380', '381'], spouse_ids: ['327'] },
            { id: '327', name: 'Avi Grossman', gender: 'M', birth_year: 2003, death_year: null, children_ids: ['323', '324', '325', '380', '381'] },
            // Child 2: Merav Bromberg
            { id: '326', name: 'Merav Bromberg', gender: 'F', birth_year: 1982, death_year: 'Alive', children_ids: ['328', '329', '382', '383'], spouse_ids: ['321_spouse'] },
            { id: '321_spouse', name: 'Yanai Ben Abou', gender: 'M', birth_year: 2007, death_year: null, children_ids: ['328', '329', '382', '383'] },
            // Child 3: Amitai Bromberg
            { id: '330', name: 'Amitai Bromberg', gender: 'M', birth_year: 1988, death_year: 'Alive', children_ids: ['331', '384', '385'], spouse_ids: ['386'] },
            { id: '386', name: 'Noga Amran', gender: 'F', birth_year: 1989, death_year: null, children_ids: ['331', '384', '385'] },

            // --- GEN 5 (Children of Bernice Marlene Sims & Morris Brown) ---
            // Child 1: Alan Brown
            { id: '333', name: 'Alan Brown', gender: 'M', birth_year: 1942, death_year: 'Alive', children_ids: ['334', '335', '336'], spouse_ids: ['387', '388'] },
            { id: '387', name: 'Jacqueline Sue Levine', gender: 'F', birth_year: 1965, death_year: null, children_ids: ['334', '335', '336'] },
            { id: '388', name: 'Lori Sue Gilberg', gender: 'F', birth_year: 1983, death_year: null }, // No children listed with Lori
            // Child 2: Adrienne Brown
            { id: '337', name: 'Adrienne Brown', gender: 'F', birth_year: 1948, death_year: 'Alive', children_ids: ['338', '339'], spouse_ids: ['390'] },
            { id: '390', name: 'Joseph Breen', gender: 'M', birth_year: null, death_year: null, children_ids: ['338', '339'] },

            // --- GEN 5 (Children of Marvin Treiger) ---
            // Child 1: Stefan Wolf Arnold (Assuming child with Catherine Milite or Wendy Lee Dare)
            { id: '263', name: 'Stefan Wolf Arnold', gender: 'M', birth_year: 1960, death_year: 'Alive', children_ids: ['391', '392'], spouse_ids: ['393'] },
            { id: '393', name: 'Stacey Lynn Richman', gender: 'F', birth_year: null, death_year: null, children_ids: ['391', '392'] },

            // --- GEN 5 (Children of Ahuva Hazan & Moshe Zazelman) ---
            // Child 1-2: Yossie, Chaim
            { id: '344', name: 'Yossie Zazelman', gender: 'M', birth_year: null, death_year: 'Alive' },
            { id: '345', name: 'Chaim Zazelman', gender: 'M', birth_year: null, death_year: 'Alive' },

            // --- GEN 5 (Children of Zipporah Hazan & Moshe Zohar) ---
            // Child 1-3: Tal, Mor, Liora
            { id: '347', name: 'Tal Zohar', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '348', name: 'Mor Zohar', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '349', name: 'Liora Zohar', gender: 'F', birth_year: null, death_year: 'Alive' },

            // --- GEN 5 (Children of Ayala Hazan & ?? Vasiman) ---
            // Child 1: Omri Vasiman
            { id: '351', name: 'Omri Vasiman', gender: 'M', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Carla Myers) ---
            // Child 1: Peter Myers
            { id: '353', name: 'Peter Myers', gender: 'M', birth_year: 1996, death_year: 'Alive' },

            // --- GEN 6 (Children of Rebecca Myers) ---
            // Child 1 (with Scott Labby): Maren Labby
            { id: '355', name: 'Maren Labby', gender: 'F', birth_year: 2015, death_year: 'Alive' },
            // Child 2 (with Seth Frader-Thompson): Sam Frader-Thompson
            { id: '356', name: 'Sam Frader-Thompson', gender: 'U', birth_year: 2010, death_year: 'Alive' },

            // --- GEN 6 (Children of Oren Pilosof) ---
            // Child 1: Ayala Pilosof
            { id: '295', name: 'Ayala Pilosof', gender: 'F', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Shai Pilosof) ---
            // Child 1-3: Ofek, Gal, Agam
            { id: '299', name: 'Ofek Pilosof', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '300', name: 'Gal Pilosof', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '301', name: 'Agam Pilosof', gender: 'U', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Eran Junger) ---
            // Child 1-5: Moshe Eitan, Ayala, Naomi, Talya, Levi Yitzhak
            { id: '305', name: 'Moshe Eitan Junger', gender: 'M', birth_year: 1997, death_year: 'Alive' },
            { id: '306', name: 'Ayala Junger', gender: 'F', birth_year: 2000, death_year: 'Alive' },
            { id: '307', name: 'Naomi Junger', gender: 'F', birth_year: 2003, death_year: 'Alive' },
            { id: '308', name: 'Talya Junger', gender: 'F', birth_year: 2005, death_year: 'Alive' },
            { id: '309', name: 'Levi Yitzhak Junger', gender: 'M', birth_year: null, death_year: 'Alive' },
            // Child 6: Eshdat Junger
            { id: '310', name: 'Eshdat Junger', gender: 'U', birth_year: null, death_year: 'Alive', children_ids: ['394'], spouse_ids: ['395'] },
            { id: '395', name: 'Srael ?', gender: 'U', birth_year: null, death_year: null, children_ids: ['394'] },
            // Child 7-8: Zion, Ma\'Ayan
            { id: '361_a', name: 'Zion Junger', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '397_a', name: 'Ma\'Ayan Junger', gender: 'U', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Ohad Junger) ---
            // Child 1: Binyamin Junger
            { id: '312', name: 'Binyamin Junger', gender: 'M', birth_year: 2003, death_year: 'Alive' },
            // Child 2: Oriya Matan Junger
            { id: '313', name: 'Oriya Matan Junger', gender: 'U', birth_year: null, death_year: 'Alive' },
            // Child 3: Tal Junger
            { id: '314', name: 'Tal Junger', gender: 'F', birth_year: null, death_year: 'Alive', children_ids: ['396'], spouse_ids: ['398'] },
            { id: '398', name: 'Maor Barjel', gender: 'M', birth_year: null, death_year: null, children_ids: ['396'] },
            // Child 4-5: Noam, Chen
            { id: '362_a', name: 'Noam Junger', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '363_a', name: 'Chen Junger', gender: 'U', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Alon Junger) ---
            // Child 1-2: Mia, Gal
            { id: '316', name: 'Mia Junger', gender: 'F', birth_year: null, death_year: 'Alive' },
            { id: '317', name: 'Gal Junger', gender: 'U', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Michal Junger & Natti Ben Moshe) ---
            // Child 1: Yonatan Ben Moshe
            { id: '366', name: 'Yonatan Ben Moshe', gender: 'M', birth_year: null, death_year: 'Alive', children_ids: [], spouse_ids: ['399'] },
            { id: '399', name: 'Malchut ?', gender: 'F', birth_year: null, death_year: null },
            // Child 2: Inon Ben Moshe
            { id: '367', name: 'Inon Ben Moshe', gender: 'M', birth_year: null, death_year: 'Alive' },
            // Child 3: Malchut Ben Moshe
            { id: '368', name: 'Malchut Ben Moshe', gender: 'F', birth_year: null, death_year: 'Alive' },
            // Child 4: Ori Ben Moshe
            { id: '369', name: 'Ori Ben Moshe', gender: 'U', birth_year: null, death_year: 'Alive' },
            // Child 5: Shir Ben Moshe
            { id: '370', name: 'Shir Ben Moshe', gender: 'U', birth_year: null, death_year: 'Alive' },
            // Child 6: Yehuda Ben Moshe
            { id: '371', name: 'Yehuda Ben Moshe', gender: 'M', birth_year: null, death_year: 'Alive' },
            // Child 7: Noa Ben Moshe
            { id: '372', name: 'Noa Ben Moshe', gender: 'F', birth_year: null, death_year: 'Alive' },
            // Child 8: Noam Ben Moshe
            { id: '373', name: 'Noam Ben Moshe', gender: 'U', birth_year: null, death_year: 'Alive', children_ids: [], spouse_ids: ['400'] },
            { id: '400', name: 'Hadas ?', gender: 'F', birth_year: null, death_year: null },
            // Child 9: Arie Ben Moshe
            { id: '374', name: 'Arie Ben Moshe', gender: 'M', birth_year: null, death_year: 'Alive' },
            // Child 10: Tamar Ben Moshe
            { id: '375', name: 'Tamar Ben Moshe', gender: 'F', birth_year: null, death_year: 'Alive' },

            // --- GEN 6 (Children of Noga Bromberg & Avi Grossman) ---
            // Child 1-5: Roi Baruch, Maayan Ziva, Yishai Ido, Eyal Moshe, Yael Tziyon
            { id: '323', name: 'Roi Baruch Grossman', gender: 'M', birth_year: 2004, death_year: 'Alive' },
            { id: '324', name: 'Maayan Ziva Grossman', gender: 'F', birth_year: 2006, death_year: 'Alive' },
            { id: '325', name: 'Yishai Ido Grossman', gender: 'M', birth_year: 2008, death_year: 'Alive' },
            { id: '380', name: 'Eyal Moshe Grossman', gender: 'M', birth_year: 2011, death_year: 'Alive' },
            { id: '381', name: 'Yael Tziyon Grossman', gender: 'F', birth_year: 2014, death_year: 'Alive' },

            // --- GEN 6 (Children of Merav Bromberg & Yanai Ben Abou) ---
            // Child 1-4: Yair Moshe, Avishai Yosef, Beeri Ido, Omer Shlomo
            { id: '328', name: 'Yair Moshe Ben Abou', gender: 'M', birth_year: 2013, death_year: 'Alive' },
            { id: '329', name: 'Avishai Yosef Ben Abou', gender: 'M', birth_year: 2016, death_year: 'Alive' },
            { id: '382', name: 'Beeri Ido Ben Abou', gender: 'M', birth_year: 2019, death_year: 'Alive' },
            { id: '383', name: 'Omer Shlomo Ben Abou', gender: 'M', birth_year: 2025, death_year: 'Alive' },

            // --- GEN 6 (Children of Amitai Bromberg & Noga Amran) ---
            // Child 1-3: Ido Baruch, Hadas Rachel, Ariel Moshe
            { id: '331', name: 'Ido Baruch Bromberg', gender: 'M', birth_year: 2019, death_year: 'Alive' },
            { id: '384', name: 'Hadas Rachel Bromberg', gender: 'F', birth_year: 2022, death_year: 'Alive' },
            { id: '385', name: 'Ariel Moshe Bromberg', gender: 'M', birth_year: 2024, death_year: 'Alive' },

            // --- GEN 6 (Children of Alan Brown & Jacqueline Sue Levine) ---
            // Child 1: Sheryl Rachel Brown
            { id: '334', name: 'Sheryl Rachel Brown', gender: 'F', birth_year: 1967, death_year: 'Alive', children_ids: ['401', '403', '405'], spouse_ids: ['402'] },
            { id: '402', name: 'Mark Seef', gender: 'M', birth_year: 1965, death_year: null, children_ids: ['401', '403', '405'] },
            // Child 2: Deborah Beth Brown
            { id: '335', name: 'Deborah Beth Brown', gender: 'F', birth_year: 1968, death_year: 'Alive' },
            // Child 3: Janice Lynne Brown
            { id: '336', name: 'Janice Lynne Brown', gender: 'F', birth_year: 1972, death_year: 'Alive', children_ids: ['406', '407', '408', '409'], spouse_ids: ['410'] },
            { id: '410', name: 'Barry Jonathan Gork', gender: 'M', birth_year: 1964, death_year: null, children_ids: ['406', '407', '408', '409'] },

            // --- GEN 6 (Children of Adrienne Brown & Joseph Breen) ---
            // Child 1: Michael Breen
            { id: '338', name: 'Michael Breen', gender: 'M', birth_year: 1985, death_year: 'Alive', children_ids: ['411', '412'], spouse_ids: ['413'] },
            { id: '413', name: 'Miranda Blaine Borkan', gender: 'F', birth_year: 1992, death_year: null, children_ids: ['411', '412'] },
            // Child 2: Scott Breen
            { id: '339', name: 'Scott Breen', gender: 'M', birth_year: 1988, death_year: 'Alive', children_ids: [], spouse_ids: ['414'] },
            { id: '414', name: 'Shannon Fineran', gender: 'F', birth_year: 2024, death_year: null },

            // --- GEN 6 (Children of Stefan Wolf Arnold & Stacey Lynn Richman) ---
            // Child 1-2: Lex, Asher
            { id: '391', name: 'Lex Arnold', gender: 'U', birth_year: null, death_year: 'Alive' },
            { id: '392', name: 'Asher Arnold', gender: 'U', birth_year: null, death_year: 'Alive' },

            // --- GEN 7 (Children of Eshdat Junger) ---
            // Child 1: X ?
            { id: '394', name: 'X ?', gender: 'U', birth_year: null, death_year: 'Alive' },

            // --- GEN 7 (Children of Tal Junger) ---
            // Child 1: Yonatan Barjel
            { id: '396', name: 'Yonatan Barjel', gender: 'M', birth_year: null, death_year: 'Alive' },

            // --- GEN 7 (Children of Sheryl Rachel Brown & Mark Seef) ---
            // Child 1: Abigail Seef
            { id: '401', name: 'Abigail Seef', gender: 'F', birth_year: 1996, death_year: 'Alive', children_ids: ['415'], spouse_ids: ['416'] },
            { id: '416', name: 'Grant Greenberg', gender: 'M', birth_year: 1996, death_year: null, children_ids: ['415'] },
            // Child 2: Joshua Seef
            { id: '403', name: 'Joshua Seef', gender: 'M', birth_year: 1999, death_year: 'Alive', children_ids: [], spouse_ids: ['404'] },
            { id: '404', name: 'Ally Rosenbaum', gender: 'F', birth_year: 2021, death_year: null },
            // Child 3: David Seef
            { id: '405', name: 'Carly Seef', gender: 'F', birth_year: 2005, death_year: 'Alive' },

            // --- GEN 7 (Children of Janice Lynne Brown & Barry Jonathan Gork) ---
            // Child 1-4: Nathan, Mia, Ethan, Jacob
            { id: '406', name: 'Olivia Gork', gender: 'F', birth_year: 2002, death_year: 'Alive' },
            { id: '407', name: 'Mallory Gork', gender: 'F', birth_year: 2004, death_year: 'Alive' },
            { id: '408', name: 'Avery Gork', gender: 'M', birth_year: 2006, death_year: 'Alive' },
            { id: '409', name: 'Tyler Gork', gender: 'M', birth_year: 2009, death_year: 'Alive' },

            // --- GEN 7 (Children of Michael Breen & Miranda Blaine Borkan) ---
            // Child 1-2: Emma, Charlie
            { id: '411', name: 'Charlotte Breen', gender: 'F', birth_year: 2020, death_year: 'Alive' },
            { id: '412', name: 'Eloise Breen', gender: 'F', birth_year: 2022, death_year: 'Alive' },

            // --- GEN 8 (Children of Abigail Seef & Grant Greenberg) ---
            // Child 1: Elara Greenberg
            { id: '415', name: 'Reece Greenberg', gender: 'M', birth_year: 2023, death_year: 'Alive' }
        ];

     // Create a map for quick lookup
        const peopleMap = peopleData.reduce((map, person) => {
            map[person.id] = person;
            return map;
        }, {});

        const rootId = '231';
        const rootPerson = peopleMap[rootId];

        // Function to create the HTML for a single person card
        function createPersonCard(person, isSpouse) {
            const status = person.death_year === 'Alive' ? ' (Alive)' : (person.death_year ? ` (d. ${person.death_year})` : '');
            const dates = (person.birth_year || person.death_year) ?
                `<div class="text-xs text-gray-500 mt-1">${person.birth_year ? `b. ${person.birth_year}` : ''}${person.birth_year && person.death_year ? ' - ' : ''}${person.death_year || ''}</div>` :
                '';
            
            const card = document.createElement('div');
            card.className = `person-card gender-${person.gender} w-full`;
            card.setAttribute('data-id', person.id);
            
            // Only the main lineage person should have the click event to prevent double-toggling
            // If the person has children and is not just a spouse card, allow toggle
            if (!isSpouse || (person.children_ids && person.children_ids.length > 0)) { 
                 // Ensure only one click handler exists if this person is part of the main lineage
                card.onclick = toggleChildren;
            }

            // Create an icon based on gender/status
            let icon = '';
            if (person.gender === 'M') icon = '‚ôÇÔ∏è';
            else if (person.gender === 'F') icon = '‚ôÄÔ∏è';
            else icon = 'üë§';
            
            // Determine the arrow/icon for the children toggle, only show if children exist
            const childrenIndicator = person.children_ids && person.children_ids.length > 0 ? 
                    '<div class="text-xs mt-1 font-bold text-gray-700">‚¨áÔ∏è</div>' : 
                    '<div class="text-xs mt-1 font-bold text-gray-400">‚ö´</div>';

            card.innerHTML = `
                <div class="text-xl mb-1">${icon}</div>
                <div class="font-semibold text-sm leading-tight">${person.name}</div>
                <div class="text-xs font-mono text-gray-700">${person.id}</div>
                ${dates}
                ${person.note ? `<div class="text-xs mt-1 text-pink-700 font-medium">${person.note}</div>` : ''}
                ${childrenIndicator}
            `;
            return card;
        }

        // Toggles the visibility of the descendants container
        function toggleChildren(event) {
            // Find the immediate parent couple-node
            const coupleNode = event.currentTarget.closest('.couple-node');
            if (!coupleNode) return;

            // The descendants container is the second child of couple-node
            const descendantsContainer = coupleNode.querySelector('.descendants-container');
            if (descendantsContainer) {
                if (descendantsContainer.style.display === 'none' || descendantsContainer.style.display === '') {
                    descendantsContainer.style.display = 'flex';
                } else {
                    descendantsContainer.style.display = 'none';
                }
            }
        }

        // Recursively renders a single person/couple node and its descendants
        function renderNode(personId) {
            const person = peopleMap[personId];
            if (!person) return null;

            const coupleNode = document.createElement('div');
            coupleNode.className = 'couple-node';
            
            // 1. Couple Card Wrapper
            const coupleCardWrapper = document.createElement('div');
            coupleCardWrapper.className = 'couple-card-wrapper';

            // Main person card (always displayed first)
            const personCard = createPersonCard(person, false);
            coupleCardWrapper.appendChild(personCard);
            
            // --- Handle Multiple Spouses (using spouse_ids array) ---
            let spousesToRender = [];
            
            // Prioritize spouse_ids (array) if it exists and is an array
            if (person.spouse_ids && Array.isArray(person.spouse_ids)) {
                spousesToRender = person.spouse_ids;
            } else if (person.spouse_id) { // Fallback/compatibility check for old single-string property
                spousesToRender = [person.spouse_id];
            }

            spousesToRender.forEach(spouseId => {
                const spouse = peopleMap[spouseId];
                if (spouse) {
                    const spouseLine = document.createElement('div');
                    spouseLine.className = 'spouse-line';
                    coupleCardWrapper.appendChild(spouseLine);
                    // Pass true for isSpouse. They do not trigger the children toggle themselves.
                    coupleCardWrapper.appendChild(createPersonCard(spouse, true));
                }
            });
            
            coupleNode.appendChild(coupleCardWrapper);

            // 2. Children Connection (Vertical Line)
            // This line connects the couple/multiple spouses group to the children's horizontal line
            if (person.children_ids && person.children_ids.length > 0) {
                const vertLine = document.createElement('div');
                vertLine.className = 'children-line-vertical';
                coupleNode.appendChild(vertLine);

                // 3. Descendants Container (Horizontal line + children nodes)
                const descendantsContainer = document.createElement('div');
                descendantsContainer.className = 'descendants-container';
                descendantsContainer.style.display = 'none'; // Initially collapsed

                const childNodes = renderDescendants(person.children_ids);
                descendantsContainer.appendChild(childNodes);
                coupleNode.appendChild(descendantsContainer);
            }

            return coupleNode;
        }

        // Renders the list of siblings and the horizontal connector
        function renderDescendants(childrenIds) {
            const childrenHorizontalConnector = document.createElement('div');
            childrenHorizontalConnector.className = 'children-horizontal-connector';

            // Add horizontal line connecting all children
            const horizontalLine = document.createElement('div');
            horizontalLine.className = 'children-horizontal-line';
            childrenHorizontalConnector.appendChild(horizontalLine);

            // Render each child node recursively
            childrenIds.forEach(childId => {
                const childNodeWrapper = document.createElement('div');
                childNodeWrapper.className = 'child-node-wrapper';

                // Vertical line from horizontal connector to the child node
                const childVertLine = document.createElement('div');
                childVertLine.className = 'child-vertical-line';
                childNodeWrapper.appendChild(childVertLine);

                // The recursive call to render the child's own couple-node
                const childNode = renderNode(childId);
                if (childNode) {
                    childNodeWrapper.appendChild(childNode);
                }
                
                childrenHorizontalConnector.appendChild(childNodeWrapper);
            });

            return childrenHorizontalConnector;
        }

        // Main function to start rendering the tree
        function initFamilyTree() {
            const treeContainer = document.getElementById('familyTree');
            if (treeContainer && rootPerson) {
                const rootNode = renderNode(rootId);
                if (rootNode) {
                    treeContainer.appendChild(rootNode);
                }
            }

            // Manually expand the root node for visibility on load
            const rootNodeElement = document.querySelector(`.person-card[data-id="${rootId}"]`);
            const rootCoupleNode = rootNodeElement ? rootNodeElement.closest('.couple-node') : null;

            if (rootCoupleNode) {
                const rootDescendants = rootCoupleNode.querySelector('.descendants-container');
                if (rootDescendants) {
                    rootDescendants.style.display = 'flex';
                }
            }
        }

        window.onload = initFamilyTree;
    </script>
</body>
</html>
