<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>אתר המשפחה - Ben Abou, Bromberg ועוד</title>
    <link rel="stylesheet" href="/style.css" />
    <style>
        /* CSS קיימים */
        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background: #f2f6fc;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #0057a3;
            color: white;
            padding: 1rem;
            text-align: center;
            font-size: 1.8rem;
            font-weight: bold;
        }
        .menu-bar {
            background: #e9f1fb;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 10px;
            gap: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid #ccc;
        }
        .menu-bar a {
            display: flex;
            align-items: center;
            gap: 6px;
            background-color: white;
            color: #003366;
            text-decoration: none;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            transition: background 0.3s;
        }
        .menu-bar a:hover {
            background-color: #dceeff;
        }
        .content {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1rem;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        #langSelector {
            padding: 0.5rem;
            border-radius: 6px;
            background: #0057a3;
            color: white;
            cursor: pointer;
            font-weight: bold;
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
        }
    </style>
</head>
<body>
    <header>
        <div id="user-profile" style="text-align:left; padding:0.5rem;"></div>
        <select id="langSelector">
            <option value="he">עברית</option>
            <option value="en">English</option>
            <option value="fr">Français</option>
            <option value="yi">יידיש</option>
        </select>
        <img src="/assets/logo.png" alt="לוגו משפחתי" class="logo" />
        <h1 id="welcomeTitle">ברוכים הבאים לאתר המשפחה</h1>
        <h2 id="welcomeSubtitle">Ben Abou • Elharrar • Malca • ועוד</h2>
    </header>

    <section class="content">
        <h1 id="search-title">🔍 חיפוש באתר</h1>
        <div class="search-wrapper" style="position:relative; max-width:400px;">
            <input type="text" id="search-input" placeholder="הקלד שם או תיאור..." autocomplete="off" />
            <span class="search-icon" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); font-size:1.2rem;">🔍</span>
            <ul id="results" class="search-results" style="position:absolute; top:110%; right:0; left:0; background:white; border:1px solid #ccc; border-radius:6px; max-height:200px; overflow-y:auto; display:none; z-index:100;"></ul>
        </div>
    </section>

    <nav class="menu-bar">
        <a id="menuHome" href="/">🏠 עמוד ראשי</a>
        <a id="menuUpdates" href="about.html"><span>ℹ️</span> עמוד העדכונים</a>
        <a id="menuTree" href="/tree.html"><span>🧬</span> עץ המשפחה</a>
        <a id="menuChat" href="/chat.html"><span>🧑‍💻</span> צ'אט AI</a>
        <a id="menuContact" href="/contact-ways.html"><span>📩</span> אמצעי תקשורת משפחתיים</a>
        <a id="menuGallery" href="/gallery.html"><span>🖼️</span> גלריית תמונות</a>
        <a id="menuMemorial" href="/memorial.html"><span>🕯️</span> קיר זיכרון</a>
        <a id="menuTimeline" href="/timeline.html"><span>🗓️</span> ציר זמן</a>
        <a id="menuCalendar" href="/calendar.html"><span>📆</span> לוח שנה</a>
        <a id="menuForum" href="/forum.html"><span>👪</span> פורום משפחתי</a>
        <a id="menuBio" href="/biographies.html"><span>📖</span> ביוגרפיות</a>
        <a id="menuStats" href="/family-stats.html"><span>📊</span> סטטיסטיקות</a>
        <a id="menuUpdate" href="/update-request.html">עדכון פרטים</a>
        <a id="menuUploadPhoto" href="/upload-photo.html">העלאת תמונות</a>
        <a id="menuUploadVideo" href="/upload-video.html">העלאת סרטון</a>
        <a id="menuSearchAI" href="/search-ai.html">חיפוש AI</a>
        <a id="menuMigration" href="/migration-map.html">מפת נדודים</a>
        <a id="menuNewsletter" href="/newsletter.html"><span>📰</span> עלון</a>
        <a id="menuLogin" href="/login.html"><span>🔐</span> כניסת משתמשים</a>
        <a id="menuLogout" href="/logout">התנתקות</a>
    </nav>

    <main class="content">
        <section>
            <h3 id="sectionWelcome">🌟 ברוכים הבאים למרכז המשפחתי</h3>
            <p id="intro1">אתר זה נבנה עבור כל המשפחות: Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, ועוד – לשיתוף תמונות, הנצחות, עץ משפחה, הודעות ועוד.</p>
            <p id="intro2">ניתן להיכנס לפי צד משפחתי, לעדכן פרטים, לשוחח עם צ׳אט AI משפחתי ולחוות יחד היסטוריה מתועדת.</p>
        </section>

        <section>
            <h1 id="sectionTree">ברוכים הבאים לעץ המשפחה שלנו</h1>
            <ul class="features" id="featuresList">
                <li>🌳 עץ משפחה אינטראקטיבי</li>
                <li>� כניסת משתמשים והרשאות לפי צד משפחתי</li>
                <li>💬 קיר משפחתי לפוסטים ותגובות</li>
                <li>📨 מערכת הודעות פנימית</li>
                <li>🖼️ תצוגת גלריה למסמכים ותמונות</li>
                <li>🕯️ עמודי הנצחה עם נר דיגיטלי</li>
                <li>🌐 תפריט דו-לשוני (עברית/אנגלית)</li>
                <li>🔍 חיפוש חכם</li>
                <li>📧 תמיכה בניוזלטר</li>
                <li>🤖 צ’אט AI משפחתי עם תמיכה בנתוני משפחה</li>
                <li>📱 תמיכה בעיצוב רספונסיבי לנייד</li>
            </ul>
        </section>

        <section>
            <h2 id="newsTitle">חדשות ועדכונים</h2>
            <ul id="newsList">
                <li>הוספנו יכולת העלאת תמונות לעץ המשפחה.</li>
                <li>נפתחה מערכת ההודעות הפנימית לכל המשתמשים.</li>
                <li>ניתן להדליק נר דיגיטלי לעילוי נשמת יקיריכם.</li>
            </ul>
        </section>

        <section class="hero-image">
            <img src="/asset/family-hero.png" alt="תמונת משפחה" />
        </section>
    </main>

    <footer>
        <p id="footerText">&copy; 2025 אתר המשפחה • נבנה באהבה ע"י המשפחה •
            <a id="adminLink" href="/admin.html">🛠️ ניהול</a>
        </p>
    </footer>

    <script>
        const translations = {
            he: {
                title: "אתר המשפחה - Ben Abou, Elharrar ועוד",
                welcomeTitle: "ברוכים הבאים לאתר המשפחה",
                welcomeSubtitle: "Ben Abou • Elharrar • Malca • ועוד",
                searchTitle: "🔍 חיפוש באתר",
                searchPlaceholder: "הקלד שם או תיאור...",
                sectionWelcome: "🌟 ברוכים הבאים למרכז המשפחתי",
                intro1: "אתר זה נבנה עבור כל המשפחות: Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, ועוד – לשיתוף תמונות, הנצחות, עץ משפחה, הודעות ועוד.",
                intro2: "ניתן להיכנס לפי צד משפחתי, לעדכן פרטים, לשוחח עם צ׳אט AI משפחתי ולחוות יחד היסטוריה מתועדת.",
                sectionTree: "ברוכים הבאים לעץ המשפחה שלנו",
                features: [
                    "🌳 עץ משפחה אינטראקטיבי",
                    "🔐 כניסת משתמשים והרשאות לפי צד משפחתי",
                    "💬 קיר משפחתי לפוסטים ותגובות",
                    "📨 מערכת הודעות פנימית",
                    "🖼️ תצוגת גלריה למסמכים ותמונות",
                    "🕯️ עמודי הנצחה עם נר דיגיטלי",
                    "🌐 תפריט דו-לשוני (עברית/אנגלית)",
                    "🔍 חיפוש חכם",
                    "📧 תמיכה בניוזלטר",
                    "🤖 צ’אט AI משפחתי עם תמיכה בנתוני משפחה",
                    "📱 תמיכה בעיצוב רספונסיבי לנייד"
                ],
                newsTitle: "חדשות ועדכונים",
                news: [
                    "הוספנו יכולת העלאת תמונות לעץ המשפחה.",
                    "נפתחה מערכת ההודעות הפנימית לכל המשתמשים.",
                    "ניתן להדליק נר דיגיטלי לעילוי נשמת יקיריכם."
                ],
                footerText: "© 2025 אתר המשפחה • נבנה באהבה ע\"י המשפחה •",
                adminLink: "🛠️ ניהול",
                menus: ["🏠 עמוד ראשי", "ℹ️ עמוד העדכונים", "🧬 עץ המשפחה", "🧑‍💻 צ'אט AI", "📩 אמצעי תקשורת משפחתיים", "🖼️ גלריית תמונות", "🕯️ קיר זיכרון", "🗓️ ציר זמן", "📆 לוח שנה", "👪 פורום משפחתי", "📖 ביוגרפיות", "📊 סטטיסטיקות", "עדכון פרטים", "העלאת תמונות", "העלאת סרטון", "חיפוש AI", "מפת נדודים", "📰 עלון", "🔐 כניסת משתמשים", "התנתקות"]
            },
            en: {
                title: "Family Website - Ben Abou, Elharrar & more",
                welcomeTitle: "Welcome to the Family Website",
                welcomeSubtitle: "Ben Abou • Elharrar • Malca • and more",
                searchTitle: "🔍 Search the site",
                searchPlaceholder: "Type a name or description...",
                sectionWelcome: "🌟 Welcome to the Family Center",
                intro1: "This website was built for all families: Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, and more – to share photos, memorials, family tree, announcements and more.",
                intro2: "You can join by family side, update details, chat with the Family AI Chatbot and experience documented history together.",
                sectionTree: "Welcome to our Family Tree",
                features: [
                    "🌳 Interactive Family Tree",
                    "🔐 User login & permissions by family side",
                    "💬 Family wall for posts & comments",
                    "📨 Internal messaging system",
                    "🖼️ Gallery view for documents & photos",
                    "🕯️ Memorial pages with digital candles",
                    "🌐 Bilingual menu (Hebrew/English)",
                    "🔍 Smart search",
                    "📧 Newsletter support",
                    "🤖 Family AI Chat with family data",
                    "📱 Responsive design for mobile"
                ],
                newsTitle: "News & Updates",
                news: [
                    "Photo upload to the family tree is now available.",
                    "Internal messaging system is open to all users.",
                    "You can light a digital candle in memory of loved ones."
                ],
                footerText: "© 2025 Family Website • Built with love by the family •",
                adminLink: "🛠️ Admin",
                menus: ["🏠 Home", "ℹ️ Updates", "🧬 Family Tree", "🧑‍💻 AI Chat", "📩 Family Contacts", "🖼️ Gallery", "🕯️ Memorial Wall", "🗓️ Timeline", "📆 Calendar", "👪 Family Forum", "📖 Biographies", "📊 Statistics", "Update Details", "Upload Photo", "Upload Video", "AI Search", "Migration Map", "📰 Newsletter", "🔐 Login", "Logout"]
            },
            fr: {
                title: "Site de la Famille - Ben Abou, Elharrar et plus",
                welcomeTitle: "Bienvenue sur le site de la famille",
                welcomeSubtitle: "Ben Abou • Elharrar • Malca • et plus",
                searchTitle: "🔍 Rechercher sur le site",
                searchPlaceholder: "Tapez un nom ou une description...",
                sectionWelcome: "🌟 Bienvenue au centre familial",
                intro1: "Ce site a été créé pour toutes les familles : Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, et plus – pour partager photos, commémorations, arbre généalogique, annonces et plus.",
                intro2: "Vous pouvez entrer par côté familial, mettre à jour des détails, discuter avec le Chat IA Familial et vivre ensemble une histoire documentée.",
                sectionTree: "Bienvenue dans notre arbre généalogique",
                features: [
                    "🌳 Arbre généalogique interactif",
                    "🔐 Connexion & permissions par côté familial",
                    "💬 Mur familial pour publications & commentaires",
                    "📨 Système de messagerie interne",
                    "🖼️ Galerie pour documents & photos",
                    "🕯️ Pages commémoratives avec bougies numériques",
                    "🌐 Menu bilingue (hébreu/anglais)",
                    "🔍 Recherche intelligente",
                    "📧 Support bulletin",
                    "🤖 Chat IA Familial avec données de famille",
                    "📱 Design réactif pour mobile"
                ],
                newsTitle: "Actualités & mises à jour",
                news: [
                    "Ajout de l’option de téléverser des photos dans l’arbre généalogique.",
                    "Le système de messagerie interne est ouvert à tous les utilisateurs.",
                    "Vous pouvez allumer une bougie numérique en mémoire de vos proches."
                ],
                footerText: "© 2025 Site de la famille • Construit avec amour par la famille •",
                adminLink: "🛠️ Admin",
                menus: ["🏠 Accueil", "ℹ️ Mises à jour", "🧬 Arbre généalogique", "🧑‍💻 Chat IA", "📩 Contacts familiaux", "🖼️ Galerie", "🕯️ Mur commémoratif", "🗓️ Chronologie", "📆 Calendrier", "👪 Forum familial", "📖 Biographies", "📊 Statistiques", "Mettre à jour", "Téléverser photo", "Téléverser vidéo", "Recherche IA", "Carte migrations", "📰 Bulletin", "🔐 Connexion", "Déconnexion"]
            },
            yi: {
                title: "פאמיליע וועבזייט - בן אבו, אלהרר און מער",
                welcomeTitle: "ברוך הבא צום פאמיליע וועבזייט",
                welcomeSubtitle: "בן אבו • אלהרר • מאלקא • און מער",
                searchTitle: "🔍 זוך אויפן זייט",
                searchPlaceholder: "שרייב א נאמען אדער באשרייבונג...",
                sectionWelcome: "🌟 ברוך הבא צום פאמיליע צענטער",
                intro1: "דער זייט איז געבויט געווארן פאר אלע פאמיליעס: בן אבו, אלהרר, מאלקא, בן דוד, ברומבערג, בארנבאום, פאס-שנעק, וויינבערגער, לייבנער, וואן דער וואלדע, בער, דע פריז, איטאליאנדער, יצחקס, שאפאן און מער – צו טיילן בילדער, אנדענקען, פאמיליע בוים, מעלדונגען און מער.",
                intro2: "איר קענט אריינגיין לויט פאמיליע זייט, דערהייבן דעטאלן, שמועסן מיט דעם פאמיליע אינטעליגענט טשאַט און צוזאמען איבערלעבן דאקומענטירטע געשיכטע.",
                sectionTree: "ברוך הבא צו אונדזער פאמיליע בוים",
                features: [
                    "🌳 אינטעראקטיוו פאמיליע בוים",
                    "🔐 באנוצער איינזיין און דערלויבניש לויט פאמיליע זייט",
                    "💬 פאמיליע וואנט פאר פאסטס און קאמענטארן",
                    "📨 אינערלעך מעסעדזשינג סיסטעם",
                    "🖼️ גאלעריע פאר דאקומענטן און בילדער",
                    "🕯️ אנדענק בלאט מיט דיגיטאלישע ליכט",
                    "🌐 צוויי-שפראכיקע מעניו (העברעיש/ענגליש)",
                    "🔍 קלוגע זוך",
                    "📧 נייַבלאַט שטיץ",
                    "🤖 פאמיליע אינטעליגענט טשאַט מיט פאמיליע דאטן",
                    "📱 רעספאנסיוו דיזיין פאר מאביל"
                ],
                newsTitle: "נייַעס און דערהייבונגען",
                news: [
                    "צוגעגעבן די מעגלעכקייט צו דערהייבן בילדער צו דער פאמיליע בוים.",
                    "דער אינערלעך מעסעדזשינג סיסטעם איז אפן פאר אלע באנוצער.",
                    "איר קענט אָנצינדן א דיגיטאלישע ליכט לזכות אייערע ליבע פריינד."
                ],
                footerText: "© 2025 פאמיליע וועבזייט • געבויט מיט ליבע דורך די פאמיליע •",
                adminLink: "🛠️ אדמין",
                menus: ["🏠 הויפּט בלאַט", "ℹ️ דערהייבונגען", "🧬 פאמיליע בוים", "🧑‍💻 אינטעליגענט טשאַט", "📩 פאמיליע קאנטאקטן", "🖼️ גאלעריע", "🕯️ אנדענק וואנט", "🗓️ צייט-ליניע", "📆 קאלענדאר", "👪 פאמיליע פארום", "📖 ביאגראפיעס", "📊 סטאטיסטיק", "דערהייבן דעטאלן", "הייבן בילד", "הייבן ווידעא", "אינטעליגענט זוך", "מאַפּע פון וואַנדערונגען", "📰 נייַבלאַט", "🔐 איינזיין", "אויסלאגן"]
            }
        };

        document.addEventListener("DOMContentLoaded", () => {
            const langSelector = document.getElementById("langSelector");
            const userProfileDiv = document.getElementById("user-profile");
            const menuBar = document.querySelector(".menu-bar");

            let currentLang = localStorage.getItem("lang") || "he";
            let isLoggedIn = false;

            // עדכון השפה הראשונית של ה-select
            langSelector.value = currentLang;

            const textElementsMap = {
                "welcomeTitle": "welcomeTitle",
                "welcomeSubtitle": "welcomeSubtitle",
                "search-title": "searchTitle",
                "search-input": "searchPlaceholder",
                "sectionWelcome": "sectionWelcome",
                "intro1": "intro1",
                "intro2": "intro2",
                "sectionTree": "sectionTree",
                "newsTitle": "newsTitle",
                "footerText": "footerText",
                "adminLink": "adminLink"
            };

            const updateContent = (lang) => {
                const texts = translations[lang];
                if (!texts) return;

                // עדכון HTML, dir ו-title
                document.documentElement.lang = lang;
                document.documentElement.setAttribute("dir", (lang === "he" || lang === "yi") ? "rtl" : "ltr");
                document.title = texts.title;

                // עדכון אלמנטים לפי ID
                for (const id in textElementsMap) {
                    const key = textElementsMap[id];
                    const element = document.getElementById(id);
                    if (element) {
                        if (element.tagName === "INPUT") {
                            element.placeholder = texts.searchPlaceholder;
                        } else {
                            element.textContent = texts[key];
                        }
                    }
                }

                // עדכון רשימות
                const featuresList = document.getElementById("featuresList");
                if (featuresList) {
                    featuresList.innerHTML = texts.features.map(item => `<li>${item}</li>`).join('');
                }

                const newsList = document.getElementById("newsList");
                if (newsList) {
                    newsList.innerHTML = texts.news.map(item => `<li>${item}</li>`).join('');
                }

                // עדכון תפריט הניווט
                const menuItems = document.querySelectorAll('.menu-bar a');
                menuItems.forEach((link, index) => {
                    if (texts.menus[index]) {
                        link.innerHTML = texts.menus[index];
                    }
                });

                // עדכון פרופיל משתמש
                updateUserProfile(isLoggedIn, texts);
            };

            const updateUserProfile = (isUserLoggedIn, texts) => {
                isLoggedIn = isUserLoggedIn;
                const userProfile = document.getElementById("user-profile");
                if (isLoggedIn) {
                    // כאן ניתן לקרוא את שם המשתמש ותפקידו מה-API אם צריך
                    userProfile.innerHTML = `
                        <span style="font-weight:bold;">${texts.loggedInUser}</span>
                        <span style="color:gray;">(${texts.loggedInRole})</span>
                        <a href="/logout" style="margin-right:10px; color: red;">${texts.menus[texts.menus.length - 1]}</a>
                    `;
                    if (menuBar) menuBar.style.display = "flex";
                } else {
                    userProfile.innerHTML = `
                        <a href="/login.html" style="margin-right:10px; color: white;">${texts.menus[texts.menus.length - 2]}</a>
                    `;
                    if (menuBar) menuBar.style.display = "none";
                }
            };

            // סימולציה של קריאה לשרת
            fetch("/api/user")
                .then(res => res.ok ? res.json() : Promise.reject("User not logged in"))
                .then(user => {
                    isLoggedIn = !!user.username; // הגדרת סטטוס התחברות
                    updateContent(currentLang);
                })
                .catch(error => {
                    console.error("Error fetching user data:", error);
                    isLoggedIn = false;
                    updateContent(currentLang);
                });

            // האזנה לשינוי שפה
            langSelector.addEventListener("change", (event) => {
                currentLang = event.target.value;
                localStorage.setItem("lang", currentLang);
                updateContent(currentLang);
            });

            // הפעלת הפונקציה הראשונית
            updateContent(currentLang);
        });
    </script>
</body>
</html>

