<html> <lang="he" dir="rtl">
<head>
  <div id="user-profile" style="text-align:left; padding: 0.5rem;"></div>

<script>
  fetch("/api/user")
    .then(res => res.json())
    .then(user => {
      if (user.username)
        document.getElementById("user-profile").innerHTML = `
          <span style="font-weight:bold;">${user.username}</span>
          <span style="color:gray;">(${user.role})</span>
          <a href="/logout" style="margin-right:10px; color: red;">התנתק</a>
        `;
    });
</script>

  <meta charset="UTF-8" />
  <title>אתר המשפחה - Ben Abou, Elharrar ועוד</title>
  <link rel="stylesheet" href="/style.css" />
   <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: #f2f6fc;
      margin: 0;
      padding: 0;
    }
    header {
      background-color: #0057a3;
      color: white;
      padding: 1rem;
      text-align: center;
      font-size: 1.8rem;
      font-weight: bold;
    }
    .menu-bar {
      background: #e9f1fb;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 10px;
      gap: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      border-bottom: 1px solid #ccc;
    }
    .menu-bar a {
      display: flex;
      align-items: center;
      gap: 6px;
      background-color: white;
      color: #003366;
      text-decoration: none;
      padding: 6px 12px;
      border-radius: 8px;
      font-size: 0.9rem;
      transition: background 0.3s;
    }
    .menu-bar a:hover {
      background-color: #dceeff;
    }
    .content {
      max-width: 900px;
      margin: 2rem auto;
      padding: 1rem;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
</head>
<body>
  <header>
       <select id="langSelector" class="bg-blue-700 text-white p-2 rounded-lg">
                    <option value="he">עברית</option>
                    <option value="en">English</option>
                    <option value="fr">Français</option>
                    <option value="yi">יידיש</option>
                </select>
    <img src="/assets/logo.png" alt="לוגו משפחתי" class="logo" />
    <h1>ברוכים הבאים לאתר המשפחה</h1>
    <h2>Ben Abou • Elharrar • Malca • ועוד</h2>
  </header>
<h1>🔍 חיפוש באתר</h1>
  <input type="text" id="search" placeholder="הקלד שם או תיאור...">
 <div id="results"></div>
  <header>
  <nav>
    <ul>
       <div class="menu-bar">
      <a href="/">🏠 עמוד ראשי</a>
        <a href="about.html"> <span>ℹ️</span> עמוד העדכונים (Unavailable currently)</a>
      <a href="/tree.html"> <span>🧬</span> עץ המשפחה</a>
      <a href="/chat.html"> <span>🧑‍💻</span> צ'אט AI</a>
      <a href="/contact-ways.html"> <span>📩 </span> אמצעי תקשורת משפחתיים</a>
      <<a href="/gallery.html"> <span>🖼️</span> גלריית תמונות</a>
      ><a href="/memorial.html"><span>🕯️</span> קיר זיכרון</a>
      <<a href="/timeline.html"><span>🗓️</span> ציר זמן</a>
       <a href="/calendar.html"> <span>📆</span> לוח שנה</a>
      <a href="/forum.html"> <span>👪</span> פורום משפחתי</a>
        <a href="/biographies.html"><span>📖</span> ביוגרפיות</a>
        <li><a href="/family-stats.html"><span>📊</span> סטטיסטיקות</a>
       <a href="/update-request.html">עדכון פרטים</a>
        <a href="/upload-photo.html">העלאת תמונות</a>
        <a href="/upload-video.html">העלאת סרטון</a>
      <a href="/search-ai.html">חיפוש AI</a>
        <a href="/migration-map.html">מפת נדודים</a>
     <a href="/newsletter.html"><span>📰</span> עלון</a>
        <a href="/login.html"><span>🔐</span> כניסת משתמשים</a>
        <a href="/logout">התנתקות</a>
          </div>
    </ul>
  </nav>
  </header>
  <main>
    <section>
      <h3>🌟 ברוכים הבאים למרכז המשפחתי</h3>
      <p>אתר זה נבנה עבור כל המשפחות: Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum,Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, ועוד – לשיתוף תמונות, הנצחות, עץ משפחה, הודעות ועוד.</p>
      <p>ניתן להיכנס לפי צד משפחתי, לעדכן פרטים, לשוחח עם צ׳אט AI משפחתי ולחוות יחד היסטוריה מתועדת.</p>
    </section>
      <main>
    <h1>ברוכים הבאים לעץ המשפחה שלנו</h1>
    <ul class="features">
      <li>🌳עץ משפחה אינטראקטיבי</li>
      <li>🔐 כניסת משתמשים והרשאות לפי צד משפחתי</li>
      <li>💬 קיר משפחתי לפוסטים ותגובות</li>
      <li>📨 מערכת הודעות פנימית</li>
      <li>🖼️ תצוגת גלריה למסמכים ותמונות</li>
      <li>🕯️ עמודי הנצחה עם נר דיגיטלי</li>
      <li>🌐 תפריט דו-לשוני (עברית/אנגלית)</li>
      <li>🔍 חיפוש חכם</li>
      <li>📧 תמיכה ב-ניוזלטר</li>
      <li>🤖 צ’אט AI משפחתי עם תמיכה בנתוני משפחה</li>
      <li>📱 תמיכה בעיצוב רספונסיבי לנייד</li>
    </ul>
  </main>
        <section>
            <h2>חדשות ועדכונים</h2>
            <ul>
                <li>הוספנו יכולת העלאת תמונות לעץ המשפחה.</li>
                <li>נפתחה מערכת ההודעות הפנימית לכל המשתמשים.</li>
                <li>ניתן להדליק נר דיגיטלי לעילוי נשמת יקיריכם.</li>
            </ul>
        </section>
    <section class="hero-image">
      <img src="/asset/family-hero.png" alt="תמונת משפחה" />
    </section>
  <footer>
    <p>&copy; 2025 אתר המשפחה • נבנה באהבה ע"י המשפחה • <a href="/admin.html">🛠️ ניהול</a></p>
  </footer>
  </main>
           <script>
        document.addEventListener("DOMContentLoaded", () => {
            const translations = {
                "he": {
                    "title": "אתר המשפחה - Ben Abou, Elharrar ועוד",
                    "logout-link": "התנתק",
                    "login-link": "כניסה",
                    "welcome-title": "ברוכים הבאים לאתר המשפחה",
                    "family-names": "Ben Abou • Elharrar • Malca",
                    "search-title": "🔍 חיפוש באתר",
                    "search-placeholder": "הקלד שם או תיאור...",
                    "menu-home": "🏠 עמוד ראשי",
                    "menu-about": "<span>ℹ️</span> עמוד העדכונים (Unavailable currently)",
                    "menu-tree": "<span>🧬</span> עץ המשפחה",
                    "menu-chat": "<span>🧑‍💻</span> צ'אט AI",
                    "menu-contact": "<span>📩 </span> אמצעי תקשורת משפחתיים",
                    "menu-gallery": "<span>🖼️</span> גלריית תמונות",
                    "menu-memorial": "<span>🕯️</span> קיר זיכרון",
                    "menu-timeline": "<span>🗓️</span> ציר זמן",
                    "menu-calendar": "<span>📆</span> לוח שנה",
                    "menu-forum": "<span>👪</span> פורום משפחתי",
                    "menu-biographies": "<span>📖</span> ביוגרפיות",
                    "menu-stats": "<span>📊</span> סטטיסטיקות",
                    "menu-update": "עדכון פרטים",
                    "menu-upload-photo": "העלאת תמונות",
                    "menu-upload-video": "העלאת סרטון",
                    "menu-search-ai": "חיפוש AI",
                    "menu-migration-map": "מפת נדודים",
                    "menu-newsletter": "<span>📰</span> עלון",
                    "main-welcome-heading": "🌟 ברוכים הבאים למרכז המשפחתי",
                    "main-welcome-text": "אתר זה נבנה עבור כל המשפחות: Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, ועוד – לשיתוף תמונות, הנצחות, עץ משפחה, הודעות ועוד.",
                    "main-welcome-subtext": "ניתן להיכנס לפי צד משפחתי, לעדכן פרטים, לשוחח עם צ'אט AI משפחתי ולחוות יחד היסטוריה מתועדת.",
                    "tree-welcome-title": "ברוכים הבאים לעץ המשפחה שלנו",
                    "feature-tree": "🌳עץ משפחה אינטראקטיבי",
                    "feature-login": "� כניסת משתמשים והרשאות לפי צד משפחתי",
                    "feature-wall": "💬 קיר משפחתי לפוסטים ותגובות",
                    "feature-messages": "📨 מערכת הודעות פנימית",
                    "feature-gallery": "🖼️ תצוגת גלריה למסמכים ותמונות",
                    "feature-memorial": "🕯️ עמודי הנצחה עם נר דיגיטלי",
                    "feature-multilingual": "🌐 תפריט דו-לשוני (עברית/אנגלית)",
                    "feature-search": "🔍 חיפוש חכם",
                    "feature-newsletter": "📧 תמיכה ב-ניוזלטר",
                    "feature-ai": "🤖 צ'אט AI משפחתי עם תמיכה בנתוני משפחה",
                    "feature-responsive": "📱 תמיכה בעיצוב רספונסיבי לנייד",
                    "news-updates-heading": "חדשות ועדכונים",
                    "news-1": "הוספנו יכולת העלאת תמונות לעץ המשפחה.",
                    "news-2": "נפתחה מערכת ההודעות הפנימית לכל המשתמשים.",
                    "news-3": "ניתן להדליק נר דיגיטלי לעילוי נשמת יקיריכם.",
                    "footer-text": "&copy; 2025 אתר המשפחה • נבנה באהבה ע\"י המשפחה • <a href=\"/admin.html\" id=\"admin-link\">🛠️ ניהול</a>",
                    "alt-family-logo": "לוגו משפחתי",
                    "alt-family-photo": "תמונת משפחה",
                    "unavailable-message": "(Unavailable currently)"
                },
                "en": {
                    "title": "The Family Website - Ben Abou, Elharrar and more",
                    "logout-link": "Logout",
                    "login-link": "Login",
                    "welcome-title": "Welcome to the Family Website",
                    "family-names": "Ben Abou • Elharrar • Malca",
                    "search-title": "🔍 Search the site",
                    "search-placeholder": "Type a name or description...",
                    "menu-home": "🏠 Home Page",
                    "menu-about": "<span>ℹ️</span> Updates Page (Unavailable currently)",
                    "menu-tree": "<span>🧬</span> Family Tree",
                    "menu-chat": "<span>🧑‍💻</span> AI Chat",
                    "menu-contact": "<span>📩 </span> Family Communications",
                    "menu-gallery": "<span>🖼️</span> Photo Gallery",
                    "menu-memorial": "<span>🕯️</span> Memorial Wall",
                    "menu-timeline": "<span>🗓️</span> Timeline",
                    "menu-calendar": "<span>📆</span> Calendar",
                    "menu-forum": "<span>👪</span> Family Forum",
                    "menu-biographies": "<span>📖</span> Biographies",
                    "menu-stats": "<span>📊</span> Statistics",
                    "menu-update": "Update Details",
                    "menu-upload-photo": "Upload Photos",
                    "menu-upload-video": "Upload Video",
                    "menu-search-ai": "AI Search",
                    "menu-migration-map": "Migration Map",
                    "menu-newsletter": "<span>📰</span> Newsletter",
                    "main-welcome-heading": "🌟 Welcome to the Family Center",
                    "main-welcome-text": "This website was built for all families: Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, and more – to share photos, memorials, family tree, messages, and more.",
                    "main-welcome-subtext": "You can log in by family branch, update details, chat with a family AI, and together experience a documented history.",
                    "tree-welcome-title": "Welcome to Our Family Tree",
                    "feature-tree": "🌳 Interactive Family Tree",
                    "feature-login": "🔐 User Login and Permissions by Family Branch",
                    "feature-wall": "💬 Family Wall for Posts and Comments",
                    "feature-messages": "📨 Internal Messaging System",
                    "feature-gallery": "🖼️ Gallery Display for Documents and Photos",
                    "feature-memorial": "🕯️ Memorial Pages with a Digital Candle",
                    "feature-multilingual": "🌐 Multilingual Menu (Hebrew/English)",
                    "feature-search": "🔍 Smart Search",
                    "feature-newsletter": "📧 Newsletter Support",
                    "feature-ai": "🤖 Family AI Chat with Family Data Support",
                    "feature-responsive": "📱 Responsive Design for Mobile",
                    "news-updates-heading": "News and Updates",
                    "news-1": "We have added the ability to upload photos to the family tree.",
                    "news-2": "The internal messaging system is now open to all users.",
                    "news-3": "You can now light a digital candle in memory of your loved ones.",
                    "footer-text": "&copy; 2025 The Family Website • Built with love by the family • <a href=\"/admin.html\" id=\"admin-link\">🛠️ Admin</a>",
                    "alt-family-logo": "Family logo",
                    "alt-family-photo": "Family photo",
                    "unavailable-message": "(Currently Unavailable)"
                },
                "yi": {
                    "title": "די משפּחה וועבזייטל - בן אבּו, עלהרר און מער",
                    "logout-link": "אַרויסגיין",
                    "login-link": "אַרייַנגאַנג",
                    "welcome-title": "ברוכים הבאים צו דער משפּחה וועבזייטל",
                    "family-names": "בן אבּו • עלהרר • מאַלקאַ",
                    "search-title": "🔍 זוכען אויף דער וועבזייטל",
                    "search-placeholder": "שרייבט אַ נאָמען אָדער באַשרייַבונג...",
                    "menu-home": "🏠 הויפּט בלאַט",
                    "menu-about": "<span>ℹ️</span> אַרייַנפיר בלאַט (נישט בנימצא כרגע)",
                    "menu-tree": "<span>🧬</span> משפּחה בוים",
                    "menu-chat": "<span>🧑‍💻</span> אַי-טשאַט",
                    "menu-contact": "<span>📩 </span> משפּחה קאָמוניקאַציעס",
                    "menu-gallery": "<span>🖼️</span> פאָטאָ גאַלעריע",
                    "menu-memorial": "<span>🕯️</span> זכּרון וואַנט",
                    "menu-timeline": "<span>🗓️</span> צייט ליניע",
                    "menu-calendar": "<span>📆</span> לוח",
                    "menu-forum": "<span>👪</span> משפּחה פאָרום",
                    "menu-biographies": "<span>📖</span> ביאָגראַפֿיעס",
                    "menu-stats": "<span>📊</span> סטאַטיסטיקן",
                    "menu-update": "דערהייַנטיקן דעטאַלן",
                    "menu-upload-photo": "הייבן אַרויף פאָטאָס",
                    "menu-upload-video": "הייבן אַרויף ווידעאָ",
                    "menu-search-ai": "זוכען מיט אַי",
                    "menu-migration-map": "מאַפּע פֿון נדודים",
                    "menu-newsletter": "<span>📰</span> נייַעסלעטער",
                    "main-welcome-heading": "🌟 ברוכים הבאים צום משפּחה צענטער",
                    "main-welcome-text": "די דאָזיקע וועבזייטל איז געבויט געוואָרן פֿאַר אַלע משפּחות: בן אבּו, עלהרר, מאַלקאַ, בן דוד, בראָמבערג, באַרענבאַום, פֿאַס-שנעק, ווייַנבערגער, לייבנער, פֿאַן דער וועלדע, בער, דע פֿריס, איטאַליאַנדער, יזאַקס, טשאַפּאָן, און מער – צו טיילן בילדער, זכרונות, משפּחה בוים, מעלדונגען, און מער.",
                    "main-welcome-subtext": "איר קענט אַרייַנקומען דורך משפּחה צווייַג, דערהייַנטיקן דעטאַלן, רעדן מיט אַ משפּחה אַי-טשאַט און צוזאַמען איבערלעבן אַ דאָקומענטירטע געשיכטע.",
                    "tree-welcome-title": "ברוכים הבאים צו אונדזער משפּחה בוים",
                    "feature-tree": "🌳 אינטעראַקטיווער משפּחה בוים",
                    "feature-login": "🔐 באַניצער אַרייַנגאַנג און פּערמיסיעס לויט משפּחה צווייַג",
                    "feature-wall": "💬 משפּחה וואַנט פֿאַר פּאָסטן און קאָמענטאַרן",
                    "feature-messages": "📨 אינערלעכע מעלדונג סיסטעם",
                    "feature-gallery": "🖼️ גאַלעריע פֿאַר דאָקומענטן און בילדער",
                    "feature-memorial": "🕯️ זכּרון זייטן מיט אַ דיגיטאַלע ליכט",
                    "feature-multilingual": "🌐 מער-שפּראַכיקע מעניו (העברעיִש/ענגליש)",
                    "feature-search": " קלוגע זוכונג",
                    "feature-newsletter": "📧 נייַעסלעטער שטיצע",
                    "feature-ai": "🤖 משפּחה אַי טשאַט מיט שטיצע פֿון משפּחה דאַטן",
                    "feature-responsive": "📱 רעספּאָנסיווע דעזיין פֿאַר מאָביל",
                    "news-updates-heading": "נייַעס און דערהייַנטיקונגען",
                    "news-1": "מיר האָבן צוגעגעבן די מעגלעכקייט צו הייבן אַרויף בילדער צום משפּחה בוים.",
                    "news-2": "די אינערלעכע מעלדונג סיסטעם איז איצט אָפֿן פֿאַר אַלע באַניצער.",
                    "news-3": "איר קענט איצט צינדן אַ דיגיטאַלע ליכט לזכות נשמת אייערע ליב געהאַטע.",
                    "footer-text": "&copy; 2025 די משפּחה וועבזייטל • געבויט מיט ליבשאַפֿט דורך דער משפּחה • <a href=\"/admin.html\" id=\"admin-link\">🛠️ פֿאַרוואַלטונג</a>",
                    "alt-family-logo": "משפּחה לאָגאָ",
                    "alt-family-photo": "משפּחה פאָטאָ",
                    "unavailable-message": "(נישט בנימצא כרגע)"
                },
                "fr": {
                    "title": "Le site familial - Ben Abou, Elharrar et plus",
                    "logout-link": "Déconnexion",
                    "login-link": "Connexion",
                    "welcome-title": "Bienvenue sur le site de la famille",
                    "family-names": "Ben Abou • Elharrar • Malca",
                    "search-title": "🔍 Rechercher sur le site",
                    "search-placeholder": "Tapez un nom ou une description...",
                    "menu-home": "🏠 Page d'accueil",
                    "menu-about": "<span>ℹ️</span> Page d'actualités (Actuellement indisponible)",
                    "menu-tree": "<span>🧬</span> Arbre généalogique",
                    "menu-chat": "<span>🧑‍💻</span> Chat IA",
                    "menu-contact": "<span>📩 </span> Communications familiales",
                    "menu-gallery": "<span>🖼️</span> Galerie de photos",
                    "menu-memorial": "<span>🕯️</span> Mur du souvenir",
                    "menu-timeline": "<span>🗓️</span> Ligne du temps",
                    "menu-calendar": "<span>📆</span> Calendrier",
                    "menu-forum": "<span>👪</span> Forum familial",
                    "menu-biographies": "<span>📖</span> Biographies",
                    "menu-stats": "<span>📊</span> Statistiques",
                    "menu-update": "Mettre à jour les détails",
                    "menu-upload-photo": "Télécharger des photos",
                    "menu-upload-video": "Télécharger une vidéo",
                    "menu-search-ai": "Recherche IA",
                    "menu-migration-map": "Carte de migration",
                    "menu-newsletter": "<span>📰</span> Bulletin d'information",
                    "main-welcome-heading": "🌟 Bienvenue au centre familial",
                    "main-welcome-text": "Ce site web a été construit pour toutes les familles : Ben Abou, Elharrar, Malca, Ben David, Bromberg, Barenbaum, Fass-Schneck, Weinberger, Leibner, van der Velde, Behr, de Vries, Italiaander, Izaks, Chapon, et plus encore – pour partager des photos, des souvenirs, l'arbre généalogique, des messages, et plus encore.",
                    "main-welcome-subtext": "Vous pouvez vous connecter par branche familiale, mettre à jour les détails, discuter avec une IA familiale et découvrir ensemble une histoire documentée.",
                    "tree-welcome-title": "Bienvenue dans notre arbre généalogique",
                    "feature-tree": "🌳 Arbre généalogique interactif",
                    "feature-login": "🔐 Connexion utilisateur et autorisations par branche familiale",
                    "feature-wall": "💬 Mur familial pour les publications et les commentaires",
                    "feature-messages": "📨 Système de messagerie interne",
                    "feature-gallery": "🖼️ Galerie pour les documents et les photos",
                    "feature-memorial": "🕯️ Pages de mémorial avec une bougie numérique",
                    "feature-multilingual": "🌐 Menu multilingue (hébreu/anglais)",
                    "feature-search": "🔍 Recherche intelligente",
                    "feature-newsletter": "📧 Support du bulletin d'information",
                    "feature-ai": "🤖 Chat IA familial avec support des données familiales",
                    "feature-responsive": "📱 Conception réactive pour mobile",
                    "news-updates-heading": "Nouvelles et mises à jour",
                    "news-1": "Nous avons ajouté la possibilité de télécharger des photos sur l'arbre généalogique.",
                    "news-2": "Le système de messagerie interne est maintenant ouvert à tous les utilisateurs.",
                    "news-3": "Vous pouvez maintenant allumer une bougie numérique en mémoire de vos proches.",
                    "footer-text": "&copy; 2025 Le site familial • Construit avec amour par la famille • <a href=\"/admin.html\" id=\"admin-link\">🛠️ Administration</a>",
                    "alt-family-logo": "Logo de la famille",
                    "alt-family-photo": "Photo de la famille",
                    "unavailable-message": "(Actuellement indisponible)"
                }
            };
        
            const langSelector = document.getElementById("langSelector");
            let currentLang = localStorage.getItem("lang") || "he";
            let isLoggedIn = false;
        
            // מפה של ID של אלמנטים למפתח התרגום שלהם. זה הופך את הקוד ליעיל וקל יותר לניהול.
            const textElementsMap = {
                "title": (text) => document.title = text,
                "welcome-title": (text) => document.getElementById("welcome-title").textContent = text,
                "family-names": (text) => document.getElementById("family-names").textContent = text,
                "search-title": (text) => document.getElementById("search-title").textContent = text,
                "search-placeholder": (text) => document.getElementById("search").placeholder = text,
                "main-welcome-heading": (text) => document.getElementById("main-welcome-heading").textContent = text,
                "main-welcome-text": (text) => document.getElementById("main-welcome-text").textContent = text,
                "main-welcome-subtext": (text) => document.getElementById("main-welcome-subtext").textContent = text,
                "tree-welcome-title": (text) => document.getElementById("tree-welcome-title").textContent = text,
                "feature-tree": (text) => document.getElementById("feature-tree").textContent = text,
                "feature-login": (text) => document.getElementById("feature-login").textContent = text,
                "feature-wall": (text) => document.getElementById("feature-wall").textContent = text,
                "feature-messages": (text) => document.getElementById("feature-messages").textContent = text,
                "feature-gallery": (text) => document.getElementById("feature-gallery").textContent = text,
                "feature-memorial": (text) => document.getElementById("feature-memorial").textContent = text,
                "feature-multilingual": (text) => document.getElementById("feature-multilingual").textContent = text,
                "feature-search": (text) => document.getElementById("feature-search").textContent = text,
                "feature-newsletter": (text) => document.getElementById("feature-newsletter").textContent = text,
                "feature-ai": (text) => document.getElementById("feature-ai").textContent = text,
                "feature-responsive": (text) => document.getElementById("feature-responsive").textContent = text,
                "news-updates-heading": (text) => document.getElementById("news-updates-heading").textContent = text,
                "news-1": (text) => document.getElementById("news-1").textContent = text,
                "news-2": (text) => document.getElementById("news-2").textContent = text,
                "news-3": (text) => document.getElementById("news-3").textContent = text,
                "footer-text": (text) => document.getElementById("footer-text").innerHTML = text,
                "alt-family-logo": (text) => document.getElementById("family-logo").setAttribute('alt', text),
                "alt-family-photo": (text) => document.getElementById("family-photo").setAttribute('alt', text)
            };
            
            // מפה של ID של אלמנטים למפתח תרגום שלהם שדורשים innerHTML בגלל תגי span
            const innerHtmlElementsMap = {
                "menu-home": "menu-home",
                "menu-about": "menu-about",
                "menu-tree": "menu-tree",
                "menu-chat": "menu-chat",
                "menu-contact": "menu-contact",
                "menu-gallery": "menu-gallery",
                "menu-memorial": "menu-memorial",
                "menu-timeline": "menu-timeline",
                "menu-calendar": "menu-calendar",
                "menu-forum": "menu-forum",
                "menu-biographies": "menu-biographies", // שימו לב כאן, שם המפתח בתרגומים הוא 'biographies'
                "menu-stats": "menu-stats",
                "menu-update": "menu-update",
                "menu-upload-photo": "menu-upload-photo",
                "menu-upload-video": "menu-upload-video",
                "menu-search-ai": "menu-search-ai",
                "menu-migration-map": "menu-migration-map",
                "menu-newsletter": "menu-newsletter"
            };
        
            // פונקציה לעדכון כל הטקסטים והתכונות בהתאם לשפה
            function setLanguage(lang) {
                const texts = translations[lang];
                if (!texts) return;
        
                // עדכון אלמנטים המשתמשים ב-textContent
                for (const id in textElementsMap) {
                    if (texts[id]) {
                        textElementsMap[id](texts[id]);
                    }
                }
                
                // עדכון אלמנטים המשתמשים ב-innerHTML
                for (const id in innerHtmlElementsMap) {
                    const key = innerHtmlElementsMap[id];
                    if (texts[key]) {
                        document.getElementById(id).innerHTML = texts[key];
                    }
                }
        
                // עדכון כיווניות השפה
                const isRtl = lang === "he" || lang === "yi";
                document.documentElement.setAttribute("dir", isRtl ? "rtl" : "ltr");
                document.documentElement.lang = lang;
                
                // עדכון טקסט קישור הכניסה/התנתקות
                const loginLogoutLink = document.getElementById("login-logout-link");
                if (loginLogoutLink) {
                    loginLogoutLink.textContent = texts[isLoggedIn ? "logout-link" : "login-link"];
                    loginLogoutLink.href = isLoggedIn ? "/logout" : "/login.html";
                }
            }
            
            const menuBar = document.getElementById("menu-bar");
            const userProfile = document.getElementById("user-profile");
            
            // סימולציה של קריאה לשרת כדי לבדוק סטטוס התחברות
            // נניח ש- /api/user מחזיר `{ username: "שם", role: "תפקיד" }` אם מחובר, או שגיאה אם לא
            fetch("/api/user")
                .then(res => {
                    if (res.ok) {
                        return res.json();
                    } else {
                        // אם התשובה לא תקינה, אנחנו יודעים שהמשתמש לא מחובר
                        return Promise.reject("User not logged in");
                    }
                })
                .then(user => {
                    isLoggedIn = user && user.username;
                    const currentTexts = translations[currentLang];
                    
                    if (isLoggedIn) {
                        userProfile.innerHTML = `
                            <span class="font-bold">${user.username}</span>
                            <span class="text-gray-300">(${user.role})</span>
                            <a href="/logout" id="login-logout-link" class="text-white hover:underline transition mr-2">${currentTexts["logout-link"]}</a>
                        `;
                    } else {
                        userProfile.innerHTML = `
                            <a href="/login.html" id="login-logout-link" class="text-white hover:underline transition mr-2">${currentTexts["login-link"]}</a>
                        `;
                    }
                    // הצגה או הסתרת התפריט בהתאם לסטטוס ההתחברות
                    menuBar.style.display = isLoggedIn ? "flex" : "none";
                    // עדכון התוכן בהתאם לשפה הנוכחית לאחר קביעת סטטוס ההתחברות
                    setLanguage(currentLang);
                })
                .catch(error => {
                    console.error("Error fetching user data:", error);
                    isLoggedIn = false;
                    const currentTexts = translations[currentLang];
                    userProfile.innerHTML = `
                        <a href="/login.html" id="login-logout-link" class="text-white hover:underline transition mr-2">${currentTexts["login-link"]}</a>
                    `;
                    menuBar.style.display = "none";
                    setLanguage(currentLang);
                });
        
            // הוספת האזנה לאירוע שינוי שפה
            langSelector.addEventListener("change", (event) => {
                const newLang = event.target.value;
                localStorage.setItem("lang", newLang);
                setLanguage(newLang);
            });
        });
    </script>
      </body>
</html>

