<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="docTitle">×¢×œ×•×Ÿ ×”××©×¤×—×”</title>
    <!-- Load Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Heebo font from Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Heebo', sans-serif;
            background-color: #f3f4f6;
        }
        .ai-result {
            white-space: pre-wrap; /* Maintains line breaks from the API */
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="min-h-screen flex flex-col items-center py-12 px-4 sm:px-6 lg:px-8">
        <!-- Main Newsletter Header -->
        <header class="text-center mb-10 w-full max-w-4xl relative">
            <div class="bg-white rounded-3xl shadow-xl p-6 relative">
                <!-- Language Selector (Dropdown) -->
                <div class="absolute top-4 left-4 p-1 bg-indigo-600 rounded-full shadow-lg text-sm font-semibold transition-transform duration-200 hover:scale-105">
                    <select id="lang-select" onchange="changeLanguage(this.value)" class="bg-transparent text-white p-2 rounded-full cursor-pointer appearance-none outline-none focus:ring-2 focus:ring-indigo-300">
                        <option value="he">×¢×‘×¨×™×ª (Hebrew)</option>
                        <option value="en">English</option>
                        <option value="yi">×™×™×“×™×© (Yiddish)</option>
                        <option value="fr">FranÃ§ais (French)</option>
                        <option value="nl">Nederlands (Dutch)</option>
                    </select>
                </div>
                
                <h1 id="mainTitle" class="text-5xl font-extrabold text-gray-900 mb-2">×˜×•×¢×Ÿ...</h1>
                <p id="mainSubtitle" class="text-lg text-gray-500">××”×“×•×¨×” ×—×•×“×©×™×ª</p>
            </div>
        </header>

        <main class="w-full max-w-4xl space-y-10">
            <!-- Main Section: Important Update -->
            <section class="bg-white rounded-3xl shadow-2xl overflow-hidden">
                <div class="p-8">
                    <h2 id="websiteTitle" class="text-3xl font-bold text-indigo-700 mb-4 flex items-center">
                        <span class="mr-2">ğŸ‰</span>
                    </h2>
                    <p id="websiteText" class="text-gray-700 leading-relaxed text-lg">
                        <!-- Content will be inserted here -->
                    </p>
                </div>
            </section>

            <!-- Holiday Section (Dynamic based on date) -->
            <section id="holidaySection" class="bg-indigo-600 rounded-3xl shadow-2xl p-8 text-center text-white transition-all duration-500" style="display: none;">
                <h2 id="holidayTitle" class="text-4xl font-extrabold mb-4 flex items-center justify-center"></h2>
                <p id="holidayText" class="text-xl leading-relaxed font-light"></p>
            </section>
            
            <!-- --- GEMINI AI Feature Section --- -->
            <section class="bg-gray-200 rounded-3xl shadow-2xl p-8 border-4 border-fuchsia-400">
                <h2 id="aiTitle" class="text-3xl font-bold text-fuchsia-700 mb-4 flex items-center border-r-4 border-fuchsia-700 pr-3">
                    <span class="ml-2">âœ¨</span>
                </h2>
                <p id="aiDescription" class="text-gray-700 mb-6 text-lg"></p>

                <button id="generateIdeaBtn" class="w-full px-6 py-3 text-lg font-bold text-white bg-fuchsia-500 rounded-xl shadow-lg hover:bg-fuchsia-600 transition-all duration-300 transform hover:scale-[1.02]">
                    <span id="generateIdeaText">×˜×•×¢×Ÿ...</span>
                </button>
                
                <div id="aiResultContainer" class="mt-6 p-4 bg-white rounded-xl shadow-inner border border-fuchsia-200 hidden">
                    <p id="aiResult" class="ai-result text-gray-800 text-lg mb-2"></p>
                    <div id="aiSources" class="text-xs text-gray-500 mt-3 border-t border-gray-100 pt-2"></div>
                </div>
            </section>
            <!-- --------------------------------- -->

            <!-- In Loving Memory Section -->
            <section class="bg-gray-800 rounded-3xl shadow-2xl overflow-hidden text-center p-8 text-white">
                <h2 id="inMemoryTitle" class="text-3xl font-bold mb-4 flex items-center justify-center border-b border-gray-700 pb-3">
                    <span class="ml-2">ğŸ•¯ï¸</span>
                </h2>
                <p id="inMemoryText1" class="text-gray-300"></p>
                <p id="inMemoryName" class="mt-2 text-2xl font-extrabold text-gray-100"></p>
                <p id="inMemoryDate" class="text-sm text-gray-400"></p>
                <p id="inMemoryText2" class="text-gray-400 mt-4"></p>
            </section>

            <!-- Good News Section -->
            <section class="bg-white rounded-3xl shadow-2xl p-8">
                <h2 id="goodNewsTitle" class="text-3xl font-bold text-teal-600 mb-4 flex items-center border-r-4 border-teal-600 pr-3">
                    <span class="ml-2">ğŸŒŸ</span>
                </h2>
                <p id="goodNewsText" class="text-gray-700 leading-relaxed text-lg">
                </p>
            </section>

            <!-- Recommendations Section -->
            <section class="bg-white rounded-3xl shadow-2xl p-8">
                <h2 id="recommendationsTitle" class="text-3xl font-bold text-orange-600 mb-6 flex items-center border-r-4 border-orange-600 pr-3">
                    <span class="ml-2">ğŸ’¡</span>
                </h2>
                <div class="space-y-4 text-lg">
                    <div id="recommendation1" class="p-3 bg-yellow-50 rounded-lg border border-yellow-200"></div>
                    <div id="recommendation2" class="p-3 bg-yellow-50 rounded-lg border border-yellow-200"></div>
                    <div id="recommendation3" class="p-3 bg-yellow-50 rounded-lg border border-yellow-200"></div>
                </div>
            </section>

            <!-- Family Photos Section -->
            <section class="bg-white rounded-3xl shadow-2xl p-8">
                <h2 id="photosTitle" class="text-3xl font-bold text-pink-600 mb-4 flex items-center border-r-4 border-pink-600 pr-3">
                    <span class="ml-2">ğŸ“¸</span>
                </h2>
                <p id="photosText" class="text-gray-700 mb-6 text-lg"></p>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                    <img src="https://placehold.co/300x300/e9d5ff/8b5cf6?text=×ª××•× ×”+1" alt="Family Photo" class="w-full h-auto rounded-xl shadow-md object-cover aspect-square">
                    <img src="https://placehold.co/300x300/fecaca/ef4444?text=×ª××•× ×”+2" alt="Family Photo" class="w-full h-auto rounded-xl shadow-md object-cover aspect-square">
                    <img src="https://placehold.co/300x300/dbeafe/3b82f6?text=×ª××•× ×”+3" alt="Family Photo" class="w-full h-auto rounded-xl shadow-md object-cover aspect-square">
                    <img src="https://placehold.co/300x300/dcfce7/22c55e?text=×ª××•× ×”+4" alt="Family Photo" class="w-full h-auto rounded-xl shadow-md object-cover aspect-square">
                </div>
            </section>

            <!-- Birthdays and Events Section -->
            <section class="bg-white rounded-3xl shadow-2xl p-8">
                <h2 id="eventsTitle" class="text-3xl font-bold text-purple-600 mb-4 flex items-center border-r-4 border-purple-600 pr-3">
                    <span class="ml-2">ğŸ‚</span>
                </h2>
                <ul id="eventsList" class="space-y-3 text-gray-700 text-lg">
                    <!-- Content loaded from static data -->
                </ul>
            </section>
            
            <!-- Contact Section -->
            <section class="bg-white rounded-3xl shadow-2xl p-8 text-center border-t border-gray-100">
                <h2 id="contactTitle" class="text-3xl font-bold text-gray-900 mb-4 flex items-center justify-center">
                    <span class="ml-2">âœï¸</span>
                </h2>
                <p id="contactText" class="text-gray-700 leading-relaxed text-lg">
                </p>
            </section>

            <!-- Footer Section -->
            <footer class="text-center mt-10 text-gray-500">
                <p id="footerText1" class="text-base"></p>
                <p id="footerText2" class="mt-2 text-sm"></p>
            </footer>
        </main>
    </div>

    <!-- Modal for Messages/Errors (replaces alert) -->
    <div id="modalOverlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 transition-opacity duration-300 items-center justify-center p-4 opacity-0">
        <div id="messageModal" class="bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 transform transition-all duration-300 scale-95" style="display: none;">
            <h3 id="messageTitle" class="text-xl font-bold text-gray-900 mb-4"></h3>
            <p id="messageContent" class="text-gray-700 mb-6"></p>
            <button onclick="hideModal('messageModal')" class="w-full bg-indigo-600 text-white font-semibold py-2 rounded-lg hover:bg-indigo-700 transition duration-150">Close</button>
        </div>
    </div>

    <script>
        // --- Gemini API Configuration ---
        const API_KEY = ""; // ××©×ª× ×” ×’×œ×•×‘×œ×™
        const API_MODEL = "gemini-2.5-flash-preview-09-2025";
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${API_MODEL}:generateContent?key=${API_KEY}`;
        const MAX_RETRIES = 5;

        // ----------------------------------------------------
        // Static Data and Language Control (Updated for 5 Languages)
        // ----------------------------------------------------
        
        const defaultContent = {
            'he': {
                'docTitle': '×¢×œ×•×Ÿ ×”××©×¤×—×”',
                'mainTitle': '×¢×œ×•×Ÿ ×”××©×¤×—×”',
                'mainSubtitle': '××”×“×•×¨×” ×—×•×“×©×™×ª - × ×•×‘××‘×¨ 2025',
                'websiteTitle': 'ğŸ‰ ×¤×ª×—× ×• ××ª×¨ ××©×¤×—×ª×™ ×—×“×©!',
                'websiteText': '×× ×—× ×• × ×¨×’×©×™× ×œ×”×›×¨×™×– ×©×”××ª×¨ ×”××©×¤×—×ª×™ ×”×—×“×© ×©×œ× ×• ×›×‘×¨ ×‘××•×•×™×¨! ×”××ª×¨ ×”×•× ××¨×›×– ××—×“ ×œ×›×œ ×”×“×‘×¨×™× ×”××©×¤×—×ª×™×™×: ×’×œ×¨×™×™×ª ×ª××•× ×•×ª, ×œ×•×— ××™×¨×•×¢×™×, ×•×¢×“×›×•× ×™× ×©×•×˜×¤×™×. ×”×™×›× ×¡×• ×œ×‘×§×¨, ×œ×”×ª×¢×“×›×Ÿ ×•×œ×©×ª×£.',
                
                'aiTitle': 'âœ¨ ×¤×™× ×ª ×”×¨×¢×™×•× ×•×ª ×”××©×¤×—×ª×™×™×',
                'aiDescription': '×œ×—×¦×• ×¢×œ ×”×›×¤×ª×•×¨ ×›×“×™ ×œ×§×‘×œ ×¨×¢×™×•×Ÿ ×œ×¤×¢×™×œ×•×ª ××©×¤×—×ª×™×ª ××•××œ×¦×ª, ×›×™×¤×™×ª ×•×¢×“×›× ×™×ª ×œ×¡×•×£ ×”×©×‘×•×¢ ×”×§×¨×•×‘! ×”×¨×¢×™×•×Ÿ × ×•×¦×¨ ×‘×××¦×¢×•×ª ×‘×™× ×” ××œ××›×•×ª×™×ª (Gemini) ×•×›×•×œ×œ ××™×“×¢ ×¨×œ×•×•× ×˜×™ ××”×¨×©×ª.',
                'generateIdeaText': 'âœ¨ ×”×¦×™×¢×• ×œ×™ ×¨×¢×™×•×Ÿ ××©×¤×—×ª×™!',
                'aiLoadingText': '×˜×•×¢×Ÿ ×¨×¢×™×•×Ÿ ×™×¦×™×¨×ª×™...',
                'aiSourcesTitle': '××§×•×¨×•×ª ××™×“×¢ (×—×™×¤×•×© ×’×•×’×œ):',
                
                'inMemoryTitle': 'ğŸ•¯ï¸ ×œ×–×›×¨ ×™×§×™×¨× ×•',
                'inMemoryText1': '×× ×• ×–×•×›×¨×™× ××ª ×›×œ ××œ×” ×©×›×‘×¨ ××™× × ××™×ª× ×•, ×•××•×§×™×¨×™× ××ª ×”×–×™×›×¨×•× ×•×ª ×©×”×©××™×¨×•.',
                'inMemoryName': '×‘××”×‘×”, ×¤×¨× ×§ ×•×Ÿ ×“×¨ ×•×œ×“×” ×–"×œ',
                'inMemoryDate': '× ×¤×˜×¨ ×‘-6 ×‘×™×•×œ×™ 2025, ×‘×§×™×™×¤×˜××•×Ÿ.',
                'inMemoryText2': '×™×”×™ ×–×›×¨×• ×‘×¨×•×š.',
                'goodNewsTitle': 'ğŸŒŸ ×—×“×©×•×ª ×˜×•×‘×•×ª!',
                'goodNewsText': '×¢×“×›×•× ×™× ×˜×•×‘×™× ×™×’×™×¢×• ×‘×§×¨×•×‘! ××—×›×™× ×œ×©××•×¢ ××ª ×”×—×“×©×•×ª ×©×œ×›×.',
                'recommendationsTitle': 'ğŸ’¡ ×¤×™× ×ª ×”×”××œ×¦×•×ª',
                'recommendation1': '<strong class="font-semibold text-gray-900">×¡×¤×¨:</strong> <span class="text-gray-700">×¡×“×¨×ª ×”××¨×™ ×¤×•×˜×¨ - ×¡×“×¨×ª ×”×¡×¤×¨×™× ×”××”×•×‘×” ×¢×œ ×›×œ ×”××©×¤×—×”. ×§×¡× ×•×“××™×•×Ÿ ×‘×›×œ ×¢××•×“!</span>',
                'recommendation2': '<strong class="font-semibold text-gray-900">×¡×¨×˜:</strong> <span class="text-gray-700">×”×§×•×œ ×‘×¨××© (Inside Out) - ×¡×¨×˜ ×× ×™××¦×™×” ×©×œ ×“×™×¡× ×™/×¤×™×§×¡××¨ ×©××¨×’×© ×•××¦×—×™×§ ×’× ×™×œ×“×™× ×•×’× ××‘×•×’×¨×™×.</span>',
                'recommendation3': '<strong class="font-semibold text-gray-900">××§×•× ×œ×‘×§×¨ ×‘×•:</strong> <span class="text-gray-700">×’×Ÿ ×”×—×™×•×ª ×”×ª× "×›×™ ×‘×™×¨×•×©×œ×™× - ×—×•×•×™×” ×œ×™××•×“×™×ª ×•×›×™×¤×™×ª ×œ×›×œ ×”×’×™×œ××™×.</span>',
                'photosTitle': 'ğŸ“¸ ×¨×’×¢×™ ×”×§×™×¥ ×©×œ× ×•',
                'photosText': '×›××” ×ª××•× ×•×ª ×©×¦×•×œ××• ×œ××—×¨×•× ×”, ×›×“×™ ×œ×”×–×›×™×¨ ×œ×›×•×œ× ×• ××ª ×”×¨×’×¢×™× ×”×™×¤×™× ×©×× ×• ×—×•×œ×§×™× ×™×—×“.',
                'eventsTitle': 'ğŸ‚ ×™××™ ×”×•×œ×“×ª ×•××™×¨×•×¢×™× ×§×¨×•×‘×™×',
                'eventsList': `
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">15 ×‘× ×•×‘××‘×¨:</strong> ×™×•× ×”×•×œ×“×ª 12 ×œ×”×œ×œ ×›×¡×¤×™!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">15 ×‘× ×•×‘××‘×¨:</strong> ×™×•× ×”×•×œ×“×ª 21 ×œ×× ×œ×™×– ×’'×™×Ÿ ×’'×•× ×¡×•×Ÿ!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ’</span><strong class="font-semibold ml-2">15 ×‘× ×•×‘××‘×¨:</strong> ×™×•× × ×™×©×•××™×Ÿ 38 ×œ××œ×Ÿ ×•×‘×× ×™ ××¨×œ×™×Ÿ ×¤×™×©×¨!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">19 ×‘× ×•×‘××‘×¨:</strong> ×™×•× ×”×•×œ×“×ª 85 ×œ×× ×™×˜×” ×‘×¡×§×™×Ÿ!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">20 ×‘× ×•×‘××‘×¨:</strong> ×™×•× ×”×•×œ×“×ª 39 ×œ×œ×•×¨×” ×‘×¨×•×§×•×•×™×™ ×¤×¨×’×•×¡×•×Ÿ!</li>
                `,
                'contactTitle': 'âœï¸ ×¨×•×¦×™× ×œ×©×ª×£?',
                'contactText': '×™×© ×œ×›× ×—×“×©×•×ª ××¨×’×©×•×ª, ×”××œ×¦×•×ª ××• ×ª××•× ×•×ª ××”×˜×™×•×œ ×”××©×¤×—×ª×™? ×¤×©×•×˜ ×©×œ×—×• ×œ× ×• ××ª ×”×¢×“×›×•× ×™× ×©×œ×›× ×œ××™×™×œ: <strong>familysite@gmx.com</strong>.',
                'footerText1': '×ª×•×“×” ×©×§×¨××ª×! × ×ª×¨××” ×‘××”×“×•×¨×” ×”×‘××”.',
                'footerText2': '&copy; 2025 ×¢×œ×•×Ÿ ×”××©×¤×—×”. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.',
                'modalTitleSuccess': '×¨×¢×™×•×Ÿ ×—×“×©!',
                'modalTitleError': '×©×’×™××”',
                'modalContentError': '××™×¨×¢×” ×©×’×™××” ×‘×˜×¢×™× ×ª ×”×¨×¢×™×•×Ÿ ×”××©×¤×—×ª×™. ×× × × ×¡×” ×©×•×‘ ×××•×—×¨ ×™×•×ª×¨.'
            },
            'en': {
                'docTitle': 'The Family Newsletter',
                'mainTitle': 'The Family Newsletter',
                'mainSubtitle': 'Monthly Edition - November 2025',
                'websiteTitle': 'ğŸ‰ New Family Website is Live!',
                'websiteText': 'We are excited to announce that our new family website is now live! The site is a central hub for all things family: a photo gallery, an events calendar, and regular updates. Come visit, get updated, and share!',
                
                'aiTitle': 'âœ¨ Family Idea Corner',
                'aiDescription': 'Click the button to get a fun, recommended, and current family activity idea for the upcoming weekend! The idea is generated using Artificial Intelligence (Gemini) and includes relevant information from the web.',
                'generateIdeaText': 'âœ¨ Suggest a Family Idea!',
                'aiLoadingText': 'Loading creative idea...',
                'aiSourcesTitle': 'Information Sources (Google Search):',
                
                'inMemoryTitle': 'ğŸ•¯ï¸ In Loving Memory',
                'inMemoryText1': 'We remember all those who are no longer with us, and cherish the memories they left behind.',
                'inMemoryName': 'In loving memory of Frank van der Velde z"l',
                'inMemoryDate': 'Died in Cape Town on July 6, 2025.',
                'inMemoryText2': 'May his memory be a blessing.',
                'goodNewsTitle': 'ğŸŒŸ Good News!',
                'goodNewsText': 'Good news coming soon! We are waiting to hear your updates.',
                'recommendationsTitle': 'ğŸ’¡ Recommendations Corner',
                'recommendation1': '<strong class="font-semibold text-gray-900">Book:</strong> <span class="text-gray-700">The Harry Potter series - The beloved book series for the whole family. Magic and imagination on every page!</span>',
                'recommendation2': '<strong class="font-semibold text-gray-900">Movie:</strong> <span class="text-gray-700">Inside Out - A Disney/Pixar animated film that is both touching and funny for kids and adults alike.</span>',
                'recommendation3': '<strong class="font-semibold text-gray-900">Place to Visit:</strong> <span class="text-gray-700">The Biblical Zoo in Jerusalem - A fun and educational experience for all ages.</span>',
                'photosTitle': 'ğŸ“¸ Our Summer Moments',
                'photosText': 'A few recent photos, to remind us all of the beautiful moments we share together.',
                'eventsTitle': 'ğŸ‚ Upcoming Birthdays & Events',
                'eventsList': `
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">November 15:</strong> 12th birthday of Halel Caspi!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">November 15:</strong> 21st birthday of Analise Jean Johnson!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ’</span><strong class="font-semibold mr-2">November 15:</strong> 38th wedding anniversary of Alan and Bunny Marlene Fisher!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">November 19:</strong> 85th birthday of Anita Baskin!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">November 20:</strong> 39th birthday of Laura Brockway Ferguson!</li>
                `,
                'contactTitle': 'âœï¸ Want to Share?',
                'contactText': 'Have exciting news, recommendations, or photos from a family trip? Simply send us your updates to this email: <strong>familysite@gmx.com</strong>.',
                'footerText1': 'Thanks for reading! See you in the next edition.',
                'footerText2': '&copy; 2025 The Family Newsletter. All rights reserved.',
                'modalTitleSuccess': 'New Idea!',
                'modalTitleError': 'Error',
                'modalContentError': 'An error occurred while loading the family idea. Please try again later.'
            },
            'yi': {
                'docTitle': '×“×¢×¨ ×¤×Ö·××™×œ×™×¢ × ×™×™×¢×¡×œ×™×™×˜×¢×¨',
                'mainTitle': '×“×¢×¨ ×¤×Ö·××™×œ×™×¢ × ×™×™×¢×¡×œ×™×™×˜×¢×¨',
                'mainSubtitle': '××Ö¸× ×Ö·×˜×œ×™×›×¢ ××•×™×¡×’×Ö·×‘×¢ - × ×Ö¸×•×•×¢××‘×¢×¨ 2025',
                'websiteTitle': 'ğŸ‰ ××™×¨ ×”×Ö¸×‘×Ÿ ×’×¢×¢×¤Ö¿× ×˜ ×Ö· × ×²Ö·×¢× ×¤×Ö·××™×œ×™×¢ ×•×•×¢×‘×–×™×™×˜×œ!',
                'websiteText': '××™×¨ ×–×¢× ×¢×Ÿ ×‘×Ö·×’×™×™×¡×˜×¢×¨×˜ ×¦×• ××¢×œ×“×Ÿ ×Ö·×– ××•× ×“×–×¢×¨ × ×²Ö·×¢×¨ ×¤×Ö·××™×œ×™×¢ ×•×•×¢×‘×–×™×™×˜×œ ××™×– ×©×•×™×Ÿ ××±×£! ×“×¢×¨ ×–×²Ö·×˜×œ ××™×– ×Ö· ×¦×¢× ×˜×¨×Ö·×œ×¢×¨ ×¤Ö¼×•× ×§×˜ ×¤Ö¿×Ö·×¨ ×Ö·×œ×¢ ×–×Ö·×›×Ÿ ×¤Ö¿×•×Ÿ ×“×¢×¨ ×¤×Ö·××™×œ×™×¢: ×Ö· ×‘×™×œ×“×¢×¨ ×’×Ö·×œ×¢×¨×™×¢, ×Ö·×Ÿ ×Ö¸×•×•×¢× ×˜ ×§×Ö·×œ×¢× ×“×Ö·×¨, ××•×Ÿ ×©×˜×¢× ×“×™×’×¢ ×“×¢×¨×”×™×™Ö·× ×˜×™×§×•× ×’×¢×Ÿ. ×§×•××˜ ×‘×Ö·×–×•×›×Ÿ, ×–×™×š ××™×‘×¢×¨×¦×™×™×’×Ÿ, ××•×Ÿ ×˜×™×™×œ×Ÿ!',
                
                'aiTitle': 'âœ¨ ×¤×Ö·××™×œ×™×¢ ×’×¢×“×Ö·× ×§ ×•×•×™× ×§×œ',
                'aiDescription': '×“×¨×™×§×˜ ××•×™×¤×Ÿ ×§× ×¢×¤Ö¼×œ ×¦×• ×§×¨×™×’×Ÿ ×Ö· ×œ×•×¡×˜×™×§×¢, ×¨×¢×§×Ö¸××¢× ×“×™×¨×˜×¢, ××•×Ÿ ×Ö·×§×˜×™×¢×œ×¢ ×¤×Ö·××™×œ×™×¢ ×˜×¢×˜×™×§×™×™×˜ ××™×“×¢×¢ ×¤Ö¿×Ö·×¨ ×“×¢× ×§×•××¢× ×“×™×§×Ÿ ×¡×•×£-×•×•×Ö¸×š! ×“×™ ××™×“×¢×¢ ×•×•×¢×¨×˜ ×’×¢×©×Ö·×¤Ö¿×Ÿ ××™×˜ ×§×™× ×¡×˜×œ×™×›×¢ ××™× ×˜×¢×œ×™×’×¢× ×¥ (Gemini) ××•×Ÿ ×©×œ×™×¡×˜ ××²Ö·×Ÿ ×¨×¢×œ×¢×•×•×Ö·× ×˜×¢ ××™× ×¤Ö¿×Ö¸×¨××Ö·×¦×™×¢ ×¤Ö¿×•× ×¢× × ×¢×¥.',
                'generateIdeaText': 'âœ¨ ×¤×Ö¸×¨×©×œ×Ö¸×’ ××™×¨ ×Ö· ×¤×Ö·××™×œ×™×¢ ×’×¢×“×Ö·× ×§!',
                'aiLoadingText': '×œ×™×™×“×˜ ×Ö· ×©×¢×¤×¢×¨×™×©×Ÿ ×’×¢×“×Ö·× ×§...',
                'aiSourcesTitle': '××™× ×¤Ö¿×Ö¸×¨××Ö·×¦×™×¢ ×§×•×•×¢×œ×¢×¨ (×’×•×’×œ ×–×•×š):',
                
                'inMemoryTitle': 'ğŸ•¯ï¸ ×¦×• ×“×¢× ×–×›×¨ ×¤Ö¿×•×Ÿ ××•× ×“×–×¢×¨×¢ ×œ×™×‘×¡×˜×¢',
                'inMemoryText1': '××™×¨ ×’×¢×“×¢× ×§×¢×Ÿ ×Ö·×œ×¢ ×™×¢× ×¢ ×•×•×Ö¸×¡ ×–×¢× ×¢×Ÿ ××¢×¨ × ×™×˜ ××™×˜ ××•× ×“×–, ××•×Ÿ ×©×¢×¦×Ÿ ×“×™ ×–×›×¨×•× ×•×ª ×•×•×Ö¸×¡ ×–×™×™ ×”×Ö¸×‘×Ÿ ××™×‘×¢×¨×’×¢×œ×Ö¸×–×˜.',
                'inMemoryName': '××™×˜ ×œ×™×‘×©×Ö·×¤Ö¿×˜, ×¤×¨×Ö·× ×§ ×•×•×Ö·×Ÿ ×“×¢×¨ ×•×•×¢×œ×“×¢ ×–"×œ',
                'inMemoryDate': '×’×¢×©×˜×Ö¸×¨×‘×Ÿ ××™×Ÿ ×§×Ö·×¤Ö¼×©×˜×Ö·×“ ×“×¢× 6×˜×Ÿ ×™×•×œ×™ 2025.',
                'inMemoryText2': '×–×Ö¸×œ ×–×™×™×Ÿ ×–×›×¨×•× ×• ×œ×‘×¨×›×”.',
                'goodNewsTitle': 'ğŸŒŸ ×’×•×˜×¢ × ×²Ö·×¢×¡!',
                'goodNewsText': '×’×•×˜×¢ × ×²Ö·×¢×¡ ×§×•××˜ ×‘×Ö·×œ×“! ××™×¨ ×•×•×Ö·×¨×˜×Ÿ ×¦×• ×”×¢×¨×Ÿ ××™×™×¢×¨×¢ ×“×¢×¨×”×™×™Ö·× ×˜×™×§×•× ×’×¢×Ÿ.',
                'recommendationsTitle': 'ğŸ’¡ ×¨×¢×§×Ö¸××¢× ×“×Ö·×¦×™×¢ ×•×•×™× ×§×œ',
                'recommendation1': '<strong class="font-semibold text-gray-900">×‘×•×š:</strong> <span class="text-gray-700">×“×™ ×”×Ö·×¨×™ ×¤Ö¼×Ö¸×˜×¢×¨ ×¡×¢×¨×™×¢ - ×“×™ ×‘×Ö·×œ×™×‘×˜×¢ ×‘×•×š ×¡×¢×¨×™×¢ ×¤Ö¿×Ö·×¨ ×“×¢×¨ ×’×Ö·× ×¦×¢×¨ ×¤×Ö·××™×œ×™×¢. ×›×™×©×•×£ ××•×Ÿ ×¤×Ö·× ×˜×Ö·×–×™×¢ ××•×™×£ ×™×¢×“×¢×¨ ×‘×œ×Ö·×˜!</span>',
                'recommendation2': '<strong class="font-semibold text-gray-900">×¤×™×œ×:</strong> <span class="text-gray-700">××™× ×¡×²Ö·×“ ××±×˜ (Inside Out) - ×Ö·×Ÿ ×Ö·× ×™××Ö·×¦×™×¢ ×¤Ö¿×™×œ× ×¤Ö¿×•×Ÿ ×“×™×¡× ×™/×¤Ö¼×™×§×¡×Ö·×¨ ×•×•×Ö¸×¡ ××™×– ×¡×²Ö· ×¨×™×¨× ×“×™×§ ××•×Ÿ ×¡×²Ö· ×”×•××Ö¸×¨×™×¡×˜×™×© ×¤Ö¿×Ö·×¨ ×§×™× ×“×¢×¨ ××•×Ÿ ×¢×¨×•×•×Ö·×§×¡×¢× ×¢ ×’×œ×²Ö·×š.</span>',
                'recommendation3': '<strong class="font-semibold text-gray-900">×Ö¸×¨×˜ ×¦×• ×‘×Ö·×–×•×›×Ÿ:</strong> <span class="text-gray-700">×“×¢×¨ ×ªÖ¼× "×›×™×©×¢×¨ ×–×Ö¸×Ö¸ ××™×Ÿ ×™×¨×•×©×œ×™× - ×Ö· ×œ×¢×¨× ×¢×“×™×§×¢ ××•×Ÿ ×œ×•×¡×˜×™×§×¢ ×“×¢×¨×¤×Ö·×¨×•× ×’ ×¤Ö¿×Ö·×¨ ×Ö·×œ×¢ ×¢×œ×˜×¢×¨×Ÿ.</span>',
                'photosTitle': 'ğŸ“¸ ××•× ×“×–×¢×¨×¢ ×–×•××¢×¨ ××Ö¸××¢× ×˜×Ÿ',
                'photosText': '×¢×˜×œ×¢×›×¢ ×œ×¢×¦×˜×™×§×¢ ×‘×™×œ×“×¢×¨, ×¦×• ×“×¢×¨××Ö¸× ×¢×Ÿ ××•× ×“×– ×Ö·×œ×¢ ×¤Ö¿×•×Ÿ ×“×™ ×©×™×™× ×¢ ××Ö¸××¢× ×˜×Ÿ ×•×•×Ö¸×¡ ××™×¨ ×˜×™×™×œ×Ÿ ×¦×•×–×Ö·××¢×Ÿ.',
                'eventsTitle': 'ğŸ‚ ×§×•××¢× ×“×™×§×¢ ×’×¢×‘×•×¨×˜×¡-×˜×¢×’ ××•×Ÿ ×’×¢×©×¢×¢× ×™×©×Ÿ',
                'eventsList': `
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">× ×Ö¸×•×•×¢××‘×¢×¨ 15:</strong> 12×˜×¢×¨ ×’×¢×‘×•×¨×˜×¡×˜×Ö¸×’ ×¤Ö¿×•×Ÿ ×”×œ×œ ×›×¡×¤×™!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">× ×Ö¸×•×•×¢××‘×¢×¨ 15:</strong> 21×˜×¢×¨ ×’×¢×‘×•×¨×˜×¡×˜×Ö¸×’ ×¤Ö¿×•×Ÿ ×Ö·× ×Ö·×œ×™×– ×“×–×©×™×Ÿ ×“×–×©×Ö¸× ×¡×Ö¸×Ÿ!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ’</span><strong class="font-semibold ml-2">× ×Ö¸×•×•×¢××‘×¢×¨ 15:</strong> 38×˜×¢×¨ ×—×ª×•× ×” ×™×Ö¸×¨×˜×Ö¸×’ ×¤Ö¿×•×Ÿ ×Ö·×œ×Ö·×Ÿ ××•×Ÿ ×‘×Ö·× ×™ ××Ö·×¨×œ×™×Ÿ ×¤Ö¿×™×©×¢×¨!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">× ×Ö¸×•×•×¢××‘×¢×¨ 19:</strong> 85×˜×¢×¨ ×’×¢×‘×•×¨×˜×¡×˜×Ö¸×’ ×¤Ö¿×•×Ÿ ×Ö·× ×™×˜×Ö· ×‘×Ö·×¡×§×™×Ÿ!</li>
                    <li class="flex items-center"><span class="ml-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold ml-2">× ×Ö¸×•×•×¢××‘×¢×¨ 20:</strong> 39×˜×¢×¨ ×’×¢×‘×•×¨×˜×¡×˜×Ö¸×’ ×¤Ö¿×•×Ÿ ×œ×Ö·×•×¨×Ö· ×‘×¨×Ö¸×§×•×•×™×™ ×¤Ö¿×¢×¨×’×•×¡×Ö¸×Ÿ!</li>
                `,
                'contactTitle': 'âœï¸ ×•×•×™×œ×˜ ××™×¨ ×–×™×š ×˜×™×™×œ×Ÿ?',
                'contactText': '×”×Ö¸×˜ ××™×¨ ×©×¤Ö¼×Ö·× ×¢× ×“×¢ × ×²Ö·×¢×¡, ×¨×¢×§×Ö¸××¢× ×“×Ö·×¦×™×¢×¡ ×Ö¸×“×¢×¨ ×‘×™×œ×“×¢×¨ ×¤Ö¿×•×Ÿ ×Ö· ×¤×Ö·××™×œ×™×¢ ×¨×²Ö·×–×¢? ×©×™×§×˜ ××•× ×“×– ××™×™×¢×¨×¢ ×“×¢×¨×”×™×™Ö·× ×˜×™×§×•× ×’×¢×Ÿ ×¦×• ×“×¢× ××™××¢×™×œ: <strong>familysite@gmx.com</strong>.',
                'footerText1': '×Ö· ×“×Ö·× ×§ ×¤Ö¿×Ö·×¨×Ÿ ×œ×™×™×¢× ×¢×Ÿ! ×–×¢×˜ ×–×™×š ××™×Ÿ ×“×¢×¨ × ×¢×§×¡×˜×¢×¨ ××•×™×¡×’×Ö·×‘×¢.',
                'footerText2': '&copy; 2025 ×“×¢×¨ ×¤×Ö·××™×œ×™×¢ × ×™×™×¢×¡×œ×™×™×˜×¢×¨. ×Ö·×œ×¢ ×¨×¢×›×˜×Ÿ ×¨×¢×–×¢×¨×•×•×™×¨×˜.',
                'modalTitleSuccess': '× ×™×™Ö·×¢×¨ ×’×¢×“×Ö·× ×§!',
                'modalTitleError': '×˜×¢×•×ª',
                'modalContentError': '×¢×¡ ××™×– ×’×¢×©×¢×Ÿ ×Ö· ×˜×¢×•×ª ×‘×©×¢×ª×Ÿ ×œ×™×™×“×Ÿ ×“×¢× ×¤×Ö·××™×œ×™×¢ ×’×¢×“×Ö·× ×§. ×¤Ö¼×¨×•Ö¼×•×•×˜ × ×Ö¸×›×Ö·××Ö¸×œ ×©×¤Ö¼×¢×˜×¢×¨.'
            },
            'fr': {
                'docTitle': 'La Newsletter Familiale',
                'mainTitle': 'La Newsletter Familiale',
                'mainSubtitle': 'Ã‰dition Mensuelle - Novembre 2025',
                'websiteTitle': 'ğŸ‰ Notre Nouveau Site Web Familial est en Ligne!',
                'websiteText': 'Nous sommes ravis d\'annoncer que notre nouveau site web familial est dÃ©sormais en ligne! Le site est un centre central pour tout ce qui concerne la famille: une galerie de photos, un calendrier d\'Ã©vÃ©nements et des mises Ã  jour rÃ©guliÃ¨res. Venez nous rendre visite, vous informer et partager!',
                
                'aiTitle': 'âœ¨ Coin des IdÃ©es Familiales',
                'aiDescription': 'Cliquez sur le bouton pour obtenir une idÃ©e d\'activitÃ© familiale amusante, recommandÃ©e et actuelle pour le week-end Ã  venir! L\'idÃ©e est gÃ©nÃ©rÃ©e Ã  l\'aide de l\'intelligence artificielle (Gemini) et comprend des informations pertinentes provenant du web.',
                'generateIdeaText': 'âœ¨ SuggÃ©rez-moi une idÃ©e de famille!',
                'aiLoadingText': 'Chargement d\'une idÃ©e crÃ©ative...',
                'aiSourcesTitle': 'Sources d\'Information (Recherche Google):',
                
                'inMemoryTitle': 'ğŸ•¯ï¸ En MÃ©moire de Nos ÃŠtres Chers',
                'inMemoryText1': 'Nous nous souvenons de tous ceux qui ne sont plus parmi nous et chÃ©rissons les souvenirs qu\'ils ont laissÃ©s.',
                'inMemoryName': 'Ã€ la mÃ©moire de Frank van der Velde z"l',
                'inMemoryDate': 'DÃ©cÃ©dÃ© au Cap le 6 juillet 2025.',
                'inMemoryText2': 'Que sa mÃ©moire soit bÃ©nie.',
                'goodNewsTitle': 'ğŸŒŸ Bonnes Nouvelles!',
                'goodNewsText': 'De bonnes nouvelles arrivent bientÃ´t! Nous attendons avec impatience de connaÃ®tre vos mises Ã  jour.',
                'recommendationsTitle': 'ğŸ’¡ Coin des Recommandations',
                'recommendation1': '<strong class="font-semibold text-gray-900">Livre:</strong> <span class="text-gray-700">La sÃ©rie Harry Potter - La sÃ©rie de livres bien-aimÃ©e pour toute la famille. Magie et imagination Ã  chaque page!</span>',
                'recommendation2': '<strong class="font-semibold text-gray-900">Film:</strong> <span class="text-gray-700">Vice-Versa (Inside Out) - Un film d\'animation Disney/Pixar Ã  la fois touchant et amusant pour les enfants et les adultes.</span>',
                'recommendation3': '<strong class="font-semibold text-gray-900">Lieu Ã  Visiter:</strong> <span class="text-gray-700">Le zoo biblique de JÃ©rusalem - Une expÃ©rience Ã©ducative et amusante pour tous les Ã¢ges.</span>',
                'photosTitle': 'ğŸ“¸ Nos Moments d\'Ã‰tÃ©',
                'photosText': 'Quelques photos rÃ©centes, pour nous rappeler les beaux moments que nous partageons ensemble.',
                'eventsTitle': 'ğŸ‚ Anniversaires et Ã‰vÃ©nements Ã  Venir',
                'eventsList': `
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">15 novembre:</strong> 12Ã¨me anniversaire de Halel Caspi!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">15 novembre:</strong> 21Ã¨me anniversaire d\'Analise Jean Johnson!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ’</span><strong class="font-semibold mr-2">15 novembre:</strong> 38Ã¨me anniversaire de mariage d\'Alan et Bunny Marlene Fisher!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">19 novembre:</strong> 85Ã¨me anniversaire d\'Anita Baskin!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">20 novembre:</strong> 39Ã¨me anniversaire de Laura Brockway Ferguson!</li>
                `,
                'contactTitle': 'âœï¸ Envie de Partager?',
                'contactText': 'Avez-vous des nouvelles passionnantes, des recommandations ou des photos d\'un voyage en famille? Envoyez-nous simplement vos mises Ã  jour Ã  cette adresse e-mail: <strong>familysite@gmx.com</strong>.',
                'footerText1': 'Merci de votre lecture! Rendez-vous dans la prochaine Ã©dition.',
                'footerText2': '&copy; 2025 La Newsletter Familiale. Tous droits rÃ©servÃ©s.',
                'modalTitleSuccess': 'Nouvelle IdÃ©e!',
                'modalTitleError': 'Erreur',
                'modalContentError': 'Une erreur s\'est produite lors du chargement de l\'idÃ©e familiale. Veuillez rÃ©essayer plus tard.'
            },
            'nl': {
                'docTitle': 'De Familieuwsbrief',
                'mainTitle': 'De Familieuwsbrief',
                'mainSubtitle': 'Maandelijkse Editie - November 2025',
                'websiteTitle': 'ğŸ‰ Nieuwe Familiewebsite is Live!',
                'websiteText': 'We zijn verheugd om aan te kondigen dat onze nieuwe familiewebsite nu live is! De site is een centraal knooppunt voor alles wat met familie te maken heeft: een fotogalerij, een evenementenkalender en regelmatige updates. Kom langs, blijf op de hoogte en deel mee!',
                
                'aiTitle': 'âœ¨ Familie IdeeÃ«nhoek',
                'aiDescription': 'Klik op de knop om een leuk, aanbevolen en actueel familie-activiteitidee voor het komende weekend te krijgen! Het idee wordt gegenereerd met behulp van kunstmatige intelligentie (Gemini) en bevat relevante informatie van het web.',
                'generateIdeaText': 'âœ¨ Stel een familie-idee voor!',
                'aiLoadingText': 'Creatief idee aan het laden...',
                'aiSourcesTitle': 'Informatiebronnen (Google Zoeken):',
                
                'inMemoryTitle': 'ğŸ•¯ï¸ Ter Nagedachtenis aan Onze Geliefden',
                'inMemoryText1': 'Wij gedenken allen die niet meer bij ons zijn en koesteren de herinneringen die zij hebben achtergelaten.',
                'inMemoryName': 'Ter nagedachtenis aan Frank van der Velde z"l',
                'inMemoryDate': 'Overleden in Kaapstad op 6 juli 2025.',
                'inMemoryText2': 'Moge zijn nagedachtenis tot zegen zijn.',
                'goodNewsTitle': 'ğŸŒŸ Goed Nieuws!',
                'goodNewsText': 'Goed nieuws komt binnenkort! We wachten op jullie updates.',
                'recommendationsTitle': 'ğŸ’¡ Aanbevelingenhoek',
                'recommendation1': '<strong class="font-semibold text-gray-900">Boek:</strong> <span class="text-gray-700">De Harry Potter-serie - De geliefde boekenreeks voor het hele gezin. Magie en verbeelding op elke pagina!</span>',
                'recommendation2': '<strong class="font-semibold text-gray-900">Film:</strong> <span class="text-gray-700">Binnenstebuiten (Inside Out) - Een Disney/Pixar animatiefilm die zowel ontroerend als grappig is voor zowel kinderen als volwassenen.</span>',
                'recommendation3': '<strong class="font-semibold text-gray-900">Te Bezoeken Plaats:</strong> <span class="text-gray-700">De Bijbelse Dierentuin in Jeruzalem - Een leerzame en leuke ervaring voor alle leeftijden.</span>',
                'photosTitle': 'ğŸ“¸ Onze Zomerse Momenten',
                'photosText': 'Enkele recente foto\'s, om ons allemaal te herinneren aan de mooie momenten die we samen delen.',
                'eventsTitle': 'ğŸ‚ Aankomende Verjaardagen en Evenementen',
                'eventsList': `
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">15 november:</strong> 12e verjaardag van Halel Caspi!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">15 november:</strong> 21e verjaardag van Analise Jean Johnson!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ’</span><strong class="font-semibold mr-2">15 november:</strong> 38e huwelijksverjaardag van Alan en Bunny Marlene Fisher!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">19 november:</strong> 85e verjaardag van Anita Baskin!</li>
                    <li class="flex items-center"><span class="mr-2 text-indigo-500">ğŸ‰</span><strong class="font-semibold mr-2">20 november:</strong> 39e verjaardag van Laura Brockway Ferguson!</li>
                `,
                'contactTitle': 'âœï¸ Wilt u Delen?',
                'contactText': 'Heeft u spannend nieuws, aanbevelingen of foto\'s van een familiereis? Stuur ons uw updates naar dit e-mailadres: <strong>familysite@gmx.com</strong>.',
                'footerText1': 'Bedankt voor het lezen! Tot ziens in de volgende editie.',
                'footerText2': '&copy; 2025 De Familieuwsbrief. Alle rechten voorbehouden.',
                'modalTitleSuccess': 'Nieuw Idee!',
                'modalTitleError': 'Fout',
                'modalContentError': 'Er is een fout opgetreden bij het laden van het familie-idee. Probeer het later opnieuw.'
            }
        };

        // Static holiday data
        const holidays = [
            { id: 'roshHashanah', name: { he: '×¨××© ×”×©× ×”', en: 'Rosh Hashanah', yi: '×¨××© ×”×©× ×”', fr: 'Roch Hachana', nl: 'Rosj Hasjana' }, message: { he: 'ğŸ ×©× ×” ×˜×•×‘×”!', en: 'ğŸ Happy New Year!', yi: 'ğŸ ×’×•×˜ ×™×Ö¸×¨!', fr: 'ğŸ Bonne AnnÃ©e!', nl: 'ğŸ Gelukkig Nieuwjaar!' }, detailed_message: { he: '×× ×• ×¨×•×¦×™× ×œ××—×œ ×œ×›×œ ××©×¤×—×ª× ×• ×©× ×” ×˜×•×‘×” ×•××‘×•×¨×›×ª. ×©×ª×”× ×–×• ×©× ×” ×©×œ ×”×ª×—×œ×•×ª ×—×“×©×•×ª, ×‘×¨×™××•×ª, ××•×©×¨ ×•×©×’×©×•×’.', en: 'We want to wish our entire family a good and blessed year. May this be a year of new beginnings, health, happiness, and prosperity.', yi: '××™×¨ ×•×•×™×œ×Ÿ ×•×•×™× ×˜×©×Ÿ ××•× ×“×–×¢×¨ ×’×Ö·× ×¦×¢×¨ ×¤×Ö·××™×œ×™×¢ ×Ö· ×’×•×˜ ××•×Ÿ ×‘×¢× ×˜×©×˜ ×™×Ö¸×¨. ×–×Ö¸×œ ×“×Ö¸×¡ ×–×²Ö·×Ÿ ×Ö· ×™×Ö¸×¨ ×¤Ö¿×•×Ÿ × ×²Ö·×¢ ×Ö¸× ×”×™×™×‘×Ÿ, ×’×¢×–×•× ×˜, ×’×œ×™×§ ××•×Ÿ ×”×¦×œ×—×”.', fr: 'Nous souhaitons Ã  toute notre famille une bonne et heureuse annÃ©e. Que cette annÃ©e soit celle de nouveaux dÃ©parts, de santÃ©, de bonheur et de prospÃ©ritÃ©.', nl: 'Wij wensen ons hele gezin een goed en gezegend jaar. Moge dit een jaar zijn van een nieuw begin, gezondheid, geluk en voorspoed.' }, startDate: new Date('2025-09-22T00:00:00'), endDate: new Date('2025-10-04T23:59:59') },
            { id: 'hanukkah', name: { he: '×—× ×•×›×”', en: 'Hanukkah', yi: '×—× ×•×›×”', fr: 'Hanoucca', nl: 'Chanoeka' }, message: { he: 'ğŸ•¯ï¸ ×—× ×•×›×” ×©××—!', en: 'ğŸ•¯ï¸ Happy Hanukkah!', yi: 'ğŸ•¯ï¸ ×Ö· ×¤Ö¿×¨×™×™×œ×¢×›×Ÿ ×—× ×•×›×”!', fr: 'ğŸ•¯ï¸ Joyeux Hanoucca!', nl: 'ğŸ•¯ï¸ Fijne Chanoeka!' }, detailed_message: { he: '×—×’ ×—× ×•×›×” ×©××— ×•××œ× ×‘××•×¨! ×©×™×”×™×” ×œ×›× ×—×’ ×©×œ × ×™×¡×™×, ×”×“×œ×§×ª × ×¨×•×ª ××©×•×ª×¤×ª, ×¡×•×¤×’× ×™×•×ª ×—××•×ª ×•×–××Ÿ ××™×›×•×ª ××©×¤×—×ª×™.', en: 'Happy and light-filled Hanukkah! May you have a holiday of miracles, shared candle lighting, warm sufganiyot, and quality family time.', yi: '×Ö· ×¤Ö¿×¨×™×™×œ×¢×›×Ÿ ××•×Ÿ ×œ×™×›×˜×™×§×Ÿ ×—× ×•×›×”! ×–×Ö¸×œ×Ÿ ××²Ö·×š ×–×²Ö·×Ÿ ×Ö· ×™×•×-×˜×•×‘Ö¿ ×¤Ö¿×•×Ÿ × ×¡×™×, ×’×¢××™×™× ×–×Ö·× ×œ×™×›×˜ ×¦×™× ×“×Ÿ, ×•×•×Ö·×¨×¢××¢ ×¤Ö¼×Ö¸× ×˜×©×§×¢×¡ ××•×Ÿ ×¤×Ö·××™×œ×™×¢ ×¦×²Ö·×˜.', fr: 'Joyeux Hanoucca et plein de lumiÃ¨re ! Que cette fÃªte soit celle des miracles, de l\'allumage des bougies, des beignets chauds et du temps de qualitÃ© en famille.', nl: 'Fijne en lichte Chanoeka! Moge het een feest van wonderen, gezamenlijk kaarsen aansteken, warme soefganiyot en quality time met het gezin zijn.' }, startDate: new Date('2025-12-15T00:00:00'), endDate: new Date('2025-12-23T23:59:59')},
        ];

        let currentLang = 'he'; // Default: Hebrew
        const now = new Date();
        
        // Element map
        const elementsToTranslate = {
            'docTitle': document.getElementById('docTitle'),
            'mainTitle': document.getElementById('mainTitle'),
            'mainSubtitle': document.getElementById('mainSubtitle'),
            'websiteTitle': document.getElementById('websiteTitle'),
            'websiteText': document.getElementById('websiteText'),

            'aiTitle': document.getElementById('aiTitle'),
            'aiDescription': document.getElementById('aiDescription'),
            'generateIdeaText': document.getElementById('generateIdeaText'),

            'inMemoryTitle': document.getElementById('inMemoryTitle'),
            'inMemoryText1': document.getElementById('inMemoryText1'),
            'inMemoryName': document.getElementById('inMemoryName'),
            'inMemoryDate': document.getElementById('inMemoryDate'),
            'inMemoryText2': document.getElementById('inMemoryText2'),
            'goodNewsTitle': document.getElementById('goodNewsTitle'),
            'goodNewsText': document.getElementById('goodNewsText'),
            'recommendationsTitle': document.getElementById('recommendationsTitle'),
            'recommendation1': document.getElementById('recommendation1'),
            'recommendation2': document.getElementById('recommendation2'),
            'recommendation3': document.getElementById('recommendation3'),
            'photosTitle': document.getElementById('photosTitle'),
            'photosText': document.getElementById('photosText'),
            'eventsTitle': document.getElementById('eventsTitle'),
            'eventsList': document.getElementById('eventsList'),
            'contactTitle': document.getElementById('contactTitle'),
            'contactText': document.getElementById('contactText'),
            'footerText1': document.getElementById('footerText1'),
            'footerText2': document.getElementById('footerText2'),
            'holidayTitle': document.getElementById('holidayTitle'),
            'holidayText': document.getElementById('holidayText')
        };

        /**
         * Displays the custom modal (replaces alert)
         */
        function showModal(modalId, title, content) {
            document.getElementById('messageTitle').textContent = title;
            document.getElementById('messageContent').textContent = content;
            document.getElementById('modalOverlay').style.display = 'flex';
            document.getElementById('modalOverlay').classList.remove('opacity-0');
            
            const modalElement = document.getElementById(modalId);
            modalElement.style.display = 'block';
            modalElement.classList.add('scale-100');
            modalElement.classList.remove('scale-95');
            // Update button text for the modal
            const closeButton = modalElement.querySelector('button');
            closeButton.textContent = currentLang === 'he' ? '×¡×’×•×¨' : (currentLang === 'yi' ? '×¤Ö¿×Ö·×¨××Ö·×›×Ÿ' : 'Close');
        }

        /**
         * Hides the custom modal
         */
        function hideModal(modalId) {
            const modalElement = document.getElementById(modalId);
            modalElement.classList.add('scale-95');
            modalElement.classList.remove('scale-100');
            document.getElementById('modalOverlay').classList.add('opacity-0');

            setTimeout(() => {
                modalElement.style.display = 'none';
                document.getElementById('modalOverlay').style.display = 'none';
            }, 300); // Match transition duration
        }

        /**
         * Updates all texts according to the current language.
         */
        function updateLanguage() {
            const langData = defaultContent[currentLang];
            const isRTL = (currentLang === 'he' || currentLang === 'yi');

            // Update language and direction
            document.documentElement.lang = currentLang;
            document.documentElement.dir = isRTL ? 'rtl' : 'ltr';

            // Update text elements
            for (const key in elementsToTranslate) {
                const element = elementsToTranslate[key];
                if (element) {
                    const content = langData[key] || defaultContent['he'][key]; // Fallback to Hebrew

                    if (key === 'eventsList' || key.includes('recommendation') || key === 'contactText') {
                        element.innerHTML = content; // Use innerHTML for HTML tags
                    } else if (key !== 'generateIdeaText') {
                        element.textContent = content; // Use textContent otherwise
                    }
                }
            }
            
            // Update AI button text
            elementsToTranslate['generateIdeaText'].textContent = langData.generateIdeaText;

            // Update directional classes for AI section for RTL alignment
            const aiTitleElement = document.getElementById('aiTitle');
            const goodNewsTitleElement = document.getElementById('goodNewsTitle');
            const recommendationsTitleElement = document.getElementById('recommendationsTitle');
            const photosTitleElement = document.getElementById('photosTitle');
            const eventsTitleElement = document.getElementById('eventsTitle');

            [aiTitleElement, goodNewsTitleElement, recommendationsTitleElement, photosTitleElement, eventsTitleElement].forEach(el => {
                if (isRTL) {
                    el.classList.add('border-r-4', 'pr-3');
                    el.classList.remove('border-l-4', 'pl-3');
                    // Swap margin for icon alignment
                    const icon = el.querySelector('span');
                    if (icon) {
                        icon.classList.add('ml-2');
                        icon.classList.remove('mr-2');
                    }
                } else {
                    el.classList.add('border-l-4', 'pl-3');
                    el.classList.remove('border-r-4', 'pr-3');
                    // Swap margin for icon alignment
                    const icon = el.querySelector('span');
                    if (icon) {
                        icon.classList.add('mr-2');
                        icon.classList.remove('ml-2');
                    }
                }
            });

            // Update holiday message
            updateHolidaySection();
        }

        /**
         * Checks for a current holiday and displays the appropriate message.
         */
        function updateHolidaySection() {
            const holidaySection = document.getElementById('holidaySection');
            let currentHoliday = null;

            for (const holiday of holidays) {
                if (now >= holiday.startDate && now <= holiday.endDate) {
                    currentHoliday = holiday;
                    break;
                }
            }
            
            if (currentHoliday) {
                holidayTitle.textContent = currentHoliday.message[currentLang] || currentHoliday.message['en'];
                holidayText.textContent = currentHoliday.detailed_message[currentLang] || currentHoliday.detailed_message['en'];
                
                // Color change logic (e.g., for fasting days, removed for brevity, keeping only standard colors)
                holidaySection.classList.add('bg-indigo-600');
                holidaySection.classList.remove('bg-gray-700'); // Ensure it's not set to the mourning color
                
                holidaySection.style.display = 'block';
            } else {
                holidaySection.style.display = 'none';
            }
        }

        /**
         * Changes the language based on the selection (called by the dropdown).
         */
        function changeLanguage(newLang) {
            currentLang = newLang;
            updateLanguage();
        }

        // ----------------------------------------------------
        // --- Gemini API Logic (Family Idea Generator) ---
        // ----------------------------------------------------

        /**
         * Utility to convert language code to full language name for the API prompt.
         */
        function getLangName(code) {
            switch (code) {
                case 'he': return 'Hebrew';
                case 'en': return 'English';
                case 'yi': return 'Yiddish';
                case 'fr': return 'French';
                case 'nl': return 'Dutch';
                default: return 'English';
            }
        }

        /**
         * Calls the Gemini API to generate a family activity idea.
         */
        async function fetchGeminiContent(retryCount = 0) {
            const btn = document.getElementById('generateIdeaBtn');
            const resultContainer = document.getElementById('aiResultContainer');
            const resultElement = document.getElementById('aiResult');
            const sourcesElement = document.getElementById('aiSources');
            const langData = defaultContent[currentLang];
            const originalButtonText = langData.generateIdeaText;
            const loadingText = langData.aiLoadingText;
            const langName = getLangName(currentLang);


            // Prompt generation
            const systemPrompt = `You are a friendly, enthusiastic, and creative family activity planner. Your goal is to suggest ONE highly specific, fun, and engaging activity idea suitable for a family with mixed ages (kids and adults) for the upcoming weekend. The activity should be fresh and relevant to the current date and local context (general, not location-specific). Provide the response in ${langName}. Your response must be formatted as a short paragraph or a list of steps.`;
            const userQuery = `Suggest a creative, fun, and up-to-date family activity or trip idea for the coming weekend.`;

            // Prepare UI for loading
            btn.disabled = true;
            btn.textContent = loadingText;
            resultContainer.classList.add('hidden');
            resultElement.textContent = '';
            sourcesElement.innerHTML = '';
            

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    const text = candidate.content.parts[0].text;
                    let sources = [];
                    const groundingMetadata = candidate.groundingMetadata;

                    if (groundingMetadata && groundingMetadata.groundingAttributions) {
                        sources = groundingMetadata.groundingAttributions
                            .map(attribution => ({
                                uri: attribution.web?.uri,
                                title: attribution.web?.title,
                            }))
                            .filter(source => source.uri && source.title);
                    }

                    // Display result
                    resultElement.textContent = text;
                    if (sources.length > 0) {
                        const sourcesTitle = langData.aiSourcesTitle;
                        sourcesElement.innerHTML = `<p class="font-semibold mb-1">${sourcesTitle}</p>`;
                        
                        sources.forEach((source) => {
                            const link = document.createElement('a');
                            link.href = source.uri;
                            link.target = '_blank';
                            link.textContent = `${source.title} (${source.uri.substring(0, 30)}...)`;
                            link.className = 'block hover:text-indigo-600 transition-colors duration-150';
                            sourcesElement.appendChild(link);
                        });
                    }

                    resultContainer.classList.remove('hidden');

                } else {
                    throw new Error("No generated text found in response.");
                }

            } catch (error) {
                if (retryCount < MAX_RETRIES) {
                    const delay = Math.pow(2, retryCount) * 1000; // Exponential backoff
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return fetchGeminiContent(retryCount + 1); // Retry
                } else {
                    console.error("Gemini API Error after retries:", error);
                    showModal('messageModal', langData.modalTitleError, langData.modalContentError);
                }
            } finally {
                // Reset button state
                btn.disabled = false;
                btn.textContent = originalButtonText;
            }
        }


        // ----------------------------------------------------
        // App Initialization
        // ----------------------------------------------------
        window.onload = function() {
            // Set initial language from HTML element's lang attribute, falling back to 'he'
            currentLang = document.documentElement.lang || 'he';
            
            // Set the dropdown to the current language
            document.getElementById('lang-select').value = currentLang;

            // Load content
            updateLanguage();

            // Add event listener for the AI button
            document.getElementById('generateIdeaBtn').addEventListener('click', () => {
                fetchGeminiContent();
            });
        }
    </script>
</body>
</html>
